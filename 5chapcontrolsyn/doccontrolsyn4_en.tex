\documentclass[graybox, envcountchap]{svmult}
\input{../settings}

\begin{document}

\chapter{Stabilization control of power system models}\label{ch:stabcont}
In this Chapter, we will explain frequency stabilization control and transient
stabilization control of power system models. The structure of this chapter is
as follows. First, in Section \ref{sec:agcover}, we outline the automatic
generation control, which is a representative example of frequency stabilization
control, to suppress the deviation of angular frequency caused by load
variations, and confirm through numerical simulations that the steady-state
power flow state changes by adjusting the parameters of the controller. Next, in
Section \ref{sec:mathnpas}, as an advanced topic, we perform mathematical
stability analysis of frequency stabilization control. In particular, based on
passivity that does not depend on equilibrium points for nonlinear systems, we
show the relationship between the stability region of the power system model and
the convex region of potential energy function. Furthermore, in Section
\ref{sec:transcont}, we explain the configuration and functions of standard
automatic voltage regulators and power system stabilizers used for transient
stabilization control. Finally, in Section \ref{sec:retrofit}, as an advanced
topic, we explain the design methodology of power system stabilizers based on
retrofit control theory. <|endoftext|>

\section{Frequency stabilization control}\label{sec:agcover}
\subsection{Automatic generation control using broadcast-type PI controller}\label{sec:broadPI}

\smallskip
\subsubsection{Overview of Automatic Generation Control}

In this section, we will explain the principle of \textbf{Automatic Generation
Control (AGC)}\index{Automatic Generation Control} which adjusts the generation
output appropriately in response to unknown load variations. Automatic
Generation Control adjusts the generation output by performing control actions
such as increasing the generation output when the power supply is insufficient
compared to the demand, and decreasing the generation output when the power
supply is excessive, based on the observed frequency deviations of multiple
generators. This control action is based on the general characteristic of power
systems that negative frequency deviations occur when the power supply is
insufficient compared to the demand, and positive frequency deviations occur
when the power supply is excessive. In power system engineering, the overall
control to asymptotically converge the frequency deviation to zero is generally
referred to as \textbf{Frequency Stabilization Control}\index{Frequency
Stabilization Control}.  Automatic Generation Control is one of the methods for
Frequency Stabilization Control.

In actual power system operation, the central dispatch center performs Automatic
Generation Control. Although the basic operating principle is common, there are
several methods depending on the objectives. The target is to maintain the
frequency within a range of about $\pm$0.2Hz with respect to the reference
frequency of 50Hz or 60Hz. Note that the frequency deviation of the voltage
phasor at a nearby substation is often observed instead of the frequency
deviation of the generator, because the frequency of the voltage phasor at the
substation is generally close to that of the generator. Also, one of the
challenges of Automatic Generation Control is that there are many unknown
constants and variables in the actual power system. For example, it is possible
to roughly predict the total amount of load in a time scale of about 30 minutes,
but it is not possible to accurately grasp the values of individual loads that
change every moment. It is also difficult to accurately know all the constants
such as the impedance of each transmission line. Therefore, it is necessary to
design control algorithms that can be applied without knowing the accurate model
of the entire power system. In actual power system operation, weather forecast
information, temperature data, historical data, and other information are used
to predict changes in total demand for certain areas to some extent. The size of
the area and the method used vary, but it is impossible to predict the demand
completely.

On the other hand, as confirmed in the numerical examples in Section
\ref{sec:numsimtr}, when the supply-demand balance is not maintained, various
problems such as frequency deviation and tie-line power flow deviation may
occur. Therefore, it is important to establish an effective Automatic Generation
Control method that can mitigate the impact of unknown load variations and
maintain the stability of the power system. In this section, we will explain the
principle of Automatic Generation Control using a broadcast-type PI controller,
which is one of the methods for Frequency Stabilization Control. Therefore, it
is necessary to design a control algorithm that can be applied without knowing
the accurate model of the entire power system. In actual power system operation,
weather forecast information, temperature data, historical data, and other
information are used to predict changes in total demand for certain areas to
some extent. The size of the area and the method used vary, but it is impossible
to predict the demand completely.


\smallskip
\subsubsection{Formulation of automatic generation control}
In the following, we consider a generator model with the bus voltage phasor as
the input, as discussed in Section \ref{sec:genfund}. The dynamic
characteristics of the generator are restated as follows:

\begin{subequations}\label{eq:gendifagc}
\begin{equation}
  \simode{
    \dot{\delta}_i&= \omega_0  \Delta \omega_i \\
    M_i   \Delta \dot{\omega}_i&= 
    - D_i \Delta\omega_i  
    - P_i
    +P_{{\rm mech}i}
    \\
    \taudi \dot{E}_i & = 
    -\tfrac{ \Xsi }{ \Xti }E_i
    +\left(
    \tfrac{ \Xsi }{ \Xti }-1
    \right)
    |\bm{V}_i| \sfcos (\delta_i - \angle \bm{V}_i ) 
    + V_{{\rm field}i}
  }
\end{equation}

When considering active power and reactive power as outputs, we have:

\begin{equation}\label{eq:PQoutagc}
  \spliteq{
    P_i &=  \frac{E_i |\bm{V}_i|}{ \Xti } \sfsin (\delta_i - \angle \bm{V}_i), \\
    Q_i &=  \frac{E_i|\bm{V}_i|}{ \Xti } \sfcos (\delta_i - \angle \bm{V}_i)
    -\frac{|\bm{V}_i|^2}{ \Xti }
  }
\end{equation}
\end{subequations}

According to this expression, the load model for inputting the phase of the
busbar voltage and outputting the active and reactive powers is also shown
again. The constant impedance model is given by:

\begin{subequations}\label{eq:lmodelsagc}
\begin{equation}
  P_i =  - 
  \frac{|\bm{V}_i|^2}{ \real \left[ \overline{\bm{z}}^{\star}_{{\rm load}i} \right] } 
  ,\qquad
  Q_i = - 
  \frac{|\bm{V}_i|^2}{ \imag \left[ \overline{\bm{z}}^{\star}_{{\rm load}i} \right] } 
\end{equation}
where $\bm{z}_{{\rm load}i}^{\star}$ is a constant representing the impedance of
the load.

Similarly, the constant current model is expressed as:

\begin{equation}
  P_i = |\bm{V}_i| \real \left[
  \bm{I}_{{\rm load}i}^{\star} 
  \right],\qquad
  Q_i = - |\bm{V}_i| \imag \left[
  \bm{I}_{{\rm load}i}^{\star}
  \right]
\end{equation}
where $\bm{I}_{{\rm load}i}^{\star}$ is a constant representing the current phase of the load.

The constant power model is given by:

\begin{equation}\label{eq:contpwmod}
P_i=P_{{\rm load}i}^{\star} ,\qquad
 Q_i= Q_{{\rm load}i}^{\star} 
\end{equation}
where $P_{{\rm load}i}^{\star}$ and $Q_{{\rm load}i}^{\star}$ are constants.
\end{subequations}

These generator models and load models are combined to describe the entire power
system using a differential-algebraic equation (DAE) model, as shown in the
algebraic equation system:

\begin{equation}\label{eq:PQVgenagc}
\simode{
P_1 + \bm{j} Q_1 &= 
\sum_{j=1}^{N} \overline{\bm{Y}}_{1j} |\bm{V}_1| |\bm{V}_j | e^{\bm{j} (\angle \bm{V}_1 - \angle \bm{V}_j )} \\ 
& \; \;  \vdots \\
P_N + \bm{j} Q_N &= 
\sum_{j=1}^{N} \overline{\bm{Y}}_{Nj} |\bm{V}_N| |\bm{V}_j | e^{\bm{j} (\angle \bm{V}_N - \angle \bm{V}_j )}
}
\end{equation}
where the generator bus indices are denoted by the set $\mathcal{I}{\rm G}$ and
the load bus indices are denoted by the set $\mathcal{I}{\rm L}$, and without
loss of generality, we can define:

\[
  \mathcal{I}_{\rm G} :=  \{1,\ldots, n\}
  ,\qquad
  \mathcal{I}_{\rm L} := \{n+1,\ldots, n+m\}
\]
where $n$ represents the total number of generator buses and $m$ represents the
total number of load buses. Furthermore, $N$ represents the total number of
buses, which is equal to $n+m$.

\begin{figure}[t]
\centering
\includegraphics[width = .99\linewidth]{figs/bcAGC}
\medskip
\caption{\textbf{Signal transmission structure for automatic power generation control}}
\label{fig:bcAGC}
\medskip
\end{figure}

The automatic generation control (AGC) is a control algorithm that adjusts the
mechanical input $P_{{\rm mech}i}$ in Equation (\ref{eq:gendifagc}). Here, we
consider a broadcast-type PI controller that observes the weighted sum of
frequency deviations for all generators and sends a control input with
appropriate weighting to all generators. Specifically, for each $i \in
\mathcal{I}_{\rm G}$, we set:

\begin{subequations}\label{eq:agccon}
\begin{equation}\label{eq:agccona}
  P_{{\rm mech}i}(t)=
  P_{{\rm mech}i}^{\star} - \alpha_i
  \underbrace{
  \left\{
  k_{\rm P} \Delta \omega_{\rm sum}(t) +
  k_{\rm I}
  \int_0^t \Delta \omega_{\rm sum}(\tau) d \tau
  \right\}
  }_{P_{0}(t)}
\end{equation}
where $P_{{\rm mech}i}^{\star}$ is a constant representing the standard setting
value of the mechanical input. Moreover, $\alpha_i$ is a non-negative constant
specifying the contribution of generator $i$, and:

\[
  \Delta \omega_{\rm sum}(t) := 
  \sum_{i =1}^n \beta_i \Delta \omega_{i}(t)
\]
is the weighted sum of frequency deviations with non-negative weights $\beta_i$.
Furthermore, $k_{\rm P}$ and $k_{\rm I}$ are positive constants representing the
gains of the PI controller. This AGC controller has a structure where the
generated signal $P_0(t)$, which is produced by a single PI controller with
weighting of $\alpha_i$ and $\beta_i$, is simultaneously broadcasted to all
generators (Figure \ref{fig:bcAGC}). Note that Equation \ref{eq:agccona} can be
expressed as a differential equation as follows:

\begin{equation}
  \simode{
  \dot{\xi}&=  \Delta \omega_{\rm sum} \\
  P_{{\rm mech}i} &= P_{{\rm mech}i}^{\star} - \alpha_i \left(k_{\rm P} \Delta \omega_{\rm sum} +  k_{\rm I} \xi \right)
  }
\end{equation}
\end{subequations}

In electric power systems engineering, the non-negative constant $\alpha_i$ is
referred to as the \textbf{participation factor}\index{participation factor} of
generator $i$. It should be noted that in real-world thermal power generation
and nuclear power generation, there is a \textbf{prime mover}\index{prime mover}
that generates mechanical input by rotating a turbine using high-pressure steam
generated by thermal or nuclear power. The prime mover incorporates a
\textbf{governor}\index{governor} that automatically controls the rotation speed
of the generator. In order to analyze more realistic automatic generation
control, it is necessary to consider a prime mover model that takes input from
the central dispatch center as setpoint and outputs mechanical input to the
generator \cite[Chapter 3]{taniguchi2011power}.

By changing the ratio of participation factors, it is possible to adjust the
values of effective power supplied by each generator in a balanced steady-state
load flow condition. From the perspective of system control engineering, this
can be interpreted as "moving the stable equilibrium point of the power system
model by switching controllers." As analyzed in Chapter \ref{sec:staana}, the
stability of the power system depends on the choice of equilibrium point. The
total generation cost and transmission loss of the power system also depend on
the choice of equilibrium point. Therefore, appropriately switching the
participation factors according to the distribution of load can lead to improved
system stability and reduced economic costs.

In actual power system operation, the updating of participation factors is
typically done at intervals of several minutes to several tens of minutes
\cite[Section 11.1]{kundur1994power}. In the terminology of power system
engineering, the scheme for updating these participation factors is called
\textbf{economic load dispatching control} (EDC)\index{economic load dispatching
control}. The control algorithm that uses the participation factors as constants
during the updating interval is called \textbf{load frequency control}
(LFC)\index{load frequency control}. However, it should be noted that there may
be cases where there is no clear distinction between economic load dispatching
control and load frequency control in the literature, or where economic load
dispatching control is considered as a different scheme, so caution is
necessary.


\subsection{Numerical simulation of frequency stabilization control}

Let's verify the effectiveness of frequency stabilization control using a simple
example.

\begin{example}{Frequency stabilization by Automatic Generation Control}\label{ex:agcdemo}
Consider the power system model consisting of 3 busbars as discussed in Examples
\ref{ex:derY}, \ref{ex:pf3bus}, and \ref{ex:inires}. The physical constants of
the generators and transmission lines are set to the same values as in Example
\ref{ex:inires}, and the initial values of the internal states of the generators
are set to the steady-state values shown in Table \ref{table:genst13b}. In
addition, the field input is assumed to be constant at the values shown in Table
\ref{table:genst13b}.

The load at busbar 2 is set to a constant power model, and we consider a case
where the consumption of active power increases by 1\% from the initial
steady-state load flow condition. First, we show the time response of the
frequency deviation when there is no automatic generation control and the
mechanical input of the generators is constant at the values shown in Table
\ref{table:genst13b}, as shown in Figure \ref{fig:agcPdemo}(a). It can be seen
that the steady-state value of the frequency deviation does not become zero
because the supply and demand are not balanced due to the increased power
consumption by the load.

Next, we show the results when the broadcast-type PI controller of Equation
\ref{eq:agccon} is incorporated as automatic generation control, with the
parameters of the controller set to the values shown in Table
\ref{table:agcpara}(a), as shown in Figure \ref{fig:agcPdemo}(b). From this
figure, it can be seen that the frequency deviation hardly occurs even when the
consumption of load power changes, due to the effectiveness of automatic
generation control.
\end{example}


\begin{figure}[t]
  \centering
  {
  \begin{minipage}{0.49\linewidth}
    \centering
    \includegraphics[width = 1.0\linewidth]{figs/woagcPinc}
    \subcaption{No automatic power generation control}
  \end{minipage}
  \begin{minipage}{0.49\linewidth}
    \centering
    \includegraphics[width = 1.0\linewidth]{figs/wagcPinc}
    \subcaption{With automatic power generation control}
  \end{minipage}
  \medskip
  \caption{\textbf{Time response of angular frequency deviation to power consumption increase} 
    \\ \centering(Blue solid line: $Delta \omega_1$, Red dashed line: $Delta \omega_3$)}
  \label{fig:agcPdemo}
  }
\medskip
\end{figure}

\begin{table}[h]
\medskip
 \caption{\textbf{Controller Parameter Setting}}
 \label{table:agcpara}
 \centering
  \begin{tabular}{ccccccccc}
   \hline
Setup &  $k_{\rm P}$ & $k_{\rm I}$ & $\alpha_1$ & $\alpha_3$ &$\beta_1$ & $\beta_3$ \\
   \hline \hline
(a) & 100 & 500 & 1 & 3 & 1 & 3 \\
(b) & 100 & 500 & 1 & 1& 1 & 1 \\
(c) & 100 & 500 & 3 & 1 & 3 & 1 \\
   \hline
  \end{tabular}
\end{table}

Next, let us confirm the change in steady-state power flow conditions by
adjusting the contribution coefficients of the broadcast-type PI controller in
Equation \ref{eq:agccon} to achieve supply-demand balance.

\begin{example}{Change in steady-state power flow conditions by adjusting contribution coefficients}\label{ex:pfvary}
Consider a power system model consisting of two generators and one load, similar
to Example \ref{ex:agcdemo}. Here, we confirm that the ratio of active power
supplied by Generator 1 and Generator 3 changes by varying the contribution
coefficients of the broadcast-type PI controller in Equation \ref{eq:agccon}.
Specifically, we switch the contribution coefficients as follows:

\begin{itemize}
\item Parameters of \ref{table:agcpara} (b) are set for 0 [s] to 20 [s].
\item Parameters of \ref{table:agcpara} (a) are set for 20 [s] to 40 [s].
\item Parameters of \ref{table:agcpara} (c) are set for 40 [s] to 60 [s].
\end{itemize}

The resulting time response is shown in Figure \ref{fig:agcPvary}(a). The solid
blue line represents the value of active power supplied by Generator 1 ($P_1$),
and the dashed red line represents the value of active power supplied by
Generator 3 ($P_3$). From this result, it can be seen that the ratio of $P_1$
and $P_3$ in the steady-state power flow conditions matches the ratio of
contribution coefficients $\alpha_1$ and $\alpha_3$.

Next, the time response of the total active power transmission loss
$P_1+P_2+P_3$, which represents the power transmission loss due to active power,
is shown in Figure \ref{fig:agcPvary}(b). Note that $P_2$ is the active power
consumed by the load and its value is constant at $-3$.

From this figure, it can be seen that the magnitude of active power transmission
loss varies depending on the realized steady-state power flow conditions. In
particular, when the parameters of the broadcast-type PI controller are set to
the values in Table \ref{table:agcpara} (a), i.e., when power is mainly supplied
using the lossless transmission line between Bus 2 and Bus 3, the total power
transmission loss of the entire power system is smaller, which is consistent
with the discussion in Example \ref{ex:pf3bus}. The admittance of the
transmission lines is set to the values in Equation (\ref{eq:rightlossless}).
\end{example}

\begin{figure}[t]
  \centering
  {
  \begin{minipage}{0.49\linewidth}
    \centering
    \includegraphics[width = 1.0\linewidth]{figs/varyalphaP}
    \subcaption{ Blue solid line: $P_1$, Red dashed line: $P_3$. }
  \end{minipage}
  \begin{minipage}{0.49\linewidth}
    \centering
    \includegraphics[width = 1.0\linewidth]{figs/varyalphaloss}
    \subcaption{Transmission loss $P_1+P_2+P_3$.}
  \end{minipage}
  \medskip
  \caption{\textbf{Time response of effective power to changes in contribution factor} }
  \label{fig:agcPvary}
  }
\medskip
\end{figure}

As shown in Example \ref{ex:pfvary}, by adjusting the contribution coefficients
of a broadcast-type PI controller, it is possible to change the steady-state
power flow condition. At the same time, the magnitude of transmission losses and
the required generation cost for each steady-state power flow condition also
change. Therefore, by appropriately controlling the contribution coefficients,
it is possible to achieve more economical system operation. However, it should
be noted that a steady-state power flow condition with lower economic costs is
not necessarily a highly stable equilibrium point, so it is important to
carefully consider trade-offs between economic efficiency and stability. 

\section{Mathematical stability analysis of frequency stabilization control
system\advanced}\label{sec:mathnpas}

\subsection{Power system model under consideration\advanced}\label{sec:objmod}

\smallskip
\subsubsection{Assumptions on Power System Model and Automatic Generation Control}

In Section \ref{sec:stalin}, an approximate linear model was derived under the
assumption that the power system model is in the vicinity of steady-state power
flow conditions, and necessary and sufficient conditions for steady-state
stability were analyzed. In this section, using the concept of passivity for
nonlinear systems, we analyze the frequency stability of the power system model
described as a system of differential-algebraic equations, taking into
consideration the stability of the entire feedback control system with automatic
generation control. Specifically, we conduct stability analysis under the
following assumptions.

\begin{itemize}
  \item All generators are expressed with the generator model of Equation
  (\ref{eq:lmodelsagc}). However, it is assumed that the field voltage of each
  generator is set to a constant.
  \item All loads are expressed with the constant power model of Equation
  \ref{eq:contpwmod}.
  \item For algebraic equations for the power grid of Equation
  \ref{eq:PQVgenagc}, conductance of all transmission lines is assumed to be 0.
  \item For the broadcast-type PI controller of Equation (\ref{eq:agccon}),
  automatic generation control is performed.
  However, it is assumed that $\alpha_i$ and $\beta_i$ are equal for all $i\in
  \mathcal{I}_{\rm G}$ for the weight of the participation factor and frequency
  deviation.
\end{itemize}

The first and second assumptions refer to considering a standard model for the
generator and load in the power system. The third assumption regarding the
transmission network implies that transmission losses are assumed to be zero,
which is essential for conducting stability analysis mathematically. In reality,
it is not possible to completely eliminate transmission losses in a power
system, but reducing transmission losses can be achieved by transmitting power
at higher voltages with lower currents. The discussion in this section assumes
that transmission losses can be approximately considered as zero due to
high-voltage transmission. The fourth assumption is necessary for the
input-output characteristics of the broadcast-type PI controller to be passive.
However, it should be noted that even if some coefficients are zero, as long as
at least one contribution coefficient $\alpha_i$ for $i\in \mathcal{I}_{\rm G}$
is positive, it is acceptable. 

Furthermore, as shown in the analysis of Section \ref{sec:phsync}:

\begin{itemize}
  \item The frequency deviation of all generators become equalize under a steady power flow distribution.
\end{itemize}

The following frequency stability analysis is based on this fact. Specifically,
in order for the integral controller in the broadcast-type PI controller to make
the steady-state angular frequency deviations of all generators zero, it is
necessary for the above-mentioned angular frequency deviations to automatically
synchronize with each other. Note that this requires the characteristic of
automatic synchronization among the angular frequency deviations using only one
integrator included in the broadcast-type PI controller.

\smallskip
\subsubsection{Representation of power system with automatic generation control
as a feedback system}

Similar to the discussion in Section \ref{sec:linpasana}, we consider
representing the power system model as a feedback system consisting of two
subsystems. The first subsystem is described by the following equations:
\begin{equation}\label{eq:sys1}
  \mathds{F}:
  \simode{
  M \Delta \dot{\omega}&= 
  - 
  D
  \Delta\omega 
  + 
  u_{\mathds{F}}
  +P_{{\rm mech}}^{\star}
  \\
  y_{\mathds{F}}&= \omega_0 \Delta\omega 
  }
\end{equation}

However, $\Delta\omega$ is a vector composed of $\Delta\omega_i$ stacked
vertically, and $M$ and $D$ are matrices formed by diagonally arranging $M_i$
and $D_i$. Also, $P_{{\rm mech}}^{\star}$ is a constant vector composed of
$P_{{\rm mech}i}^{\star}$. This $\mathds{F}$ is equivalent to the mechanical
subsystem in Section \ref{sec:linpasana}, except for the difference in the
constant vector $P_{{\rm mech}}^{\star}$. The second subsystem is represented by
the nonlinear differential-algebraic equation system of the electrical subsystem
in Section \ref{sec:linpasana}, given by:

\begin{subequations}\label{eq:sys2G}
\begin{equation}\label{eq:sys2}
  \mathds{G}_i : 
  \simode{ 
    \dot{\delta}_i &= u_{\mathds{G}_i}
    \\
    \taudi \dot{E}_i & = 
    -\tfrac{ \Xsi }{ \Xti }E_i
    +\left(
    \tfrac{ \Xsi }{ \Xti }-1
    \right)
    |\bm{V}_i| \sfcos (\delta_i - \angle \bm{V}_i ) 
    + V_{{\rm field}i}^{\star}
    \\
    y_{\mathds{G}_i}&= \tfrac{E_i |\bm{V}_i|}{ \Xti} \sfsin (\delta_i - \angle \bm{V}_i)
  }
\end{equation}

The voltage phasor of the bus in Equation \ref{eq:sys2} satisfies a set of
simultaneous equations for all generator buses as follows:

\begin{equation}\label{eq:gVeq}
  \simode{
    P_i &=
    \sum_{j=1}^{N} B_{ij} |\bm{V}_i| |\bm{V}_j| \sfsin(\angle \bm{V}_i -\angle \bm{V}_j)
    \\
    Q_i &= 
    -\sum_{j=1}^{N} B_{ij} |\bm{V}_i| |\bm{V}_j| \sfcos(\angle \bm{V}_i -\angle \bm{V}_j)
  }\qquad
  i \in \mathcal{I}_{\rm G}
\end{equation}
and a set of coupled equations for all load bus bars given by:

\begin{equation}\label{eq:lVeq}
  \simode{
    &P_{{\rm load}i}^{\star} =
    \sum_{j=1}^{N} B_{ij} |\bm{V}_i| |\bm{V}_j| \sfsin(\angle \bm{V}_i -\angle \bm{V}_j)
    \\
    &Q_{{\rm load}i}^{\star} = 
    -\sum_{j=1}^{N} B_{ij} |\bm{V}_i| |\bm{V}_j| \sfcos(\angle \bm{V}_i -\angle \bm{V}_j)
  }\qquad
  i \in \mathcal{I}_{\rm L}
\end{equation}
\end{subequations}

In addition, the active power $P_i$ and reactive power $Q_i$ in Equation
(\ref{eq:gVeq}) are defined by Equation (\ref{eq:PQoutagc}). Also, $B_{ij}$
represents the $(i,j)$ element of the susceptance matrix $B$, which is the
imaginary part of the admittance matrix $\bm{Y}$. In the following, we consider
the combination of Equations (\ref{eq:sys2}) to (\ref{eq:lVeq}) for all
generator buses $i \in \mathcal{I}_{\rm G}$ as one subsystem, and denote it as
the electrical subsystem $\mathds{G}$.

Furthermore, the dynamic characteristics of the broadcast-type PI controller in
Equation (\ref{eq:agccon}) are represented as follows:
\begin{equation}\label{eq:condsK}
  \mathds{K}: \simode{
  \dot{\xi}&=  h^{\sf T} u_{\mathds{K}} \\
  y_{\mathds{K}} &= h \left(k_{\rm P} h^{\sf T}u_{\mathds{K}} +  k_{\rm I} \xi \right)
  }
\end{equation}
where $h$ is a column vector consisting of $\alpha_i$.

In this case, the inputs and outputs of the aforementioned subsystems
$\mathds{F}$, $\mathds{G}$, and controller $\mathds{K}$ are interconnected as
follows:
\begin{subequations}\label{eq:connds}
\begin{align}
u_{\mathds{F}} = - y_{\mathds{K}} + v_{\mathds{F}}&
,\qquad u_{\mathds{K}} = \frac{1}{\omega_0} y_{\mathds{F}}	\label{eq:connds1}
\\
u_{\mathds{G}} = y_{\mathds{F}}&
,\qquad
v_{\mathds{F}} = - y_{\mathds{G}}		\label{eq:connds2}
\end{align}
\end{subequations}

This represents the entire feedback control system incorporating automatic
generation control. However, it should be noted that the "power balance
equation" block includes unknown model parameters such as load consumption power
and transmission line admittance. The block diagram of the entire feedback
control system is shown in Figure \ref{fig:nonlinBD}. Please note that the block
representing the "power balance equation" includes unknown model parameters such
as load consumption power and transmission line admittance.

\begin{figure}[t]
\centering
\includegraphics[width = .85\linewidth]{figs/nonlinBD}
\medskip
\caption{\textbf{Feedback control system incorporating automatic power generation control}}
\label{fig:nonlinBD}
\medskip
\end{figure}



\subsection{Equilibrium-independent passivity of power system models\advanced}

\smallskip
\subsubsection{Equilibrium-independent passivity}

The discussion in Section \ref{sec:linpasana} was based on an approximate linear
model, and the convergence to zero of the internal state represented the
asymptotic convergence to a specific steady-state power flow condition in the
original nonlinear model. On the other hand, in power system models represented
as nonlinear differential-algebraic equation systems, the internal state does
not necessarily converge to zero even at steady-state power flow conditions
where power supply and demand are balanced. Furthermore, the steady-state power
flow condition itself can change depending on set values such as mechanical
inputs. Therefore, it is desirable to conduct stability analysis that does not
depend on the selection of individual steady-state power flow conditions
(equilibrium points). A concept proposed in control engineering for such
analysis is called \textbf{equilibrium-independent
passivity}\index{equilibrium-independent passivity}
\cite{hines2011equilibrium,simpson2019equilibrium}.  Note that in some
literature, it is also referred to as \textbf{shifted passivity}\index{shifted
passivity} \cite{monshizadeh2019conditions}.  Its definition is given as
follows.

\begin{definition}[Equilibrium-independent passivity]\label{def:eipassive}
Let us consider a nonlinear system:

\begin{equation}\label{eq:nlsig}
  \Sigma: \simode{
  E\dot{x} &= f(x) + Bu + R d^{\star}\\
  y &= h(x)
  }
\end{equation}
where $f:\mathcal{X} \rightarrow \mathbb{R}^{n}$ and $h:\mathcal{X} \rightarrow
\mathbb{R}^{m}$ are smooth functions, and $B \in \mathbb{R}^{n\times m}$, $E \in
\mathbb{R}^{n\times n}$, $R \in \mathbb{R}^{n\times p}$ are matrices. Also,
$d^{\star}\in \mathbb{R}^p$ is a constant vector. Here, $\mathcal{X}$ represents
the admissible state space.

The set of achievable equilibrium points by constant inputs is denoted as:

\begin{equation*}%\label{eq:asbleq}
  \mathcal{E}_{\Sigma} :=
  \left\{
  x^{\star} \in \mathcal{X}: 
  \mbox{there exists $u^{\star}$ satisfying $0 = f(x^{\star})+B u^{\star}+ R d^{\star}$}
  \right\}
\end{equation*}

For each equilibrium point $x^{\star} \in \mathcal{E}{\Sigma}$, if there exists
a differentiable positive semi-definite function $W{x^{\star}}:\mathcal{X}
\rightarrow \mathbb{R}{\geq 0}$ such that $W{x^{\star}} (x^{\star}) = 0$ and for
any input $u$, the following inequality holds for all $t \geq 0$:

\begin{equation*}%\label{eq:eiconpv}
  \frac{d}{dt} W_{x^{\star}} \bigl( x(t) \bigr) \leq \bigl(u(t)-u^{\star}\bigr)^{\sf T} \bigl(y(t)-y^{\star}\bigr)
  ,\qquad
  \forall t \geq 0
\end{equation*}
then $\Sigma$ is called \textbf{equilibrium-independent passive}. Here,
$u^{\star}$ and $y^{\star}$ denote the steady-state input and output at the
equilibrium point, respectively, and are defined as:

\begin{equation*}%\label{eq:uystar}
  u^{\star} := -(B^{\sf T}B)^{-1}B^{\sf T} \bigl\{f(x^{\star}) + R d^{\star} \bigr\}
  ,\qquad
  y^{\star} := h(x^{\star}) 
\end{equation*}

In particular, if there exists a positive constant $\rho$ such that the
following inequality holds for all $t \geq 0$:

\begin{equation*}%\label{eq:eiconosp}
  \frac{d}{dt} W_{x^{\star}} \bigl( x(t) \bigr) \leq \bigl(u(t)-u^{\star}\bigr)^{\sf T} \bigl(y(t)-y^{\star}\bigr)
  -\rho \bigl\|y(t)-y^{\star} \bigr\|^2
  ,\qquad
  \forall t \geq 0
\end{equation*}
then $\Sigma$ is called \textbf{equilibrium-independent strictly passive}.
\end{definition}

In Definition \ref{def:eipassive}, the passivity of the system is defined with
respect to the equilibrium point $x^{\star} \in \mathcal{E}{\Sigma}$ as a
reference. In the context of linear systems, it is known that this definition of
passivity is equivalent to the definition of passivity in Section
\ref{sec:linpasana}, unless the system has a zero eigenvalue
\cite{hines2011equilibrium}. Note that the function $W_{x^{\star}}(x)$ mentioned
above is called the storage function, similar to conventional passivity
definitions. It should be noted that this storage function $W_{x^{\star}}(x)$ is
an implicit function of the equilibrium point $x^{\star}$.

\begin{COLUMN}
\noindent \textbf{Descriptor representation}:
The matrix $E$ in Equation \ref{eq:nlsig} is introduced to represent the
electrical subsystem $\mathds{G}$ of the differential-algebraic equation system
given by Equation (\ref{eq:sys2G}). Specifically, by setting:

\[
  E=\mat{
  I & 0 \\
  0 & 0\\ 
  }
\]
the system $\Sigma$ in Equation \ref{eq:nlsig} represents the following
differential-algebraic equation system:

\begin{equation*}
  \simode{
    \dot{x}_1 &= f_1(x_1,x_2) + B_1u + R_1 d^{\star}\\
    0 &= f_2(x_1,x_2) \\
    y &= h(x_1,x_2)
  }
\end{equation*}

When applied to the electrical subsystem $\mathds{G}$, $x_1$ is a vector
containing all $\delta_i$ and $E_i$, and $x_2$ is a vector containing all
$|\bm{V}_i|$ and $\angle \bm{V}_i$. On the other hand, when $E$ is regular, it
represents a differential equation system like the mechanical subsystem
$\mathds{F}$ given by Equation \ref{eq:sys1}. This type of system
representation is called the \textbf{descriptor representation}.
\end{COLUMN}

In reference \cite{simpson2019equilibrium}, it is shown that when a system is
passive regardless of its equilibrium point, its storage function can be
expressed in the form of Equation \ref{eq:paraW} using a certain function
$U(x)$:

\begin{equation}\label{eq:paraW}
  W_{x^{\star}}(x) = U(x) - U(x^{\star}) - \nabla U^{\sf T}(x^{\star}) (x-x^{\star})
\end{equation}

In Definition \ref{def:eipassive}, it is a requirement that the storage function
$W_{x^{\star}}(x)$ in Equation \ref{eq:paraW} is a positive semi-definite
function. Specifically, the condition is that Equation \ref{eq:Uineqst} holds:

\begin{equation}\label{eq:Uineqst}
  U(x) \geq  U(x^{\star}) + \nabla U^{\sf T}(x^{\star}) (x-x^{\star})
\end{equation}

If this inequality holds for any pair $(x,x^{\star}) \in \mathcal{X} \times
\mathcal{X}$, then for each equilibrium point $x^{\star} \in
\mathcal{E}{\Sigma}$, $W{x^{\star}}(x)$ is a positive semi-definite function.
The inequality in Equation \ref{eq:Uineqst} expresses the convexity of the
function $U(x)$. As will be explained later, the region $\mathcal{X}$ where
$U(x)$ is convex plays an important role in stability analysis using passivity
that does not depend on the equilibrium point.

\begin{COLUMN}
\noindent \textbf{Convex function}:
A function $f(x)$ is called \textbf{convex} if, for any two points $(x,y)$ in
its domain and any $\theta \in [0,1]$, the following inequality holds:

\[
  f\bigl(
  \theta x + (1-\theta) y
  \bigr)
  \leq \theta f(x) + (1- \theta) f(y)
  ,\qquad
  \forall \theta \in [0,1]
\]

In particular, if $f(x)$ is differentiable, a necessary and sufficient condition
for $f(x)$ to be convex is that, for any two points $(x,y)$,

\[
  f(x) \geq f(y) + \nabla f^{\sf T}(y)(x-y)
\]

This inequality means that the graph of $f(x)$ is always above the tangent line
to $f(x)$ at the point $x=y$.

\smallskip
\noindent \textbf{Bregman Distance}:
In statistics, the quantity on the right-hand side of equation \ref{eq:paraW}
for a convex function $U(x)$ is called the \textbf{Bregman distance}
\cite{bregman1967relaxation} between $x$ and $x^{\star}$ with respect to $U(x)$.
If $U(x)$ is chosen to be $|x|^2$, then the Bregman distance $W_{x^{\star}}(x)$
reduces to the Euclidean distance $|x-x^{\star}|^2$.
\end{COLUMN}

\smallskip
\subsubsection{Analysis of the mechanical subsystem}

As shown in Section \ref{sec:linpasana}, the mechanical subsystem $\mathds{F}$
is strongly passive. Similarly, we confirm that $\mathds{F}$ in Equation
\ref{eq:sys1} is also strongly passive regardless of the equilibrium point.
First, the mechanical subsystem is represented in the form:

\begin{equation}
  \mathds{F}: \simode{
  \dot{x}_{\mathds{F}} & = A_{\mathds{F}} x_{\mathds{F}} + B_{\mathds{F}} u_{\mathds{F}} 
  + R_{\mathds{F}} d_{\mathds{F}}^{\star} \\
  y_{\mathds{F}} &= C_{\mathds{F}} x_{\mathds{F}}
  }
\end{equation}

Here, the state $x_{\mathds{F}}$ is a vector consisting of $\Delta \omega_i$,
and $u_{\mathds{F}}$ and $y_{\mathds{F}}$ are vectors consisting of
$u_{\mathds{F}i}$ and $y{\mathds{F}i}$, respectively. Also,
$d{\mathds{F}}^{\star}$ represents $P_{\rm mech}^{\star}$, and the system
matrices are:

\[
  A_{\mathds{F}} := -M^{-1}D,\qquad
  B_{\mathds{F}} := M^{-1},\qquad
  R_{\mathds{F}} := M^{-1},\qquad
  C_{\mathds{F}} := \omega_0 I
\]

Note that the matrices $M$ and $D$ are diagonal matrices composed of $M_i$ and
$D_i$. For an arbitrarily selected equilibrium point $x^{\star}{\mathds{F}} \in
\mathcal{E}{\mathds{F}}$, the storage function is chosen as:

\begin{equation}\label{eq:WxFst}
W_{x^{\star}_{\mathds{F}}}(x_{\mathds{F}})
= \frac{\omega_0}{2}
(x_{\mathds{F}} -x^{\star}_{\mathds{F}})^{\sf T}
M
(x_{\mathds{F}} -x^{\star}_{\mathds{F}})
\end{equation}

Here, $(x^{\star}{\mathds{F}},u^{\star}{\mathds{F}},y^{\star}{\mathds{F}})$ with
respect to the equilibrium point satisfies:

\begin{equation}\label{eq:xFsteady}
  0=
  A_{\mathds{F}} x^{\star}_{\mathds{F}}
  +
  B_{\mathds{F}} u^{\star}_{\mathds{F}}
  + R_{\mathds{F}} d_{\mathds{F}}^{\star}
  ,\qquad
  y^{\star}_{\mathds{F}} = C_{\mathds{F}} x^{\star}_{\mathds{F}}
\end{equation}

If expressed in the form of Equation \ref{eq:paraW}, the storage function can be
written as:

\[
  U_{\mathds{F}}(x_{\mathds{F}}):= \frac{\omega_0}{2} x_{\mathds{F}}^{\sf T} M x_{\mathds{F}}
\]

Therefore, the storage function can be expressed as:

\[
  W_{x^{\star}_{\mathds{F}}}(x_{\mathds{F}}) = U_{\mathds{F}}(x_{\mathds{F}}) 
  - U_{\mathds{F}}(x^{\star}_{\mathds{F}}) 
  - \nabla U^{\sf T}_{\mathds{F}}(x^{\star}_{\mathds{F}}) (x_{\mathds{F}}-x^{\star}_{\mathds{F}})
\]

The gradient function of this storage function can be expressed as:

\begin{equation*}%\label{eq:nabW}
  \nabla W_{x^{\star}_{\mathds{F}}}(x_{\mathds{F}}) = \omega_0 M (x_{\mathds{F}} -x^{\star}_{\mathds{F}})
\end{equation*}

Hence, the time derivative of the storage function can be evaluated as:

\begin{equation}\label{eq:tdFds}
  \spliteq{
    \frac{d}{dt} W_{x^{\star}_{\mathds{F}}} \bigl( x_{\mathds{F}}(t) \bigr) 
    &= 
    \nabla W_{x^{\star}_{\mathds{F}}}^{\sf T}\left( x_{\mathds{F}}(t) \right) \dot{x}_{\mathds{F}}(t) \\
    &= 
    \nabla W_{x^{\star}_{\mathds{F}}}^{\sf T}\left( x_{\mathds{F}}(t) \right)
    \left\{
    A_{\mathds{F}} \left( x_{\mathds{F}}(t) -x^{\star}_{\mathds{F}} \right)
    +
    B_{\mathds{F}} \left( u_{\mathds{F}}(t) -u^{\star}_{\mathds{F}} \right)
    \right\}
    \\
    & \leq \textstyle
    (y_{\mathds{F}}(t) -y^{\star}_{\mathds{F}})^{\sf T}
    (u_{\mathds{F}}(t) -u^{\star}_{\mathds{F}})
    - \tfrac{\sfmin \left\{ D_i \right\}}{\omega_0}
    \|y_{\mathds{F}}(t) -y^{\star}_{\mathds{F}}\|^2
  }
\end{equation}

Here, the derivation of the second equality used the relationship in Equation \ref{eq:xFsteady}.

\smallskip
\subsubsection{Analysis of feedback system for mechanical subsystem and automatic power generation controller}

Similar to the mechanical subsystem, the passivity of the broadcast-type PI
controller in equation \ref{eq:condsK} can also be demonstrated. By defining the
storage function as:

\begin{equation}\label{eq:Wxist}
  W_{\xi^{\star}}(\xi) := \frac{1}{2} k_{\rm I} (\xi-\xi^{\star} )^2
\end{equation}
its time derivative can be evaluated as:

\begin{equation}\label{eq:tdKds}
  \spliteq{
    \frac{d}{dt} W_{\xi^{\star}} \bigl( \xi(t) \bigr) 
    &=
    (y_{\mathds{K}} - y_{\mathds{K}}^{\star})^{\sf T} (u_{\mathds{K}} - u_{\mathds{K}}^{\star})
    - k_{\rm P} u_{\mathds{K}}^{\sf T} hh^{\sf T} u_{\mathds{K}} \\
    & \leq (y_{\mathds{K}} - y_{\mathds{K}}^{\star})^{\sf T} (u_{\mathds{K}} - u_{\mathds{K}}^{\star})
  }
\end{equation}
where $(\xi^{\star},u_{\mathds{K}}^{\star},y_{\mathds{K}}^{\star})$ represents
the equilibrium point and Equation \ref{eq:Kdseq} is used. 

\begin{equation}\label{eq:Kdseq}
  \simode{
    0 &=  h^{\sf T} u_{\mathds{K}}^{\star} \\
    y_{\mathds{K}}^{\star} &= h \left(k_{\rm P} h^{\sf T}u_{\mathds{K}}^{\star} +  k_{\rm I} \xi^{\star} \right)
  }
\end{equation}

In system control engineering, it is known that a negative feedback system
between two passive systems becomes passive again. Based on this fact, a
feedback connection is made between the mechanical subsystem $\mathds{F}$ in
Equation \ref{eq:sys1} and the broadcast-type PI controller $\mathds{K}$ in
Equation \ref{eq:condsK}, resulting in the system:

\begin{equation}\label{eq:sysFKds}
  \mathds{F}_+:
  \simode{
    M \Delta \dot{\omega}&= 
    - 
    D
    \Delta\omega 
    - h \left(k_{\rm P} h^{\sf T}\Delta\omega  +  k_{\rm I} \xi \right)  + P_{{\rm mech}}^{\star} + v_{\mathds{F}}
    \\
    \dot{\xi} &= h^{\sf T}\Delta\omega\\
    y_{\mathds{F}}&= \omega_0 \Delta\omega 
  }
\end{equation}
which is strongly passive regardless of the equilibrium point. In fact, adding
the inequalities in Equation \ref{eq:tdFds} and Equation \ref{eq:tdKds}, we
obtain:

\begin{equation}\label{eq:disineqFp}
  \spliteq{
    & \frac{d}{dt}  \left\{
    W_{x^{\star}_{\mathds{F}}}  \bigl( x_{\mathds{F}}(t) \bigr) 
    +
    \omega_0
    W_{\xi^{\star}} \bigl( \xi(t) \bigr) 
    \right\} \\
    & \hspace{3em} \leq 
    (y_{\mathds{F}}(t) -y^{\star}_{\mathds{F}})^{\sf T}
    (v_{\mathds{F}}(t) -v^{\star}_{\mathds{F}})  
    - \tfrac{\sfmin \left\{ D_i \right\}}{\omega_0}
    \|y_{\mathds{F}}(t) -y^{\star}_{\mathds{F}}\|^2
  }
\end{equation}
where Equation \ref{eq:connds1} is used for the input-output relationship.

Furthermore, by using the input-output relationship in equation
\ref{eq:connds2}, combining the machine subsystem $\mathds{F}_+$ in equation
\ref{eq:sysFKds} with $\mathds{G}$ in equation \ref{eq:sys2G} represents the
entire feedback control system incorporating automatic generation control. Based
on this fact, we analyze the passivity of $\mathds{G}$ independent of the
equilibrium point below.

\smallskip
\subsubsection{Analysis of the electrical subsystem}

We analyze the passivity of the electrical subsystem $\mathds{G}$ in equation
(\ref{eq:sys2G}) independent of its equilibrium point. Here, we represent the
column vector containing the time-varying variables $\delta_i$, $E_i$,
$|\bm{V}_i|$, and $\angle \bm{V}i$ related to the generator bus and load bus of
$\mathds{G}$ as $x{\mathds{G}}$. Under this notation, we define the potential
energy function as follows:

\begin{equation}\label{eq:potWx}
  \spliteq{
    U_{\mathds{G}}(x_{\mathds{G}})  := 
    &  \sum_{i=1}^n
    \left\{
    \frac{ \Xsi E_i^2 }{2 \Xti ( \Xsi - \Xti )}  
    - 
    \frac{E_i |\bm{V}_i|}{ \Xti } \sfcos (\delta_i - \angle \bm{V}_i)
    +\frac{|\bm{V}_i|^2}{2 \Xti }
    \right\}
    \\
    - & 
    \sum_{i=n+1}^{n+m}
    \left\{
    P_{{\rm load}i}^{\star} \angle \bm{V}_i
    + Q_{{\rm load}i}^{\star} \ln \left|\bm{V}_i \right|
    \right\} \\
    - & \sum_{i=1}^{N}
    \sum_{j=1}^{N} \frac{B_{ij} }{2} |\bm{V}_i| |\bm{V}_j| \sfcos(\angle \bm{V}_i -\angle \bm{V}_j)
  }
\end{equation}

This potential energy function has been used, for example, in the stability
analysis of power systems consisting of a single-axis generator model and a
constant power load model, as described in
\cite{tsolas1985structure,varaiya1985direct,chiang2011direct}. Based on the
expression in Equation (\ref{eq:paraW}), a candidate storage function is
constructed as follows:

\begin{equation}\label{eq:stops}
  W_{x^{\star}_{\mathds{G}}}(x_{\mathds{G}}) = U_{\mathds{G}}(x_{\mathds{G}}) 
  - U_{\mathds{G}}(x^{\star}_{\mathds{G}}) 
  - \nabla U_{\mathds{G}}^{\sf T}(x^{\star}_{\mathds{G}}) (x_{\mathds{G}}-x^{\star}_{\mathds{G}})
\end{equation}

Its gradient function is:

\[
  \nabla W_{x^{\star}_{\mathds{G}}}(x_{\mathds{G}}) =
  \nabla U_{\mathds{G}}(x_{\mathds{G}}) 
  - \nabla U_{\mathds{G}}(x^{\star}_{\mathds{G}}) 
\]

To calculate the time derivative of the storage function, we need to find the
gradient function of the potential energy function. First, we calculate the
partial derivatives of $U_{\mathds{G}}(x_{\mathds{G}})$ with respect to
$\delta_i$ and $E_i$, which are given by:

\begin{equation*}
  \frac{\partial U_{\mathds{G}}}{\partial \delta_i}(x_{\mathds{G}}) &= \frac{E_i |\bm{V}_i|}{ \Xti } \sfsin (\delta_i - \angle \bm{V}_i) ,
  \\
  \frac{\partial U_{\mathds{G}}}{\partial E_i} (x_{\mathds{G}})&= - \frac{1}{ \Xsi - \Xti }
  \left\{
  -\frac{ \Xsi }{ \Xti }E_i
  +\left(
  \frac{ \Xsi }{ \Xti }-1
  \right)
  |\bm{V}_i| \sfcos (\delta_i - \angle \bm{V}_i ) 
  \right\}
\end{equation*}

Therefore, if each variable follows the differential-algebraic equation of
Equation (\ref{eq:sys2G}), because of Equation \ref{eq:sys2}, the following is
true for all $i\in \mathcal{I}_{\rm G}$:

\begin{equation*}
\frac{\partial U_{\mathds{G}}}{\partial \delta_i}(x_{\mathds{G}})  = y_{\mathds{G}_i}
,\qquad
\frac{\partial U_{\mathds{G}}}{\partial E_i} (x_{\mathds{G}})= 
\frac{V_{{\rm field}i}^{\star} - \taudi\dot{E}_i  }{ \Xsi - \Xti }
\end{equation*}

The partial derivatives of the potential energy function with respect to the
voltage phase variables for $i\in \mathcal{I}_{\rm G}$ are given by:

\begin{equation*}
  \spliteq{
    \frac{\partial U_{\mathds{G}}}{\partial |\bm{V}_i| }(x_{\mathds{G}}) &= 
    -
    \sum_{j=1}^{N} B_{ij}  |\bm{V}_j| \sfcos(\angle \bm{V}_i -\angle \bm{V}_j)- \frac{Q_i}{|\bm{V}_i|}
    \\
    \frac{\partial U_{\mathds{G}}}{\partial \angle \bm{V}_i } (x_{\mathds{G}})&= 
    \sum_{j=1}^{N}
    B_{ij} |\bm{V}_i| |\bm{V}_j| \sfsin(\angle \bm{V}_i -\angle \bm{V}_j)
    -
    P_i
  }
\end{equation*}

Therefore, from Equation \ref{eq:gVeq}, it can be seen that these are equal to
0. Similarly, from Equation \ref{eq:lVeq}, for $i\in \mathcal{I}_{\rm L}$, it
can be seen that:

\begin{equation*}
\spliteq{
\frac{\partial U_{\mathds{G}}}{\partial |\bm{V}_i| }(x_{\mathds{G}}) &= 
- \sum_{j=1}^{N} B_{ij}  |\bm{V}_j| \sfcos(\angle \bm{V}_i -\angle \bm{V}_j)
 -  \frac{Q_{{\rm load}i}^{\star}}{|\bm{V}_i|}
\\
\frac{\partial U_{\mathds{G}}}{\partial \angle \bm{V}_i } (x_{\mathds{G}})&= 
\sum_{j=1}^{N} B_{ij} |\bm{V}_i| |\bm{V}_j| \sfsin(\angle \bm{V}_i -\angle \bm{V}_j)
-
P_{{\rm load}i}^{\star}
}
\end{equation*}

Therefore, it can be seen that for all $i\in \mathcal{I}_{\rm G} \cup \mathcal{I}_{\rm L}$:

\begin{equation*}
  \frac{\partial U_{\mathds{G}}}{\partial |\bm{V}_i| } (x_{\mathds{G}})= 0
  ,\qquad
  \frac{\partial U_{\mathds{G}}}{\partial \angle \bm{V}_i } (x_{\mathds{G}})= 0
\end{equation*}

\begin{subequations}\label{eq:eqeq}

Next, consider the set
$(x^{\star}_{\mathds{G}},u^{\star}_{\mathds{G}},y^{\star}_{\mathds{G}})$ related
to the steady-state of $\mathds{G}$ with respect to $\nabla
U{\mathds{G}}(x^{\star}{\mathds{G}})$. From the equilibrium condition, there
exists a set of voltage phasors $(|\bm{V}_i^{\star}|, \angle
\bm{V}_i^{\star})_{i\in \mathcal{I}_{\rm G} \cup \mathcal{I}_{\rm L} }$ such
that:

\begin{equation}\label{eq:eqeqa}
  &\simode{
  0 & = u_{\mathds{G}_i}^{\star} \\
  0 & =
  -\tfrac{ \Xsi }{ \Xti }E_i^{\star}
  +\left(
  \tfrac{ \Xsi }{ \Xti }-1
  \right)
  |\bm{V}_i^{\star}| \sfcos (\delta_i^{\star} - \angle \bm{V}_i^{\star} ) 
  +V_{{\rm field}i}^{\star}
  } \\
  &\simode{
  P_i^{\star} 
  & =
  \sum_{j=1}^{N} B_{ij} |\bm{V}_i^{\star}| |\bm{V}_j^{\star}| \sfsin(\angle \bm{V}_i^{\star} -\angle \bm{V}_j^{\star})
  \\
  Q_i^{\star} 
  &=
  - \sum_{j=1}^{N} B_{ij} |\bm{V}_i^{\star}| |\bm{V}_j^{\star}| \sfcos(\angle \bm{V}_i^{\star} -\angle \bm{V}_j^{\star})
}
\end{equation}

However, $i \in \mathcal{I}_{\rm G}$ and the steady-state values of active and
reactive power are:

\begin{equation*}%\label{eq:PQoutagcst}
  P_i^{\star}  :=  \frac{E_i^{\star}  |\bm{V}_i^{\star} |}{ \Xti } 
  \sfsin (\delta_i^{\star}  - \angle \bm{V}_i^{\star} ), \qquad
  Q_i^{\star}  :=  \frac{ E_i^{\star} |\bm{V}_i^{\star} | }{ \Xti } 
  \sfcos (\delta_i^{\star}  - \angle \bm{V}_i^{\star} )
  -\frac{|\bm{V}_i^{\star} |^2}{ \Xti }
\end{equation*}

In addition, $y_{\mathds{G}_i}^{\star}$ represents $P_i^{\star}$. Therefore,
the following holds for $ i \in \mathcal{I}_{\rm G} $:

\begin{equation*}
  \frac{\partial U_{\mathds{G}}}{\partial \delta_i}(x^{\star}_{\mathds{G}}) = y_{\mathds{G}_i}^{\star}
  ,\qquad
  \frac{\partial U_{\mathds{G}}}{\partial E_i}(x^{\star}_{\mathds{G}}) = 
  \frac{V_{{\rm field}i}^{\star}  }{ \Xsi - \Xti }
\end{equation*}

Similarly, since the following holds for all $ i \in \mathcal{I}_{\rm L} $:

\begin{equation}
  \simode{
    &P_{{\rm load}i}^{\star}=
    \sum_{j=1}^{N} B_{ij} |\bm{V}_i^{\star}| |\bm{V}_j^{\star}| \sfsin(\angle \bm{V}_i^{\star} -\angle \bm{V}_j^{\star}) 
    \\
    &Q_{{\rm load}i}^{\star}
    =
    -\sum_{j=1}^{N} B_{ij} |\bm{V}_i^{\star}| |\bm{V}_j^{\star}| \sfcos(\angle \bm{V}_i^{\star} -\angle \bm{V}_j^{\star})
  }
\end{equation}
\end{subequations}

The partial differential related to the voltage phasor variables of the bus bars becomes:

\begin{equation*}
  \frac{\partial U_{\mathds{G}}}{\partial |\bm{V}_i| }(x^{\star}_{\mathds{G}})= 0
  ,\qquad
  \frac{\partial U_{\mathds{G}}}{\partial \angle \bm{V}_i } (x^{\star}_{\mathds{G}})= 0
\end{equation*}
for all $i\in \mathcal{I}_{\rm G} \cup \mathcal{I}_{\rm L}$.

Based on the above calculation results, the time derivative along the solution
trajectory of the storage function for $\mathds{G}$ can be evaluated as follows:

\begin{equation}\label{eq:disineqGds}
  \spliteq{
    \frac{d}{dt}W_{x^{\star}_{\mathds{G}}} \bigl(x_{\mathds{G}}(t) \bigr)
    & =
    \nabla W_{x^{\star}_{\mathds{G}}}^{\sf T} \bigl(x_{\mathds{G}}(t) \bigr)
    \dot{x}_{\mathds{G}}(t) \\
    &=
    \sum_{i=1}^n
    \left(
    (u_{\mathds{G}_i}- u_{\mathds{G}_i}^{\star}) (y_{\mathds{G}_i}-y_{\mathds{G}_i}^{\star})
    -
    \frac{\taudi}{ \Xsi - \Xti }
    \dot{E}_i^2
    \right)\\
    & \leq 
    (y_{\mathds{G}}-y_{\mathds{G}}^{\star})^{\sf T} (u_{\mathds{G}}- u_{\mathds{G}}^{\star})
  }
\end{equation}
where we used $u_{\mathds{G}}^{\star}=0$ from equation \ref{eq:eqeqa}. This
implies that the function $W_{x^{\star}_{\mathds{G}}}(x{\mathds{G}})$ in
Equation \ref{eq:stops} is a passive storage function independent of the
equilibrium point of the electrical subsystem $\mathds{G}$. Note that the
domains of $x_{\mathds{G}}$ and $x_{\mathds{G}}^{\star}$ are limited to the
region where $W_{x^{\star}_{\mathds{G}}}(x_{\mathds{G}})$ is a semi-positive
definite function, that is, the region where the potential energy function
$U_{\mathds{G}}(x_{\mathds{G}})$ in Equation \ref{eq:potWx} is a convex
function. This will be discussed in the next section.

\subsection{Stability analysis of frequency stabilization control system\advanced}\label{sec:potconv}

\smallskip
\subsubsection{Stability analysis of unknown equilibrium points based on passivity}

In the following, we analyze the stability of a feedback control system with
automatic generation control, using passivity-based stability analysis of the
linearized model as in Section \ref{sec:linmathana}, but assuming that the value
of the storage function given by equation \ref{eq:stops},
$W_{x^{\star}_{\mathds{G}}}\bigl(x_{\mathds{G}}(t) \bigr)$, is non-negative for
all times $t$, for the trajectory $x_{\mathds{G}}(t)$ of the electrical
subsystem $\mathds{G}$. We discuss this assumption in the next subsection.

Using the relationship of Equation \ref{eq:connds2} to the sum of inequalities
in Equation \ref{eq:disineqFp} and Equation \ref{eq:disineqGds}, we obtain the
following for the entire feedback control system.

\[
  \frac{d}{dt}  \left\{
  W_{x^{\star}_{\mathds{F}}}  \bigl( x_{\mathds{F}}(t) \bigr) 
  +
  \omega_0
  W_{\xi^{\star}} \bigl( \xi(t) \bigr) 
  +
  W_{x^{\star}_{\mathds{G}}} \bigl(x_{\mathds{G}}(t) \bigr)
  \right\} 
  \leq 
  - \tfrac{\sfmin \left\{ D_i \right\}}{\omega_0}
  \|y_{\mathds{F}}(t) -y^{\star}_{\mathds{F}}\|^2
\]

From this inequality, it can be seen that the sum of the storage functions is
monotonically non-increasing. Moreover, since the lower bound is 0, the sum
asymptotically converges to a certain value as time passes. That is, the time
derivative of the left-hand side asymptotically approaches 0. Therefore, it
follows that:

\[
  \lim_{t\rightarrow \infty}
  y_{\mathds{F}}(t) = y^{\star}_{\mathds{F}}
\]

Furthermore, focusing on the output equation of equation \ref{eq:sys1}, the
output $y_{\mathds{F}}$ is a constant multiple of the internal state $\Delta
\omega$, and therefore for the mechanical subsystem $\mathds{F}$, the following
holds: 

\begin{equation}\label{eq:Fobsnl}
y_{\mathds{F}}(t)  =y^{\star}_{\mathds{F}},\quad \forall t\geq 0 
\qquad \Longrightarrow \qquad
\Delta \omega(t)  =\frac{1}{\omega_0} y^{\star}_{\mathds{F}},\quad \forall t\geq 0 
\end{equation}

Furthermore, as analyzed in Section \ref{sec:phsync}, the frequency derivation
of all generators converges on the same value. This fact implies that there
exists a constant $\gamma_0$ such that:

\[
  y^{\star}_{\mathds{F}} = \gamma_0 \mathds{1}
\]

On the other hand, from the first equation of Equation \ref{eq:Kdseq}, we have:

\[
  0=h^{\sf T} u_{\mathds{K}}^{\star} 
  = \frac{1}{\omega_0}h^{\sf T} y^{\star}_{\mathds{F}}
  =\frac{\gamma_0}{\omega_0} h^{\sf T} \mathds{1}
\]

Here, since $h^{\sf T} \mathds{1}$ is not zero, it is inferred that $\gamma_0$
is zero. Therefore, it is shown that the angular frequency deviation of all
generators converges to zero asymptotically, that is:

\[
  \lim_{t\rightarrow \infty}
  \Delta \omega (t) = 0
\]

Additionally, it is also understood that, for all $i\in \mathcal{I}_{\rm G}$,
the following holds:

\[
  \lim_{t\rightarrow \infty}
  P_{{\rm mech}i}(t) 
  =
  \lim_{t\rightarrow \infty} P_i (t)
\]

However, the convergence values of the mechanical inputs and effective power are
generally impossible to calculate in advance because the power consumption of
loads and the impedance of transmission lines, etc., are unknown in reality.
Similarly, the internal states of the electrical subsystem $\mathds{G}$ and the
voltage phase variables of the busbars in Equation \ref{eq:sys2G} also converge
to unknown values asymptotically.

\begin{table}[h]
\medskip
\caption{\textbf{Temporal change of accumulated energy}} \label{table:pflownl}
 \centering
  {
  \begin{minipage}{0.49\linewidth}
    \centering
  \begin{tabular}{|c|c|c|c|c|c|c|}
   \hline
 &  Bus 1 & Bus 2 & Bus 3 \\
   \hline 
   $P_i^{\star}$ & 2.5000 & $-3$ & 0.5 \\
   \hline
   $Q_i^{\star}$ & 0.1044 & 0 & 0.0365 \\
   \hline
   $|\bm{V}_i^{\star}|$ & 2 & 1.9984 & 2 \\
   \hline
   $\angle \bm{V}_i^{\star}$ & 0 & $-0.0539$ & $-0.0420$ \\
   \hline
  \end{tabular}
  \subcaption{Steady-state power flow state 1}
  \end{minipage}
  \begin{minipage}{0.49\linewidth}
    \centering
  \begin{tabular}{|c|c|c|c|c|c|c|}
   \hline
 &  Bus 1 & Bus 2 & Bus 3 \\
   \hline 
   $P_i^{\star}$ & 0.5 & $-3$ & 2.5000 \\
   \hline
   $Q_i^{\star}$ & 0.0432 & 0 & 0.1111 \\
   \hline
   $|\bm{V}_i^{\star}|$ & 2 & 1.9983 & 2 \\
   \hline
   $\angle \bm{V}_i^{\star}$ & $-0.0488$ & $-0.0595$ & 0 \\
   \hline
  \end{tabular}
   \subcaption{Steady-state power flow state 2}
  \end{minipage}
  }
\end{table}

\begin{example}{Time variation of stored energy}\label{ex:nonlinene}
Consider a power system model consisting of two generators and a constant power
load model, as in Examples \ref{ex:agcdemo} and \ref{ex:pfvary}. The admittance
value of the transmission line is set to the value in Equation
\ref{eq:bothlossless} with the conductance component set to 0. The physical
constants of the generators are set as in Examples \ref{ex:agcdemo} and
\ref{ex:pfvary}.  The broadcast-type PI controller in Equation \ref{eq:agccon}
is set with the parameters in Table \ref{table:agcpara} (b).

For the initial values of the generators, the steady-state values corresponding
to the two steady-state flow states shown in Table \ref{table:pflownl} are set.
The time response of the power system until the steady-state flow state in which
the active power of generators 1 and 3 are equal is achieved is then calculated.
The values of $W_{x^{\star}_{\mathds{F}}}(x_{\mathds{F}})$ in Equation
\ref{eq:WxFst}, $W_{\xi^{\star}}(\xi)$ in Equation \ref{eq:Wxist}, and
$W_{x^{\star}_{\mathds{G}}}(x_{\mathds{G}})$ in Equation \ref{eq:stops} are
calculated for the time response, and the results are shown in Figure
\ref{fig:LyapWnlin} (a) and (b).  The blue, red, and green solid lines represent
$W_{x^{\star}_{\mathds{F}}}(x_{\mathds{F}})$,
$W_{x^{\star}_{\mathds{G}}}(x_{\mathds{G}})$, and $W_{\xi^{\star}}(\xi)$,
respectively.  The black dashed line represents their sum.  From these figures,
it can be seen that while exchanging energy among the three components, the
total energy of the entire power system monotonically decreases.
\end{example}


\begin{figure}[t]
  \centering
  {
  \begin{minipage}{0.49\linewidth}
    \centering
    \includegraphics[width = 1.0\linewidth]{figs/Wnlin1}
    \subcaption{Initial values corresponding to steady-state condition 1}
%    \medskip
  \end{minipage}
  \begin{minipage}{0.49\linewidth}
    \centering
    \includegraphics[width = 1.0\linewidth]{figs/Wnlin2}
    \subcaption{Initial values corresponding to steady-state condition 2}
%    \medskip
  \end{minipage}
  }
  \medskip
  \caption{\textbf{The time variation of the storage function for the initial value response}
  \\  \centering(Blue: $W_{x^{\star}_{\mathds{F}}}$, Red:$W_{x^{\star}_{\mathds{G}}}$,
  Green: $W_{\xi^{\star}}$, Black: Total sum)}
  \label{fig:LyapWnlin}
\medskip
\end{figure}

\smallskip
\subsubsection{The range where the potential energy function is convex}

In the following, we show that the conditions for the potential energy function
$U_{\mathds{G}}(x_{\mathds{G}})$ in Equation \ref{eq:potWx} to be a convex
function correspond to the passive power transmission conditions (i) and (iii)
discussed in Definition \ref{def:passtrans} in the analysis of the passive
properties of the linear approximation model. Note that assumption (ii) of the
passive power transmission conditions is assumed in this section.

We consider the case where generators are connected to all buses, in accordance
with the setting of the linear approximation model in Section
\ref{sec:linpasana}. That is, the subscripts for the generator buses and load
buses are

\[
  \mathcal{I}_{\rm G} = \{1,\ldots,N\}
  ,\qquad
  \mathcal{I}_{\rm L} = \emptyset
\]

In this case, applying the Kron reduction to the generator buses allows us to
obtain an equivalent system of ordinary differential equations for the
electrical subsystem $\mathds{G}$ in Equation \ref{eq:sys2G}, with respect to $i
\in \mathcal{I}_{\rm G}$, given by:

\begin{equation*}%\label{eq:kronGds}
  \mathds{G}_i : 
  \simode{
    \dot{\delta}_i &= u_{\mathds{G}_i}
    \\
    \taudi \dot{E}_i & = 
    -\tfrac{ \Xsi }{ \Xti }E_i
    - \left(
    \Xsi - \Xti
    \right)
    \sum_{j=1}^{N}
    E_j 
    B_{ij}^{\rm red}
    \sfcos \delta_{ij}
    + V_{{\rm field}i}^{\star}
    \\
    y_{\mathds{G}_i}&=  -E_i \sum_{j=1}^{N}
    E_j 
    B_{ij}^{\rm red}
    \sfsin \delta_{ij}
  }
\end{equation*}
where $\delta_{ij}$ denotes $\delta_i -\delta_j$. Also, the reduced susceptance
$B_{ij}^{\rm red}$ is defined as the $(i,j)$-th element of the matrix $B^{\rm
red}$, which is obtained by combining the susceptance matrix $B$ of the power
network in Eq. (\ref{eq:sys2G}), and is defined as follows:

\begin{equation}\label{eq:susred}
  B^{\rm red}
  := -
  \bigl\{
  \sfdiag \left( \Xti \right)   
  -
  \sfdiag \left( \Xti \right) B \sfdiag \left( \Xti \right)
  \bigr\}^{-1}
\end{equation}

The potential energy function of Equation \ref{eq:potWx} corresponding to the expression of this ordinary differential equation system is:
\begin{align}\label{eq:potWxred}
U_{\mathds{G}}^{\rm red} (z_{\mathds{G}})  := 
 \frac{1}{2} 
\sum_{i=1}^N
\left\{
\frac{ \Xsi E_i^2 }{ \Xti ( \Xsi - \Xti )}  
+ E_i \sum_{j=1}^{N}
 E_j 
B_{ij}^{\rm red}
\sfcos \delta_{ij}
\right\}
\end{align}
where the vector with all $\delta_i$ and $E_i$ is expressed as $z_{\mathds{G}}$.
If we calculate the partial differential related to the internal state, the following is obtained:
\begin{align*}
\frac{\partial U_{\mathds{G}}^{\rm red} }{\partial \delta_i}(z_{\mathds{G}})  = y_{\mathds{G}_i}
,\qquad
\frac{\partial U_{\mathds{G}}^{\rm red} }{\partial E_i} (z_{\mathds{G}}) = 
\frac{V_{{\rm field}i}^{\star} - \taudi\dot{E}_i  }{ \Xsi - \Xti }
\end{align*}
Similarly, the following is true for the steady state:
\begin{align*}
\frac{\partial U_{\mathds{G}}^{\rm red} }{\partial \delta_i} ( z^{\star}_{\mathds{G}} )
= y_{\mathds{G}_i}^{\star}
,\qquad
\frac{\partial U_{\mathds{G}}^{\rm red} }{\partial E_i} ( z^{\star}_{\mathds{G}} ) = 
\frac{V_{{\rm field}i}^{\star}  }{ \Xsi - \Xti }
\end{align*}
Therefore, if we define the corresponding storage function as:
\[ 
W_{z^{\star}_{\mathds{G}}}^{\rm red} (z_{\mathds{G}}) = U_{\mathds{G}}^{\rm red} (z_{\mathds{G}}) 
- U_{\mathds{G}}^{\rm red} (z^{\star}_{\mathds{G}}) 
- \left\{ \nabla U_{\mathds{G}}^{\rm red}(z^{\star}_{\mathds{G}}) \right\}^{\sf T}
 (z_{\mathds{G}}-z^{\star}_{\mathds{G}})
\]
similar to Equation \ref{eq:disineqGds}, its time derivative can be evaluated as:
\[
\frac{d}{dt}W_{z^{\star}_{\mathds{G}}}^{\rm red} \bigl(z_{\mathds{G}}(t) \bigr)
 \leq 
(y_{\mathds{G}}-y_{\mathds{G}}^{\star})^{\sf T} (u_{\mathds{G}}- u_{\mathds{G}}^{\star})
\]
Note that all elements of the contracted susceptance matrix $B^{\rm red}$ in Equation \ref{eq:susred} are nonpositive.
This fact can be shown as follows
From the discussion in the \ref{sec:admathp} clause, the susceptance matrix $B$ is a negative definite matrix with non-diagonal elements that are nonnegative.
Therefore:
\[
B_{-}:= \sfdiag \left( \Xti \right)   
-
\sfdiag \left( \Xti \right) B \sfdiag \left( \Xti \right)
\]
is a positive definite matrix with non-diagonal elements that are nonpositive,\textbf{M-matrix}.
It is known that all the elements of the inverse of the M-matrix are nonnegative \cite{kodama1981system}.
Therefore, all elements of $B^{\rm red}=-B_-^{-1}$ are nonpositive.

\begin{COLUMN}
\noindent \textbf{Hessian matrix}：
A condition necessary for a second-order differentiable function $f:\mathbb{R}^n\rightarrow \mathbb{R}$ to be a convex function over a certain range $\mathcal{X}$ is that the following is positive semi-definite for all $x\in \mathcal{X}$:
\[
\nabla^2 f(x):=
\mat{
\tfrac{\partial^2 f}{\partial x_1^2} (x) & \cdots & \tfrac{\partial^2 f}{\partial x_1 \partial x_n} (x) \\
\vdots & \ddots & \vdots \\
\tfrac{\partial^2 f}{\partial x_n \partial x_1} (x) & \cdots &\tfrac{\partial^2 f}{\partial x_n^2} (x)
}
\]
This matrix is called the \textbf{Hessian matrix} of the function $f$ \cite{boyd2004convex}.
\end{COLUMN}

The fact that the potential energy function $U_{\mathds{G}}^{\rm red} (z_{\mathds{G}})$ of Equation \ref{eq:potWxred} being a convex function is characterized by the fact that the Hessian matrix $\nabla^2 U_{\mathds{G}}^{\rm red} (z_{\mathds{G}})$ is a positive semi-definite matrix.
\begin{align}\label{eq:UGhess}
\nabla^2 U_{\mathds{G}}^{\rm red} (z_{\mathds{G}})
=
\mat{
L(z_{\mathds{G}})  &  - \hat{B}^{\sf T}(z_{\mathds{G}}) \\
- \hat{B}(z_{\mathds{G}}) & -\hat{A}(z_{\mathds{G}})
}
\end{align}
in the $(i,j)$th element.
\begin{align*}
\spliteq{
L_{ij}(z_{\mathds{G}}) & := 
\frac{\partial^2 U_{\mathds{G}}^{\rm red} }{\partial \delta_i \partial \delta_j} (z_{\mathds{G}})
=
\left\{
\begin{array}{cl}
-E_i \sum_{j=1, j\neq i}^{N} E_j B_{ij}^{\rm red} \sfcos(\delta_{ij}), &\quad i=j \\
E_i  E_j B_{ij}^{\rm red} \sfcos(\delta_{ij}), & \quad i\neq j
\end{array}
\right.
  \\
\hat{A}_{ij}(z_{\mathds{G}}) &:=  
- \frac{\partial^2 U_{\mathds{G}}^{\rm red} }{\partial E_i \partial E_j} (z_{\mathds{G}})
=
\left\{
\begin{array}{cl}
-\left(B_{ii}^{\rm red}+\tfrac{ \Xsi }{ \Xti ( \Xsi - \Xti )} \right), &\quad i=j \\
-B_{ij}^{\rm red} \sfcos(\delta_{ij}), & \quad i\neq j
\end{array}
\right. \\
\hat{B}_{ij}(z_{\mathds{G}})  &:= 
- \frac{\partial^2 U_{\mathds{G}}^{\rm red} }{\partial E_i \partial \delta_j} (z_{\mathds{G}})
=
\left\{
\begin{array}{cl}
\sum_{j=1, j\neq i}^{N} E_j B_{ij}^{\rm red} \sfsin(\delta_{ij}), &\quad i=j \\
-E_j B_{ij}^{\rm red} \sfsin(\delta_{ij}), & \quad i\neq j
\end{array}
\right. 
}
\end{align*}
$\nabla^2 U_{\mathds{G}}^{\rm red} (z_{\mathds{G}}^{\star})$, which is an evaluation of the Hessian matrix of Equation \ref{eq:UGhess} with the equilibrium point, is the same as the matrix $P_G$ of Equation \ref{eq:defPG} which appeared in the passivity analysis of the electrical subsystem that was linearly approximated in Section \ref{sec:linpasana}.
The positive semi-definite nature of this $P_G$ guaranteed that the storage function that shows the passivity of the linear approximation model of $\mathds{G}$ is a positive semi-definite function.
As such, a condition necessary for $U_{\mathds{G}}^{\rm red} (z_{\mathds{G}}^{\star})$ to be a convex function is equal to the condition necessary for $P_G$ to be positive semi-definite, which is also equal to the passive power transmission conditions (i) and (iii) holding.

If we consider this along with the result of Section \ref{sec:linmathana}, it is defined as a range where the potential energy function $U_{\mathds{G}}^{\rm red} (z_{\mathds{G}})$ of Equation \ref{eq:potWxred} becomes a convex function:
\[
\mathcal{E}_{\mathds{G}}:=
\left\{
z_{\mathds{G}}^{\star} : \nabla^2 U_{\mathds{G}}^{\rm red} (z_{\mathds{G}}^{\star}) 
\succeq 0
\right\}
\]
however, it is also the “maximum” equilibrium point set that is able to present frequency stability based on passivity.
The reason for this is, as was shown in Section \ref{sec:nesconana}, is that the passive power transmission conditions are conditions necessary for an electrical subsystem that was linearly approximated near a specific equilibrium point to be passive.
In other words, at an equilibrium point $z_{\mathds{G}}^{\star}$, where $\nabla^2 U_{\mathds{G}}^{\rm red} (z_{\mathds{G}}^{\star}) $ is not positive semi-definite, the electrical subsystem $\mathds{G}$ does not become passive.

In contrast, if the initial value $z_{\mathds{G}}(0)$ of the electrical subsystem is set near the equilibrium point $z_{\mathds{G}}^{\star}$ belonging to the set $\mathcal{E}_{\mathds{G}}$,
for all combinations of physical parameters $(M_,D_i,\taudi)_{i \in \mathcal{I}_{\rm G}}$,
the entire feedback control system asymptotically converges to a steady power flow distribution where supply and demand are balanced.

\section{Transient stabilization control}\label{sec:transcont}

\subsection{Decentralized control of generators with excitation system}

In an electrical power system, when discussing the stable range size for an equilibrium point and the level of stability, the term \textbf{transient stability} is often used.
In this Section, we provide an outline of the mathematical model and the properties of the \textbf{excitation system} implemented to improve the transient stability of an electrical power system.
The excitation system is a localized controller that is usually installed “individually” to each generator.
It locally measures the voltage phasor and current phasor of the bus bar to which the generator is connected, and the internal state of the generator, to control by automatically adjusting the field voltage. The main element of the excitation system is a control equipment called an \textbf{automatic voltage regulator (AVR)} that maintains the desired bus bar voltage. Furthermore, an additional control algorithm, called a \textbf{power system stabilizer (PSS)} might be incorporated to control the disturbance caused by the AVR.
From Section \ref{sec:avrov} to Section \ref{sec:pssov}, we explain the standard models and control effects.

%\[
%\tau_{{\rm d}} \dot{E}  = 
% - \left\{ \tfrac{X_{{\rm d}}}{X_{{\rm d}}'}E
%-\left(
%\tfrac{X_{{\rm d}i}}{X_{{\rm d}i}'}-1
%\right)
%|\bm{V}_i| \sfcos (\delta_i - \angle \bm{V}_i ) 
%\right\}
%+ V_{{\rm field}i}
%\]
%
%\[
%\taudi \dot{E}_i  = 
% - E_i
%-(
%X_{{\rm d}i} - X_{{\rm d}i}'
%)
%|\bm{I}_i| \sfsin (\delta_i - \angle \bm{I}_i ) 
%+ V_{{\rm field}i}
%\]
%
%




\subsection{Standard AVR model}\label{sec:avrov}

There are many standardized AVR models.
For example, a report on standardization by the IEEE \cite{ieee2016ieee} lists more than 40 types of standard models.
AVR models are roughly divided into DC, AC, and Static models.
Below, we discuss typical DC and static models.


First, let us talk about the \textbf{IEEE Type DC1 excitation system model}, which is an AVR DC model.
Please see \cite[Section 7.9.2]{anderson2008power} and \cite[Section 8.6.3]{kundur1994power} for the model details.
Here, we discuss AVR of generators connected to the bus bar $i$, but for the sake of simplification, we omit subscripts $i$.
Specifically, we use the generator model discussed in Section \ref{sec:genfund}:
\begin{align}\label{eq:gendifavr}
\simode{
\dot{\delta}&= \omega_0  \Delta \omega\\
M   \Delta \dot{\omega}&= 
 - D \Delta\omega  
 - P
+P_{{\rm mech}}
\\
\taud \dot{E} & = 
- \Ifd 
+ V_{{\rm field}}
}
\end{align}
For the purpose of discussion, we defined: which is equivalent to the value of the field current of generators with the unit system of pu.
\begin{align}\label{eq:efield}
\Ifd := \frac{ \Xs }{ \Xt }E
-\left(
\frac{ \Xs }{ \Xt }-1
\right)
|\bm{V}| \sfcos (\delta - \angle \bm{V} )
\end{align}
The active power and reactive power output by generators are:
%\begin{align*}
%\spliteq{
%P & =  \frac{E |\bm{V} |}{ \Xt } \sfsin(\delta -  \angle \bm{V}), \\
%Q & =  \frac{E |\bm{V} |}{ \Xt } \sfcos (\delta - \angle \bm{V}) - \frac{|\bm{V}|^2}{ \Xt }
%}
%\end{align*}
\[
P  =  \frac{E |\bm{V} |}{ \Xt } \sfsin(\delta -  \angle \bm{V}), \qquad
Q  =  \frac{E |\bm{V} |}{ \Xt } \sfcos (\delta - \angle \bm{V}) - \frac{|\bm{V}|^2}{ \Xt }
\]
In a case involving a salient pole generator model discussed in Section \ref{sec:genmodadv}, $\Ifd$ is defined by substituting $\Xt$ and $\Xs$ of Equation \ref{eq:efield} with $X_{{\rm d}}'$，$X_{\rm d}$.

As shown in \FIGref{fig:avrdc1}, the IEEE Type DC1 excitation system model is a regulator that inputs the absolute value $|\bm{V}|$ of the bus bar voltage phasor and outputs the field voltage $V_{\rm field}$ of generators.
However, as supplementary input signals, reference signal $V_{\rm ref}^{\star}$ that adjusts the absolute value of bus bar voltage phasor to the desired value and control signal $V_{\rm pss}$ output by PSS are added.
The IEEE Type DC1 excitation system model of AVR consists of four basic types of equipment — \textbf{voltage transformer}, \textbf{comparator}, \textbf{amplifier}, and \textbf{exciter} — as well as a supplementary \textbf{stabilizing circuit}.
Below, we explain the dynamic characteristics of each.


\begin{figure}[t]
\centering
\includegraphics[width = 0.99\linewidth]{figs/avrdc1}
\medskip
\caption{\textbf{IEEE DC1 type model of automatic voltage regulator}}
\label{fig:avrdc1}
\medskip
\end{figure}


\smallskip
\subsubsection{Voltage transformer}

\begin{subequations}\label{eq:stanAVR}
This is a piece of equipment that lowers the bus bar voltage to a usable voltage for the control circuit, and its dynamic characteristic is modelled as a first-order lag filter:
\begin{align}\label{eq:trnsmod}
\tau_{\rm tr} \dot{V}_{\rm tr} = - V_{\rm tr} +  |\bm{V}|
\end{align}
Generally, the time constant $\tau_{\rm tr}$ is sufficiently small; thus, an output $V_{\rm tr}$ of the voltage transformer is almost the same as the absolute value $|\bm{V}|$ of the bus bar voltage phasor.

\smallskip
\subsubsection{Comparator}

This is a piece of equipment that outputs the difference between the voltage transformer output $V_{\rm tr}$ and the reference signal $V_{\rm ref}^{\star}$.
PSS output $V_{\rm pss}$ discussed below is added as a signal that adjusts a constant, $V_{\rm ref}^{\star}$.
In addition, if a stabilizing circuit of the excitation system is to be incorporated, its output $V_{\rm st}$ is also fed back.
In other words, the comparator is modelled as:
\begin{align}\label{eq:compmod}
V_{\rm com} = V_{\rm ref}^{\star} + V_{\rm pss}- V_{\rm tr}
- V_{\rm st}
\end{align}
As discussed, since $V_{\rm tr}$ is almost the same as $|\bm{V}|$, if PSS output $V_{\rm pss}$ and the stabilizing circuit output $V_{\rm tr}$ are 0, the comparator output $V_{\rm com}$ is almost the same as the difference between the reference signal and the absolute value of the bus bar voltage phasor $V_{\rm ref}^{\star} - |\bm{V}|$

\smallskip
\subsubsection{Amplifier}

This is a piece of equipment to drive the exciter by multiplying the output of the comparator $V_{\rm com}$. There are many types such as rotary and electromagnetic types, but in most cases, it is modelled as:
\begin{align}\label{eq:ampmod}
\tau_{\rm ap} \dot{V}_{\rm ap}=
\left\{
\begin{array}{cl}
- V_{\rm ap} + k_{\rm ap} V_{\rm com}, & \mbox{$V_{\rm ap}^{\rm min} < V_{\rm ap} < V_{\rm ap}^{\rm max}$ ~or~ $V_{\rm ap} V_{\rm com}\leq 0$ } \\
0, & \mbox{otherwise}
\end{array}
\right.
\end{align}
%\begin{align}\label{eq:ampmod}
%\tau_{\rm ap} \dot{V}_{\rm ap}=
%\left\{
%\begin{array}{cl}
%0, & V_{\rm ap}\in \{ V_{\rm ap}^{\rm min},V_{\rm ap}^{\rm max} \},\ V_{\rm ap}V_{\rm com}>0\\
%- V_{\rm ap} + k_{\rm ap} V_{\rm com}, & \mbox{otherwise}
%\end{array}
%\right.
%\end{align}
%\begin{align}\label{eq:ampmod}
%\simode{
%\tau_{\rm ap} \dot{V}_{\rm ap} & = - V_{\rm ap} + k_{\rm ap} V_{\rm com} \\
%V_{\rm ap}^{\rm sat} & = \sfsat(V_{\rm ap};V_{\rm ap}^{\rm min},V_{\rm ap}^{\rm max})
%}
%\end{align}
Time constant $\tau_{\rm ap}$ and gain $k_{\rm ap}$ are non-negative constants, and saturation that limits the internal state $V_{\rm ap}$ within the range of $[V_{\rm ap}^{\rm min},V_{\rm ap}^{\rm max}]$ is expressed by conditional branching. 
Saturation might be set for output instead of the internal state.
In a transient state relative to large disturbances, such as ground faults, the range of the upper and lower limits of saturation might be set to be large \cite[Section 4.3]{sauer2017power}.

\smallskip
\subsubsection{Exciter}

This is a piece of equipment that generates field voltage from the amplifier output $V_{\rm ap}^{\rm sat}$, and is modelled as a nonlinear first-order system:
\begin{align}\label{eq:extmod}
\tau_{\rm ex}\dot{V}_{\rm field} =
- \Bigl( 
a_{\rm ex} + 
\underbrace{\alpha_{\rm ex} e^{\beta_{\rm ex} V_{\rm field}}}_{\ast} 
\Bigr) V_{\rm field}
+V_{\rm ap}
\end{align}
Though $\tau_{\rm ex}$ is a positive constant, the sign of $a_{\rm ex}$ varies between papers.
In addition, the term expressed with “$\ast$” is nonlinear because of the impact of magnetic saturation in the exciter, and $\alpha_{\rm ex}$ and $\beta_{\rm ex}$ are both non-negative.
Each constant is set so that dynamic characteristic of the exciter is stable near the usual operating point.

\smallskip
\subsubsection{Stabilizing circuit}

This is a supplementary circuit installed to improve the stability of the excitation system.
In the IEEE Type DC1 excitation system model, it is expressed as a feedback mechanism of the differential value of the field voltage; in other words, its dynamic characteristic is expressed as:
\begin{align}\label{eq:stcmod}
\tau_{\rm st}\dot{V}_{\rm st} =
- V_{\rm st}
+ k_{\rm st} \dot{V}_{\rm field}
\end{align}
The time constant $\tau_{\rm st}$ and gain $k_{\rm st}$ are non-negative This output of the stabilizing circuit $V_{\rm st}$ is fed back to the comparator of Equation \ref{eq:compmod}.
\end{subequations}

The IEEE Type DC1 excitation system model of AVR is a combination of Equation \ref{eq:trnsmod} to Equation \ref{eq:stcmod} discussed above.
The reference values of each parameter are summarized in \ref{table:AVRpara1} and \ref{table:AVRpara2}.
The unit of the time constant is [s] while other units are [pu].


\begin{table}[h]
\medskip
 \caption{\textbf{Parameter example of IEEE DC1 type model}}
 \label{table:AVRpara1}
 \centering
  \begin{tabular}{lcccccc}
   \hline
 &  $\tau_{\rm tr}$ & $\tau_{\rm ap}$ & $k_{\rm ap}$ & $V_{\rm ap}^{\rm max}$ & $V_{\rm ap}^{\rm min}$ \\
   \hline \hline
   例1 \cite[Table D.3. Unit F2]{anderson2008power}& 0.00 & 0.05 & 57.1 & 1.00 & $-1.00$\\
   例2 \cite[Table 7.3]{sauer2017power}& 0.00 & 0.2 & 20 & $\infty$ & $-\infty$\\
%   例2 \cite[8.6.3節]{kundur1994power}& 0.05 & 0.89 & 187 & 1.70 & $ -1.70 $\\
   \hline
  \end{tabular}
\end{table}

\begin{table}[h]
\medskip
 \caption{\textbf{Parameter example of IEEE DC1 type model (continued)}}
 \label{table:AVRpara2}
 \centering
  \begin{tabular}{lccccccc}
   \hline
&    $\tau_{\rm ex}$ & $a_{\rm ex}$ & $\alpha_{\rm ex}$ & $\beta_{\rm ex}$ & $\tau_{\rm st}$ & $k_{\rm st}$\\
   \hline \hline
  例1 \cite[Table D.3. Unit F2]{anderson2008power}& 0.50 & $-0.045$ & 0.0012 & 1.21 & 1.00 & 0.08\\
   例2 \cite[Table 7.3]{sauer2017power}& 0.314 & $1.0$ & 0.0039 & 1.555 & 0.35 & 0.063 \\
%  例2 \cite[8.6.3節]{kundur1994power}& 1.15 & $-0.30$ & 0.014 & 1.55 & 0.62 & 0.058 \\
   \hline 
  \end{tabular}
\end{table}


%\begin{table}[h]
%\medskip
% \caption{計器用変圧器と増幅器のパラメータ範囲（参考値）}
% \label{table:AVRpara1}
% \centering
%  \begin{tabular}{|c|c|c|c|c|c|}
%   \hline
%   $\tau_{\rm tr}$ & $\tau_{\rm ap}$ & $k_{\rm ap}$ & $V_{\rm ap}^{\rm max}$ & $V_{\rm ap}^{\rm min}$ \\
%   \hline \hline
%   0 -- 0.06 & 0.02 -- 0.25 & 25 -- 400 & 1.0 -- 8.2 & $V_{\rm ap}^{\rm max} \times (-1)$\\
%   \hline
%  \end{tabular}
%\end{table}
%
%\begin{table}[h]
%\medskip
% \caption{励磁器と安定化回路のパラメータ範囲（参考値）}
% \label{table:AVRpara2}
% \centering
%  \begin{tabular}{|c|c|c|c|c|c|}
%   \hline
%    $\tau_{\rm ex}$ & $a_{\rm ex}$ & $\alpha_{\rm ex}$ & $\beta_{\rm ex}$ & $\tau_{\rm st}$ & $k_{\rm st}$\\
%   \hline \hline
%   0.5 -- 1.3 & $-0.17$ -- $-0.05$ & 0.0016 -- 0.011 & 0.79 -- 1.56 & 0.35 -- 1.0 & 0.01 -- 0.08\\
%   \hline
%  \end{tabular}
%\end{table}

\begin{figure}[t]
\centering
\includegraphics[width = .85\linewidth]{figs/avrst1}
\medskip
\caption{\textbf{IEEE ST1 type model of automatic voltage regulator}}
\label{fig:avrst1}
\medskip
\end{figure}

Next, let us talk about the \textbf{IEEE Type ST1 excitation system model}, which is a static model with a faster response, although its structure is the same as the IEEE Type DC1 excitation system model.
With this AVR model, the exciter model of Equation \ref{eq:extmod} is expressed as a static relationship with a sufficiently small time constant for the exciter:
\[
V_{\rm field} = \sfsat \bigl( V_{\rm ap};V_{\rm field}^{\rm min},V_{\rm field}^{\rm max} \bigr)
\]
%\[
%V_{\rm field} = 
%\left\{
%\begin{array}{cl}
%V_{\rm field}^{\rm min}, & V_{\rm ap} \leq V_{\rm field}^{\rm min} \\
%V_{\rm ap}, & V_{\rm field}^{\rm min} < V_{\rm ap} \leq V_{\rm field}^{\rm max} \\
%V_{\rm field}^{\rm max}, & V_{\rm ap} > V_{\rm field}^{\rm max}
%\end{array}
%\right.
%\]
$\sfsat$ is a saturation constant of output and is defined by:
\[
\sfsat(x;\underline{\alpha},\overline{\alpha}) := \left\{
\begin{array}{cl}
\underline{\alpha}, & x \leq \underline{\alpha} \\
x, & \underline{\alpha} < x \leq \overline{\alpha} \\
\overline{\alpha}, & x> \overline{\alpha}
\end{array}
\right.
\]
The upper and lower limits of the output saturation are modelled to be dependent on the absolute value of the bus bar voltage phasor \cite[Section 8.3]{kundur1994power}.
Specifically, this is expressed as:
\[
V_{\rm field}^{\rm min} = \gamma_{-} |\bm{V}|, \qquad
V_{\rm field}^{\rm max} = \gamma_{+} |\bm{V}|
-
k_0 \Ifd
\]
using $\Ifd$ of Equation \ref{eq:gendifavr} in addition to $|\bm{V}|$, where $\gamma_{-}$，$\gamma_{+}$，$k_{0}$ is a non-negative constant.
\FIGref{fig:avrst1} shows the block diagram of this model.
Since $|\bm{V}|$ becomes 0 during the ground fault of bus bars, field voltage $V_{\rm field}$ is not output because of AVR.

Since the response speed of the exciter is sufficiently fast in the IEEE Type ST1 Excitation System Model, the stabilizing circuit is often unnecessary.
When time constant $\tau_{\rm ap}$ of the amplifier is sufficiently small, and its dynamic characteristic can be ignored: 
\begin{align}\label{eq:avrst1}
\simode{
\tau_{\rm tr} \dot{V}_{\rm tr} & = - V_{\rm tr} +  |\bm{V}|  \\
V_{\rm ap} &= k_{\rm ap} ( V_{\rm ref}^{\star} + V_{\rm pss}- V_{\rm tr} )\\
V_{\rm field} & = \sfsat \left(
V_{\rm ap};
V_{\rm field}^{\rm min},V_{\rm field}^{\rm max} 
\right)
}
\end{align}
is used as the simplified first-order model.
For example, this model is used in \cite[Section 12.4]{kundur1994power} and \cite[Section 4.2.2]{pal2006robust}.
Parameter examples are shown in the Examples 1 and 2 in \ref{table:AVRparast1}.

\begin{table}[h]
\medskip
 \caption{\textbf{IEEE ST1 type model parameter example}}
 \label{table:AVRparast1}
 \centering
  \begin{tabular}{lccccccccc}
   \hline
 &  $\tau_{\rm tr}$ & $\tau_{\rm ap}$ & $k_{\rm ap}$ & $\gamma_{+}$ & $\gamma_{-}$ & $k_{0}$ & $\tau_{\rm st}$ & $k_{\rm st}$\\
   \hline \hline
   Example 1 \cite[Section 8.6.3]{kundur1994power}& 0.015 & 0 & 200 & 7.00 & $-6.40$ & 0.04 & 0 & 0\\
   Example 2 \cite[Table H.23]{ieee2016ieee}& 0.02 & 0 & 210 & 6.43 & $-6.00$ & 0.038 & 0 & 0 \\
   Example 3 \cite[Section V]{chow2004power}& 0 & 0.076 & 36.66 & $\infty$ & $-\infty$ & 0 & 0 & 0 \\
   Example 4 \cite[Table 4]{sadamoto2019dynamic}& 0 & 0.05 & 20 & $\infty$ & $-\infty$ & 0 & 0 & 0 \\
   \hline
  \end{tabular}
\end{table}

Though the time constant $\tau_{\rm ap}$ of the amplifier is not 0, models with the time constant $\tau_{\rm tr}$ of the voltage transformer being 0 and models without output saturation are sometimes used.
In such a case, it can be expressed as:
\begin{align}\label{eq:avrst1s}
\simode{
\tau_{\rm ap} \dot{V}_{\rm ap}&=
- V_{\rm ap} + k_{\rm ap} (V_{\rm ref}^{\star} + V_{\rm pss}- |\bm{V}|)\\
{V}_{\rm field}&=V_{\rm ap}
}
\end{align}
Parameter examples of this model are shown in Examples 3 and 4 in \ref{table:AVRparast1}.

The value of the reference signal $V_{{\rm ref}}^{\star}$ in Equations \ref{eq:avrst1} and \ref{eq:avrst1s} is determined as:
\begin{align}\label{eq:avrref}
V_{{\rm ref}}^{\star} = \frac{V_{{\rm field}}^{\star}}{k_{{\rm ap}}}+|\bm{V}^{\star}|
\end{align}
when the steady value $V_{{\rm field}}^{\star}$ of the desired field voltage and the steady value $|\bm{V}^{\star}|$ of the absolute value for the bus bar voltage are given, in a real system operation, the steady values of the bus bar voltage and field voltage are unknown values that change by load distribution and so on;
thus, the value of the reference signal $V_{{\rm ref}}^{\star}$ is specified by using the value of the standard bus bar voltage and field voltage.

\subsection{Control effect of AVR}

Let us analyze the control effect of AVR using a simple electrical power system model.

\begin{例}[自動電圧調整器による定態安定性と過渡安定度の変化]\label{ex:avreffect}
Let us consider an electrical power system model consisting of three bus bars discussed in the Examples \ref{ex:derY}, \ref{ex:pf3bus} and \ref{ex:inires}.
The physical constants of generators and transmission lines are set to the same value as the Example \ref{ex:inires}.
In addition, loads connected to bus bar 2 are set to the constant impedance model, and the values from the first row of \ref{table:loadpara1} are used as impedance.
AVR is set to the IEEE Type ST1 Excitation System Model of Equation \ref{eq:avrst1}. AVR incorporated into generator 1 and generator 3 is the same, and values from Example 1 in \ref{table:AVRparast1} are used as parameters.

First, let us confirm the change in the set of the steady power flow distribution (stable equilibrium point) that is statically stable against AVR.
Specifically, the steady value of the interval voltage of generators, $E_1^{\star}$ and $E_3^{\star}$, are fixed to the values in the rightmost column of \ref{table:genst13a}, and the difference of the steady value of the rotor argument, $\delta_3^{\star}-\delta_1^{\star}$, is changed as a parameter.
In this manner, the small signal stability of the steady power flow distribution in a corresponding electrical power system is determined based on approximate linearization.

Without losing generality, $\delta_1^{\star}$ or $\delta_3^{\star}$ can be set to 0.
If the steady value of the internal state of each generator is determined, the steady value of the corresponding mechanical torque and field voltage can be determined by:
\begin{align*}
\simode{
P_{{\rm mech}i}^{\star} &= %\textstyle
  f_i \left( \delta^{\star},E^{\star} \right)
\\
V_{{\rm field}i}^{\star} & = %\textstyle
   \tfrac{ \Xsi }{\Xti }  E_i^{\star}  - \left(
\Xsi - \Xti
\right)
g_i \left( \delta^{\star},E^{\star} \right)
}
\qquad
 i \in \{1,3\}
\end{align*}
$\delta^{\star}$ and $E^{\star}$ are vectors with $\delta_i^{\star}$ and $E_i^{\star}$, and functions $f_i$ and $g_i$ are defined by Equation \ref{eq:figidef}.
Furthermore, the steady value of the generator bus voltage phasor can be obtained as:
\begin{align*}
\mat{
\bm{V}_1^{\star}\\
\bm{V}_3^{\star}
} =
\left(
\mat{
\tfrac{1}{\bm{j} \Xt_1 } & 0\\
0 & \tfrac{1}{\bm{j} \Xt_3 }
} + 
\bm{Y}_{\rm Kron}
\right)^{-1}
\mat{
\tfrac{e^{\bm{j} \delta_1^{\star}}}{\bm{j} \Xt_1 } & 0 \\
0 & \tfrac{e^{\bm{j} \delta_3^{\star}}}{\bm{j} \Xt_3 }
}
\mat{
E_1^{\star}  \\
E_3^{\star} 
}
\end{align*}
by using Equation \ref{eq:colVi}.
$\bm{Y}_{\rm Kron}$ is the admittance matrix where the load bus bar defined by \ref{eq:Kron} is Kron reduced.
The value of the reference signal $V_{{\rm ref}i}^{\star}$ is determined by Equation \ref{eq:avrref}.

\begin{table}[h]
\medskip
 \caption{\textbf{Steady value of rotor declination that stabilizes the state} 
 \\ \centering(AVR: automatic voltage regulator, PSS: system stabilizer)}
 \label{table:stableeqs}
 \centering
  \begin{tabular}{ccccccccccc}
   \hline
 & (i) Without AVR & (ii) With AVR & (iii) With AVR and PSS \\
   \hline \hline
 $\delta_3^{\star}-\delta_1^{\star}$ Upper limit~[rad]  & $1.03$ & $0.87$ & $1.32$ \\
 $\delta_3^{\star}-\delta_1^{\star}$ Lower limit~[rad] & $-0.90$ & $-0.30$ & $-1.10$  \\
   \hline
  \end{tabular}
\end{table}

\begin{COLUMN}
\noindent \textbf{$\mathcal{L}_2$ norm}：
$\mathcal{L}_2$ norm of function $y:[0,\infty) \rightarrow \mathbb{R}^n$ is
expressed as:
\[
\|y\|_{\mathcal{L}_2} := \sqrt{
\int^{\infty}_{0}
\| y(\tau)\|^2  d \tau
}
\]
と定義される。
この値は，時変な信号のエネルギーを表すものとして解釈できる。
一般に，時刻の経過にしたがって振幅が減衰する信号でない限り，$\mathcal{L}_2$ノルムの値は無限大となる。
なお，``$\mathcal{L}$"の文字は，ルベーグ積分の理論で知られるアンリ・ルベーグ（Henri Lebesgue）の名前に由来する。
\end{COLUMN}

Next, let us confirm an increase in the transient stability by AVR.
Specifically, we perform the following analysis.
First, as a statically stable steady power flow distribution regardless of AVR, we consider where the steady value of the rotor argument difference $\delta_3^{\star}-\delta_1^{\star}$ is $-\tfrac{\pi}{6}$~[rad].
However, the steady value of internal voltage is set to the above value.
Next, the initial value of the electrical power system is changed as a parameter, and $\|\Delta\omega\|_{\mathcal{L}_2}$ is calculated for the obtained time response of the frequency deviation.
$\Delta \omega$ is a vector with $\Delta \omega_1$ and $\Delta \omega_3$.
Similarly, $\||\bm{V}|-|\bm{V}^{\star}| \|_{\mathcal{L}_2}$ is calculated for the time response of the bus bar voltage phasor.
$|\bm{V}|$ is a vector with $|\bm{V}_1|$ and $|\bm{V}_3|$, while $|\bm{V}^{\star}|$ is a vector with $|\bm{V}_1^{\star}|$ and $|\bm{V}_3^{\star}|$.


\FIGref{fig:transientL2} shows the result of the transient stability analysis.
The horizontal axis shows the initial value of the set $\delta_3-\delta_1$, while the vertical axis shows values of $\mathcal{L}_2$ norms for frequency deviation and bus bar voltage phasor deviation generated to the set initial value.
The solid blue line shows a case corresponding to \ref{table:stableeqs}(i) without AVR, and the broken black line shows the case corresponding to (ii) with AVR.
These are plotted in the range of initial values where values of $\mathcal{L}_2$ are finite.
The initial values of the internal voltage $E_1$，$E_3$ are set to the same values as their steady values $E_1^{\star}$，$E_3^{\star}$.
The initial values of frequency deviations $\Delta \omega_1$ and $\Delta \omega_3$ are both set to 0.
From this result, we can see that the transient stability of the frequency deviation and bus bar voltage phasor is improved by AVR.
We can also see that the stable range is somewhat narrowed by AVR.

As a reference, \FIGref{fig:avrsmalld} and \FIGref{fig:avrlarged} show the time response of frequency deviations when the initial value of $\delta_3-\delta_1$ is set to $-1$ and $-\tfrac{\pi}{2}$: (a) is without AVR and (b) is with AVR.
The result shows that by incorporating AVR, the low frequency component of frequency deviation oscillation (central value of oscillation) tends to converge to 0 faster.
On the other hand, regardless of AVR, the attenuation rate of the high frequency component of oscillation does not change notably.
\end{例}



%\begin{figure}[t]
%\centering
%\includegraphics[width = .65\linewidth]{figs/transientL2}
%\medskip
%\caption{\textbf{ 自動電圧調整器による過渡安定度の変化} }
%\label{fig:transientL2}
%\medskip
%\end{figure}

\begin{figure}[t]
  \centering
  {
  \begin{minipage}{0.49\linewidth}
    \centering
    \includegraphics[width = 1.0\linewidth]{figs/transientL2w}
    \subcaption{ $\|\Delta\omega\|_{\mathcal{L}_2}$ }
  \end{minipage}
  \begin{minipage}{0.49\linewidth}
    \centering
    \includegraphics[width = 1.0\linewidth]{figs/transientL2V}
    \subcaption{ $\bigl\||\bm{V}|-|\bm{V}^{\star}| \bigr\|_{\mathcal{L}_2}$}
  \end{minipage}
  \medskip
  \caption{\textbf{Transient stability evaluation for the initial value of the rotor declination difference} 
  \\ \centering(Blue solid line: (i), Black dashed line: (ii), Red chain line: (iii))}
  \label{fig:transientL2}
  }
\medskip
\end{figure}



\begin{figure}[t]
  \centering
  {
  \begin{minipage}{0.49\linewidth}
    \centering
    \includegraphics[width = 1.0\linewidth]{figs/woAVRsmall}
    \subcaption{Without AVR}
  \end{minipage}
  \begin{minipage}{0.49\linewidth}
    \centering
    \includegraphics[width = 1.0\linewidth]{figs/wAVRsmall}
    \subcaption{With AVR}
  \end{minipage}
  \medskip
  \caption{\textbf{Initial value response of angular frequency deviation}
  \\ \centering{(Blue solid line: $\Delta\omega_1$, red dashed line: $\Delta\omega_3$)}
  }
  \label{fig:avrsmalld}
  }
\medskip
\end{figure}

\begin{figure}[t]
  \centering
  {
  \begin{minipage}{0.49\linewidth}
    \centering
    \includegraphics[width = 1.0\linewidth]{figs/woAVRlarge}
    \subcaption{Without AVR}
  \end{minipage}
  \begin{minipage}{0.49\linewidth}
    \centering
    \includegraphics[width = 1.0\linewidth]{figs/wAVRlarge}
    \subcaption{With AVR}
  \end{minipage}
  \medskip
  \caption{\textbf{Initial value response of angular frequency deviation}
  \\ \centering{(Blue solid line: $\Delta\omega_1$, Red dashed line: $\Delta\omega_3$)} 
}
  \label{fig:avrlarged}
  }
\medskip
\end{figure}

The Example \ref{ex:avreffect} shows that while part of the equilibrium point that was stable before becomes unstable by incorporating AVR, the low frequency component of the frequency deviation oscillation is suppressed.
In this sense, the transient stability of the electrical power system improves.
PSS, as explained in the next Section, has a suppressing effect on the high frequency component of oscillation which could not be controlled by AVR.

\subsection{PSS}\label{sec:pssintro}

PSS is a piece of equipment that outputs additional control signal $V_{\rm pss}$ shown in \FIGref{fig:avrdc1} and \FIGref{fig:avrst1}.
Generally, the frequency deviation, active power, and bus bar voltage phasor are calculated for generators to feedback to PSS.
Below, we explain a typical PSS model called the \textbf{IEEE Type PSS1 power system stabilizer model} \cite[Section 9.2]{ieee2016ieee}.
This model mainly consists of a \textbf{washout filter} and \textbf{phase-lead compensator}.
\FIGref{fig:pss1} shows the block diagram. 

\begin{figure}[t]
\centering
\includegraphics[width = .99\linewidth]{figs/pss1}
\medskip
\caption{\textbf{IEEE PSS1 type model of system stabilizer}}
\label{fig:pss1}
\medskip
\end{figure}


\smallskip
\subsubsection{Washout filter}


It is a high-pass filter to make the steady gain of PSS 0, and its dynamic characteristic is expressed as the following with the frequency deviation $\Delta \omega$ of a generator that has been constant factored by gain $k_{\rm pss}$ as the input: 
\begin{subequations}\label{eq:pss1mod}
\begin{align}\label{eq:washmod}
\simode{
\tau_{\rm ws} \dot{\xi}_{\rm ws} &=
- \xi_{\rm ws}
+ k_{\rm pss} \Delta \omega \\
v_{\rm ws} &= k_{\rm pss} \Delta \omega - \xi_{\rm ws}
}
\end{align}
Clearly, if $\Delta \omega$ is a constant, the output of washout filter $v_{\rm ws}^{\star}$ under a steady state becomes 0.
The role of this filter is to identify the frequency deviation of the electrical power system under a transient state.
Therefore, the time constant $\tau_{\rm ws}$ is often set in a range of 1 to 20 [s] considering the settling time for frequency deviation.


\smallskip
\subsubsection{Phase-lead compensator}
This is a compensator incorporated to alleviate a phase lag from the bus bar voltage phasor to the active power of generators.
To achieve the desired phase lead, one to two phase-lead compensators are often connected in a series.
Specifically, with the washout filter output $v_{\rm ws}$ as the input, its dynamic characteristic is expressed by:

\begin{align}\label{eq:phldmod}
\simode{
\tau_{{\rm d}1} \dot{\xi}_{1} &=
- \xi_{1}
+ \left( 
1- \tfrac{\tau_{{\rm d}1}}{\tau_{{\rm n}1}}
\right)
v_{\rm ws} \\
v_{1} &= \tfrac{\tau_{{\rm n}1}}{\tau_{{\rm d}1}} (v_{\rm ws} - \xi_{1} )
}
\qquad
\simode{
\tau_{{\rm d}2} \dot{\xi}_{2} &=
- \xi_{2}
+ \left( 
1- \tfrac{\tau_{{\rm d}2}}{\tau_{{\rm n}2}}
\right)
v_{1} \\
v_{\rm pl} &= \tfrac{\tau_{{\rm n}2}}{\tau_{{\rm d}2}} (v_{1} - \xi_{2} )
}
\end{align}
%ただし，時定数は$\tau_{{\rm d}1} \leq \tau_{{\rm n}1}$，$\tau_{{\rm d}2} \leq \tau_{{\rm n}2}$となるように設定される。
Finally, the phase-lead compensator output $v_{\rm pl}$ is applied to a saturation function:
\begin{align}\label{eq:psssat}
V_{\rm pss} = \sfsat \left(
v_{\rm pl};
V_{\rm pss}^{\rm min},V_{\rm pss}^{\rm max} 
\right)
\end{align}
\end{subequations}
to obtain the PSS output.
\ref{table:psspara} shows parameter examples of this model.
However, PSS parameters must be determined by considering various elements, such as the dynamic characteristic of each generator, the dynamic characteristic of AVR, load distribution, and power grid properties.
Thus, depending on the illustrated parameter setting, the desired system stability might not be achieved.
In addition, the standard parameter design guidelines of PSS are often based on the single machine infinite bus system model explained in Section \ref{sec:onemachine}.
Thus, one must be aware that the result may be unclear when multiple generators are connected.
For example, in the literature \cite[Section 12.5]{kundur1994power}, parameter design guidelines based on the classic control theory are shown using the single machine infinite bus system model.
In the literature \cite{chow2004power}, design guidelines based on modern control theory are explained.

\begin{table}[h]
\medskip
 \caption{\textbf{IEEE PSS1 type model parameter example}}
 \label{table:psspara}
 \centering
  \begin{tabular}{lccccccccccccc}
   \hline
 &  $k_{\rm pss}$ & $\tau_{\rm ws}$ & $\tau_{{\rm d}1}$ & $\tau_{{\rm n}1}$ & $\tau_{{\rm d}2}$ & $\tau_{{\rm n}2}$ & $V_{\rm pss}^{\rm min}$ & $V_{\rm pss}^{\rm min}$ \\
   \hline \hline
   例1 \cite[12.5節]{kundur1994power}& 9.50 & 1.4 & 0.033 & 0.154 & 0.00 & 0.00 & $-\infty$ & $\infty$ \\
   例2 \cite[12.8節]{kundur1994power}& 20.0 & 10.0 & 0.02 & 0.05 & 5.40 & 3.00 & $-\infty$ & $\infty$ \\
   例3 \cite[III節]{chow2004power}& 1.57 & 10.0 & 0.03 & 0.34 & 0.03 & 0.34 & $-\infty$ & $\infty$ \\
   例4 \cite[Table H.3]{ieee2016ieee}& 3.15 & 10.0 & 0.01 & 0.76 & 0.01 & 0.76 & $-0.09$ & 0.09\\
   \hline
  \end{tabular}
\end{table}

\subsection{Control effect of PSS}\label{sec:pssov}

Let us analyze the control effect of PSS using a simple electrical power system model.

\begin{例}[Changes in the small signal stability and the transient stability by PSS]\label{ex:psseffect}
With the same setting as the Example \ref{ex:avreffect}, let us think about incorporating PSS with AVR.
The PSS incorporated into generator 1 and generator 3 is the same, and the parameters are values from Example 2 of \ref{table:psspara}.
First, if we confirm the change in the set of stable equilibrium points regardless of PSS, they are in the range of \ref{table:stableeqs}(iii).
This result shows that by incorporating PSS, the stable equilibrium point set is expanded.

Next, the analytical result of the transient stability is shown.
With the same setting as the Example \ref{ex:avreffect}, the result with PSS is shown in \FIGref{fig:transientL2} with the red line with two dashes.
This result shows that the transient stability of the frequency deviation and bus bar voltage phasor has further increased.
On the other hand, we can see that the size of the stable range has not changed notably by PSS.
As a reference, \FIGref{fig:PSSomega} (a) and (b) show the time response of the frequency deviation when the initial value of $\delta_1-\delta_3$ is set to $-1$ and $-1.
7$, respectively.
The convergence rate of frequency deviation has increased with PSS.
\end{例}

\begin{figure}[t]
  \centering
  {
  \begin{minipage}{0.49\linewidth}
    \centering
    \includegraphics[width = 1.0\linewidth]{figs/wPSSsmall}
    \subcaption{ $\delta_1(0) - \delta_3(0) =-1$}
  \end{minipage}
  \begin{minipage}{0.49\linewidth}
    \centering
    \includegraphics[width = 1.0\linewidth]{figs/wPSSlarge}
    \subcaption{ $\delta_1(0) - \delta_3(0) =-1.57$}
  \end{minipage}
  \medskip
  \caption{\textbf{Initial value response of angular frequency deviation}
  \\ \centering(There is a system stabilizer, and the line type is the same as \ref{fig: avrsmalld})}
  \label{fig:PSSomega}
  }
\medskip
\end{figure}

\section{PSS based on the retrofit control theory\advanced}\label{sec:retrofit}

\subsection{The electrical power system model used to design PSS\advanced}

\smallskip
\subsubsection{Characteristics of PSS based on the retrofit control theory}

In this Section, we explain the design method of PSS based on the retrofit control theory \cite{ishizaki2018retrofit,sadamoto2018retrofit,sasahara2019damping,ishizaki2019retrofit,ishizaki2021modularity}.
PSS designed with this method is able to stably maintain the steady power flow distribution of interest even when multiple generators are incorporated in parallel.
Specifically, each PSS is characterized as follows:
\begin{itemize}
\item Distributed design is possible with just a mathematical model of generators and AVR that incorporates it.
\item Distributed implementation is possible with just the local measurement signal of the voltage phasor and current phasor of generator buses.
\end{itemize}
Below, let us consider a situation where the IEEE ST1 Type AVR model of Equation \ref{eq:avrst1} is incorporated into the generator model of Equation \ref{eq:gendifavr}.
However, for a simpler explanation, we exclude the saturation of AVR.
If not only the cases with saturation but also other forms of AVR are incorporated, an existing PSS is incorporated, or more detailed generator models are used, the same discussion applies.

\smallskip
\subsubsection{Localized linear subsystem}

Let us consider expressing a localized subsystem with AVR connected to generators of interest as a linear system by improving the setting of interaction input:
\begin{align}\label{eq:desmodl}
G:\simode{
\dot{x} &= Ax + Bu + Lv \\
w &= \mathit{\Gamma} x \\
y &= Cx
}
\end{align}
where state $x$ is a vector with the state of the generator model $\delta$, $\Delta \omega$，$E$, and the state of the AVR model $V_{\rm tr}$ in that order.
Input $u$ expresses the output of PSS $V_{\rm pss}$, and input and output of interaction, $v$ and $w$, are defined as follows:
\begin{align}\label{eq:sigintvw}
v:=
\mat{
P_{\rm mech} - \tfrac{E |\bm{V} |}{ \Xt } \sfsin(\delta -  \angle \bm{V}) \\
k_{\rm ap} V_{\rm ref}^{\star} + 
\left(
\tfrac{ \Xs }{ \Xt }-1
\right)
|\bm{V}| \sfcos (\delta - \angle \bm{V} )\\
|\bm{V}|
}
,\qquad
w:=\mat{
\delta \\
\Delta \omega \\
E 
}
\end{align}
Please note that the interaction input $v$ of Equation \ref{eq:sigintvw} includes the nonlinear term of generators and variables of the bus bar voltage phasor.
With the definition of these signals, the system matrix of Equation \ref{eq:desmodl} is defined as:
\begin{align}\label{eq:matlocalm}
\spliteq{
A&:=\mat{
0 & \omega_0 & 0 & 0 \\
0 & -\tfrac{D}{M} & 0 & 0 \\
0 & 0 & -\tfrac{ \Xs }{ \taud \Xt } & -\tfrac{k_{\rm ap}}{ \taud } \\
0 & 0 & 0 & -\tfrac{1}{\tau_{\rm tr}}
}, \quad
B:=
\mat{
0 \\
0 \\
\tfrac{k_{\rm ap}}{ \taud } \\
0 
},\quad
C:= I \\
L &:=
\mat{
0 & 0 & 0 \\
\tfrac{1}{M} & 0 & 0 \\
0 & \tfrac{1}{ \taud } & 0 \\
0 & 0 & \tfrac{1}{\tau_{\rm tr} }
}, \quad
\mathit{\Gamma} :=
\mat{
1 & 0 & 0 & 0 \\
0 & 1 & 0 & 0 \\
0 & 0 & 1 & 0 
}
}
\end{align}
$G$ of Equation \ref{eq:desmodl} is called a \textbf{local linear subsystem}.
It is assumed that the parameters of the system matrix of Equation \ref{eq:matlocalm}, in other words, the model parameters of the local linear subsystem, are known and can be used to design and implement PSS.


\smallskip
\subsubsection{Environment and the approximate linear environment model}

Under the assumption that the output $y$ and input and output of interaction, $v$ and $w$, can be calculated, let us design a local controller that expresses PSS:
\[
K : (y,v,w)\mapsto u
\]
%ただし，式\ref{eq:desmodl}の局所線形サブシステム$G$では，出力$w$は出力$y$に包含されることに注意されたい。
Hereafter, we call this controller $K$ as a \textbf{retrofit controller}.
The word retrofit was derived from retroactive and refit, meaning performing partial expansions and renovations to an existing system.

For design and implementation of the retrofit controller, not only the model of the local linear subsystem $G$, but also a linear model that plays a role in the internal estimate of interaction input $v$ based on the information of interaction output $w$ is used.
Below, we called this estimate model the \textbf{approximate linear environment model}.

\begin{figure}[t]
\centering
\includegraphics[width = .99\linewidth]{figs/retconsys2}
\medskip
\caption{\textbf{Coupling system of local linear subsystem and environment}}
\label{fig:retconsys}
\medskip
\end{figure}


In preparation for explaining the approximate linear environment model, we introduce a nonlinear subsystem called the \textbf{environment}.
The environment is a global subsystem that expresses “the entire system excluding the local linear subsystem”, which is a nonlinear system that uses the interaction output of the local linear subsystem $w$ as the input, and interaction input $v$ as the output.
Formally, we will present the dynamic relationship of the environment input and output as:
\[
\overline{G} : w\mapsto v
\]
Here, the feedback connection system of the local linear subsystem $G$ and the environment $\overline{G}$ expresses “the entire electrical power system from a viewpoint of the generators of interest” (\FIGref{fig:retconsys}).

Since the environment $\overline{G}$ includes multiple elements, such as power grids, loads, and other generators, it is not realistic to assume that the perfect nonlinear model of environment could be used to design and implement PSS for generators of interest.
Considering this fact, let us imagine a situation where “only the approximate linear environment model” is usable.
Before, for simplification, we consider expressing the approximate linear environment model with a static input-output relationship.
A dynamic approximate linear environment model can be used as well.
Please see \cite{ishizaki2019retrofit} for further details.

Specifically, when expressing the steady value of the interaction input-output under a steady power flow distribution of interest as $(v^{\star},w^{\star})$, the approximate linear environment model is parameterized as:
\begin{align}\label{eq:Gbapxst}
\overline{G}_{\rm apx}:
v_{\rm apx} = v^{\star} + \overline{\mathit{\Theta}} \left(w-w^{\star}\right)
%+ \overline{v}
\end{align}
Here, $\overline{\mathit{\Theta}}$ is a matrix that expresses the model parameters.
The approximate linear environment model $\overline{G}_{\rm apx}$ of Equation \ref{eq:Gbapxst} generates the value $v_{\rm apx}$ that estimates the steady values $(v^{\star},w^{\star})$ of impact of the interaction output $w$ on the interaction input $v$ by approximate linear prediction.
The electrical power system model used to design the retrofit controller is created through feedback connection of the parameters of this approximate linear environmental model $\overline{\mathit{\Theta}}$ and the model of the local linear subsystem $G$ (\FIGref{fig:explocalG}).
Specifically:
\begin{align}\label{eq:Gplus}
G^+: \simode{
\dot{\hat{\xi}} &=  \left( A+L \overline{\mathit{\Theta}} 
\mathit{\Gamma} \right) \hat{\xi} + B \hat{u} \\
\hat{y} & = C \hat{\xi}
}
\end{align}
%ただし，システム行列は
%\[
%A_+ :=
%A+L \overline{\mathit{\Theta}} 
%\mathit{\Gamma}
%,\qquad
%B_+ := B
%,\qquad
%C_+ := C
%\]
%である。
However, since $\hat{u}$ and $\hat{y}$ are virtual input and output signals to design the controller, we differentiated them from $u$ and $y$ with \^{ }.
Since $C$ is an identity matrix in Equation \ref{eq:matlocalm}, output $\hat{y}$ is equal to the internal state $\hat{\xi}$ of $G^+$.

\begin{figure}[t]
\centering
\includegraphics[width = .50\linewidth]{figs/explocalG2}
\medskip
\caption{\textbf{Model used for controller design}}
\label{fig:explocalG}
\medskip
\end{figure}

\subsection{PSS design based on the retrofit control theory\advanced}\label{sec:designret}

\smallskip
\subsubsection{Retrofit controller design method}

In this part, we assume that the approximate linear environment parameters $\overline{\mathit{\Theta}}$ of Equation \ref{eq:Gbapxst} are determined with an appropriate method and explain the design method for the retrofit controller.
The specific steps to create the approximate linear environment model are explained in the next part.

To design a retrofit controller that corresponds to PSS, the standard control system design method in control systems engineering can be used.
For example, let us apply the design method \cite[Section 5.3]{fairman1998linear} of \textbf{ linear-quadratic regulator (LQR)} to the controller design model $G^+$ of Equation \ref{eq:Gplus}.
With LQR, as a state feedback-style control algorithm to minimize the cost function related to the state and input:
\[
J(\hat{\xi},\hat{u}) :=\int_0^{\infty} \left(
\hat{\xi}^{\sf T}(t) Q \hat{\xi}(t)
+
\hat{u}^{\sf T}(t) R \hat{u}(t)
\right) dt
\]
we use the following:
\begin{align}\label{eq:locKhat}
\hat{u}=\underbrace{-R^{-1}B^{\sf T}P(\overline{\mathit{\Theta}}) }_{\hat{K}(\overline{\mathit{\Theta}}) }
\hat{\xi}
\end{align}
where, $Q$ is a positive semi-definite vector and $R$ is a positive definite vector.
The matrix $P(\overline{\mathit{\Theta}})$ is a positive definite solution that satisfies the \textbf{algebraic Riccati equation}.
\[
\left( A+L \overline{\mathit{\Theta}} 
\mathit{\Gamma} \right)^{\sf T} P +
P \left( A+L \overline{\mathit{\Theta}} 
\mathit{\Gamma} \right)
-PB R^{-1} B^{\sf T} P +Q = 0
\]
At this time, using the gain matrix $\hat{K}(\overline{\mathit{\Theta}})$ of Equation \ref{eq:locKhat}, the retrofit controller is built as follows:
\begin{align}\label{eq:retroK}
K: \simode{
\dot{\hat{x}} &=  A \hat{x} + L \left\{
v - \overline{\mathit{\Theta}} (w- \mathit{\Gamma} \hat{x}) 
\right\}\\
u &= \hat{K}(\overline{\mathit{\Theta}}) (y - C\hat{x})
}
\end{align}
PSS based on this retrofit control theory has the following characteristics with any matrix $\overline{\mathit{\Theta}}$ used:
\begin{itemize}
\item If the electrical power system is in a steady power flow distribution, input $u$ becomes 0.
\item Before and after implementation, the stability of the steady power flow distribution (equilibrium point) does not change.
\end{itemize}
The first item means that the retrofit controller does not change the steady state.
The second term means that the equilibrium point that was asymptotically stable before the implementation of the local controller does not change to an unstable equilibrium point because of the local controller.
With the retrofit control theory, it aims to “improve the stability” with robustness against disturbances and the size of the stable range as indicators while maintaining the asymptotic stability of the equilibrium point.
With this method, asymptotic stabilization of unstable equilibrium points is not possible.

Generally, as the prediction accuracy of interaction signals by the approximate linear environment model improves, the system stability improves greatly.
The control algorithm of Equation \ref{eq:locKhat} can be designed with other control system design methods as long as $G^+$ of Equation \ref{eq:Gplus} is stabilized.
$\hat{K}(\overline{\mathit{\Theta}})$ does not have to be static and can be used as a dynamic control algorithm \cite{ishizaki2019retrofit}.

\smallskip
\subsubsection{Method to build the approximate linear environment model}

One of the practical approaches to identify parameters $\overline{\mathit{\Theta}}$ of Equation \ref{eq:Gbapxst} is a method to estimate the relationship between signals $w$ and $v$ of Equation \ref{eq:sigintvw} with approximate linearization.
Specifically, partial differential of $v$ related to each element of $w$ is calculated as follows:
\begin{align}
\spliteq{
\frac{\partial v }{\partial \delta} &= 
\mat{
- \tfrac{E |\bm{V} |}{ \Xt } \sfcos(\delta -  \angle \bm{V})  \\
- \left( \tfrac{\Xs }{ \Xt }-1 \right)
|\bm{V}| \sfsin (\delta - \angle \bm{V} ) \\
0
}
, \qquad
\frac{\partial v }{\partial \Delta \omega} = \mat{0 \\0\\0} \\
\frac{\partial v }{\partial E} &= 
\mat{
- \tfrac{|\bm{V} |}{ \Xt } \sfsin(\delta -  \angle \bm{V}) \\
0\\
0
}
}
\end{align}
Therefore, if we assume that the internal state of the generators of interest and the voltage phasor of the generator buses are near steady power flow distribution, the following is obtained:
\begin{align}\label{eq:basenvm}
\overline{\mathit{\Theta}}^{\rm int} :=
\mat{
- \tfrac{E^{\star} |\bm{V}^{\star} |}{ \Xt } \sfcos(\delta^{\star} -  \angle \bm{V}^{\star}) &
0   & 
- \tfrac{|\bm{V}^{\star} |}{ \Xt } \sfsin(\delta^{\star} -  \angle \bm{V}^{\star})
\\
- \left( \tfrac{ \Xs }{ \Xt }-1 \right) 
|\bm{V}^{\star}| \sfsin (\delta^{\star} - \angle \bm{V}^{\star} ) 
& 0 
& 0 
\\
0 & 0 &0
}
\end{align}
where the steady value $(\delta^{\star},E^{\star})$ of the internal state of the generators and the steady value $(|\bm{V}^{\star}|,\angle \bm{V}^{\star})$ of the bus bar voltage phasor are the values from the same steady power flow distribution of $(v^{\star},w^{\star})$ in Equation \ref{eq:Gbapxst}.
With the matrix $\overline{\mathit{\Theta}}^{\rm int}$ of Equation ref{eq:basenvm}, “a local feedback structure of the internal state of generators on itself” can be modelled.
Since a regular electrical power system is operated near a steady power flow distribution, the steady value necessary to build the model can be identified based on measurement data.

Next, let us estimate the indirect impact of the signal $w$ on the signal $v$ through the automatic generation control.  The partial differential of $v$ related to the input $P_{\rm mech}$ of the automatic generation control is:
\[
\frac{\partial v}{\partial P_{\rm mech}}
=
\mat{
1\\0\\0
}
\]
If the broadcast-type PI controller of Equation (\ref{eq:agccon}) is incorporated as the automatic generation control, since the time integral of $\omega_0 \Delta \omega$ is equivalent to $\delta$:
\[
\frac{\partial P_{\rm mech}}{\partial \delta} = -  \frac{\alpha \beta k_{\rm I}}{\omega_0} 
,\qquad
\frac{\partial P_{\rm mech}}{\partial \Delta \omega}= - \alpha \beta k_{\rm P}
,\qquad
\frac{\partial P_{\rm mech}}{\partial E}= 0
\]
Thus, because of the chain rule of differentials, the impact of the signal $w$ on the signal $v$ through the broadcast-type PI controller can be modelled as:
\begin{align}
\overline{\mathit{\Theta}}^{\rm agc}:=
-  \alpha \beta \mat{
\tfrac{k_{\rm I}}{\omega_0} & k_{\rm P}  & 0\\
0 & 0 & 0\\
0 & 0 & 0
}
\end{align}
To obtain this parameter, the controller gain of the automatic generation control must be acquired with an appropriate method.

Similarly, let us estimate the indirect impact of the signal $w$ on the signal $v$ through the bus bar voltage phasor $\bm{V}$.
The partial differential of $v$ related to voltage phasor variables $(|\bm{V}|,\angle \bm{V})$ can be calculated as:
\begin{align}
\spliteq{
\frac{\partial v }{\partial |\bm{V}|} &= 
\mat{
-\tfrac{E }{ \Xt } \sfsin(\delta -  \angle \bm{V})  \\
\left( \tfrac{ \Xs }{ \Xt }-1 \right)
\sfcos (\delta - \angle \bm{V} ) \\
1
}
\\
\frac{\partial v }{\partial \angle \bm{V}} &= 
\mat{
\tfrac{E|\bm{V} |}{ \Xt } \sfcos(\delta -  \angle \bm{V}) \\
\left( \tfrac{ \Xs }{ \Xt }-1 \right)
|\bm{V}|\sfsin (\delta - \angle \bm{V} ) \\
0
}
}
\end{align}
Meanwhile, as analyzed in Section \ref{sec:allgen}, the bus bar voltage phasor
changes not only based on the internal state of the connected generator but also
dependent on the internal state of all the other generators. Specifically, when
the vectors of the internal state of all generators excluding the generator of
interest are expressed as $\overline{\delta}$, $\overline{E}$, the four partial
differentials
$\tfrac{\partial |\bm{V}| }{\partial \delta}$,
$\tfrac{\partial \angle \bm{V} }{\partial \delta}$,
$\tfrac{\partial |\bm{V}| }{\partial E}$,
$\tfrac{\partial \angle \bm{V} }{\partial E}$become a function that depends on the summary of the
internal state of all generators:
\[
z_{\mathds G}:=(\delta,\overline{\delta},E,\overline{E})
\]
It is not easy to analytically obtain these partial derivatives for a typical electrical power system model, but if the values:
\begin{align}\label{eq:thetaV}
\theta
:=
\mat{
\tfrac{\partial |\bm{V}| }{\partial \delta}(z_{\mathds G}^{\star}) &
0 &
\tfrac{\partial |\bm{V}| }{\partial E}(z_{\mathds G}^{\star}) \\
\tfrac{\partial \angle \bm{V} }{\partial \delta}(z_{\mathds G}^{\star}) &
0 &
\tfrac{\partial \angle \bm{V} }{\partial E}(z_{\mathds G}^{\star})
}
\end{align}
Could be determined using measurement data near a steady power flow distribution, the impact of the signal $w$ on the signal $v$ through the bus bar voltage phasor $\bm{V}$ can be modelled by:
\begin{align}\label{eq:ThetaV}
\overline{\mathit{\Theta}}^{\rm ext}:=
\mat{
-\tfrac{E^{\star} }{ \Xt } \sfsin(\delta^{\star} -  \angle \bm{V}^{\star}) 
 &
\tfrac{E^{\star}|\bm{V}^{\star} |}{ \Xt } \sfcos(\delta^{\star} -  \angle \bm{V}^{\star}) 
\\
\left( \tfrac{ \Xs }{ \Xt }-1 \right)
\sfcos (\delta^{\star} - \angle \bm{V}^{\star} )  
&
\left( \tfrac{ \Xs }{ \Xt }-1 \right)
|\bm{V}^{\star}|\sfsin (\delta^{\star} - \angle \bm{V}^{\star} )
\\
1 & 0
}
\hat{\theta}
\end{align}
$z_{\mathds G}^{\star}$ of Equation \ref{eq:thetaV} expresses the steady value of $z_{\mathds G}$, and the 0 element on the second column corresponds to $\tfrac{\partial |\bm{V}| }{\partial \Delta \omega}$，$\tfrac{\partial \angle \bm{V} }{\partial \Delta \omega}$.
$\hat{\theta}$ of Equation \ref{eq:ThetaV} expresses the identified values of $\theta$.
$\overline{\mathit{\Theta}}^{\rm ext}$ of Equation \ref{eq:ThetaV} models “a global feedback structure the internal state of generators provides to itself.
This is in contrast to $\overline{\mathit{\Theta}}^{\rm int}$ of Equation \ref{eq:basenvm} that models the local feedback structure.

Since the electrical power system must be always in a stable operation, parameters $\hat{\theta}$ of Equation \ref{eq:ThetaV} must be determined using the data measured in operation.
In control systems engineering, determination of the subsystem in an operating feedback system is called \textbf{closed-loop identification}.
Since closed-loop identification cannot freely excite the input of the identification target, it is often more difficult than identification when excitation of input is possible.

If using the above estimates by approximate linearization simultaneously, model parameters of Equation \ref{eq:Gbapxst} are structured as follows:
\begin{align}\label{eq:Thetasum}
\overline{\mathit{\Theta}}=
\overline{\mathit{\Theta}}^{\rm int}+
\overline{\mathit{\Theta}}^{\rm agc}+
\overline{\mathit{\Theta}}^{\rm ext}
\end{align}
As discussed in the previous part, the retrofit controller of Equation \ref{eq:retroK} does not change the stability of the steady power flow distribution for any matrix $\overline{\mathit{\Theta}}$.
In contrast, to maintain the prediction accuracy by the approximate linear environment model, $\overline{\mathit{\Theta}}$ should be updated at a frequency appropriate for the changes in the power flow distribution.

\begin{figure}[t]
%  \centering
%  {
%  \begin{minipage}{0.49\linewidth}
%    \centering
%    \includegraphics[width = 1.0\linewidth]{figs/timedeltamodel}
%    \subcaption{ $\delta_1$の時系列データ}
%     \medskip
%  \end{minipage}
%  \begin{minipage}{0.49\linewidth}
%    \centering
%    \includegraphics[width = 1.0\linewidth]{figs/timeEmodel}
%    \subcaption{ $E_1$の時系列データ}
%     \medskip
%  \end{minipage}
%    }
  \centering
  {
  \begin{minipage}{0.49\linewidth}
    \centering
    \includegraphics[width = 1.0\linewidth]{figs/timedeltamodel}
    \subcaption{Time series data of $\delta_3$ and $\hat{\delta}_3$}
     \medskip
  \end{minipage}
  \begin{minipage}{0.49\linewidth}
    \centering
    \includegraphics[width = 1.0\linewidth]{figs/timeEmodel}
    \subcaption{Time series data of $E_3$ and $\hat{E}_3$}
     \medskip
  \end{minipage}
    }
\caption{\textbf{Time response to random excitation input}
 \\ \centering(Blue solid line: $\delta_3, E_3$, Red dashed line: $\hat{\delta}_3,\hat{E}_3$)
 }
  \label{fig:timeVmodel}
\medskip
\end{figure}


\begin{figure}[t!]
  \centering
  {
  \begin{minipage}{0.49\linewidth}
    \centering
    \includegraphics[width = 1\linewidth]{figs/heatdelta}
    \subcaption{ $Q(\delta_3,\hat{\delta}_3)$ }
    \medskip
  \end{minipage}
  \begin{minipage}{0.49\linewidth}
    \centering
    \includegraphics[width = 1\linewidth]{figs/heatE}
    \subcaption{ $Q(E_3,\hat{E}_3)$ }
    \medskip
  \end{minipage}
}
%  \centering
%  {
%  \begin{minipage}{0.49\linewidth}
%      \centering
%    \includegraphics[width = 1\linewidth]{figs/angVdelta}
%    \subcaption{ $\bigl(\delta_1(\tfrac{k}{100}),\angle \bm{V}_1(\tfrac{k}{100}) \bigr)$ }
%    \medskip
%  \end{minipage}
%  \begin{minipage}{0.49\linewidth}
%    \centering
%    \includegraphics[width = 1\linewidth]{figs/angVE}
%    \subcaption{ $\bigl(E_1(\tfrac{k}{100}), \angle \bm{V}_1(\tfrac{k}{100}) \bigr)$ }
%    \medskip
%  \end{minipage}
%}
% \medskip
 \caption{\textbf{Approximation error of internal state with respect to identification parameter}}
 \label{fig:datamodeling}
\medskip
\end{figure}


\begin{例}[Identification of the approximate linear environment model based on measurement data]\label{ex:modelingV}
Similar to Example \ref{ex:avreffect}, let us consider the same AVR incorporated in generator 1 and generator 3 for the electrical power system model consisting of three bus bars.
Here, the broadcast-type PI controller of Equation (\ref{eq:agccon}), for which parameters of \ref{table:agcpara}(b) are set, is incorporated as the automatic generation control.
The steady power flow distribution corresponds to the power flow calculation result of \ref{table:pflow2}.

Below, we focus on generator 3, and identify the partial differential values, the element of $\theta_3$ of Equation \ref{eq:thetaV}, from measurement data. However, since the size of $\tfrac{\partial |\bm{V}_3|}{\partial \delta_3}(z_{\mathds G}^{\star})$ and $\tfrac{\partial \angle \bm{V}_3}{\partial E_3}(z_{\mathds G}^{\star})$ is relatively small, only two values of:
\[
\theta_1:=
\frac{\partial | \bm{V}_3|}{\partial E_3}(z_{\mathds G}^{\star})
,\qquad
\theta_2:=
\frac{\partial \angle \bm{V}_3}{\partial \delta_3}(z_{\mathds G}^{\star})
\]
are identified from the data. At this time, $\overline{\mathit{\Theta}}^{\rm ext}_3$ of Equation \ref{eq:ThetaV} is parametrized as:
\begin{align}\label{eq:Thext1para}
\overline{\mathit{\Theta}}^{\rm ext}_3=
\mat{
\tfrac{E_3^{\star}|\bm{V}_3^{\star} |}{ \Xt_3 } \Delta^{\sf cos}_3 \theta_2
& 
0
&
- \tfrac{ E_3^{\star} }{ \Xt_3 } \Delta^{\sf sin}_3 \theta_1
\\
\left( \tfrac{ \Xs_3 }{ \Xt_3 }-1 \right)
|\bm{V}_3^{\star}| \Delta^{\sf sin}_3 \theta_2
&
0
&
\left( \tfrac{ \Xs_3 }{ \Xt_3 }-1 \right)
 \Delta^{\sf cos}_3 \theta_1
\\
0 & 0 & \theta_1
}
\end{align}
where $\Delta^{\sf sin}_3$ and $\Delta^{\sf cos}_3$ are constants defined by:
\[
\Delta^{\sf sin}_3 := \sfsin(\delta_3^{\star} -  \angle \bm{V}_3^{\star}) ,\qquad
\Delta^{\sf cos}_3 := \sfcos (\delta_3^{\star} - \angle \bm{V}_3^{\star} )
\]

The optimization of parameters $(\theta_1,\theta_2)$ is performed with the following steps.
The time series data of $(\delta_3,E_3)$ obtained when the input of AVR $V_{{\rm pss}3}$ is randomly excited is acquired from the electrical power system.
In addition, for generator 3, a controller design model $G_{3}^+$ of Equation \ref{eq:Gplus} is built as a feedback system of parameters $\overline{\mathit{\Theta}}_3$ of the local linear subsystem $G_3$ of Equation \ref{eq:desmodl} and the approximate linear environment model.
$\overline{\mathit{\Theta}}_3$ is defined by Equation \ref{eq:Thetasum}.
At this time, as the first and the third elements of $\hat{y}_3$, when signals are added to the excitation of $V_{{\rm pss}3}$ as the input $\hat{u}_3$ of Equation \ref{eq:Gplus}, time series data of $(\hat{\delta}_3,\hat{E}_3)$ is obtained.
Parameters $(\theta_1,\theta_2)$ are optimized so that $\hat{\delta}_3(t)$ and $\hat{E}_3(t)$ become good approximations of $\delta_3(t)$ and $E_3(t)$ for all the time $t$ in the interval where the data was obtained.

%\[
%\delta_3(t) \simeq \hat{\delta}_3(t)
%,\qquad
%E_3(t) \simeq \hat{E}_3(t)
%\]

The blue line in \FIGref{fig:timeVmodel} shows the time series data of $(\delta_3,E_3)$ when $V_{{\rm pss}3}$ is randomly excited between 0 [s] to 10 [s].
The deviation against the steady value $(\delta_3^{\star},E_3^{\star})$ is being shown.
The result of a comprehensive search for the optimal parameters for this data $(\theta_1,\theta_2)$ over an even interval of 0.01 is shown in \FIGref{fig:datamodeling}.
The horizontal and vertical axes show the set values of $\theta_1$ and $\theta_2$, respectively, where the colors of the range of (a) and (b) show the errors $Q(\delta_3,\hat{\delta}_3)$,$Q(E_3,\hat{E}_3)$.
However, the following:
\[
Q(x,\hat{x}):=
\sum_{k=1}^{1000}
\left\|
x\left(
\tfrac{k}{100}
\right)
-
\hat{x}\left(
\tfrac{k}{100}
\right)
\right\|^2
\]
is a function that evaluates the error of 1,000 discrete time signals where continuous time signals $x(t)$,$\hat{x}(t)$ of $t\in [0,10]$ were sampled over a period of 0.01 [s].
Based on this result, we set the parameter values to $(0.215,0.675)$.
These parameter values correspond to "$\times$" of \FIGref{fig:datamodeling}.
The time series data of $(\hat{\delta}_3,\hat{E}_3)$ corresponding to this parameter setting is shown with the broken red line in \FIGref{fig:timeVmodel}.
With the obtained approximate linear environment model, we can see that the behavior of the internal state of generator 3 is captured.
\end{例}


In Example \ref{ex:modelingV}, the parameters of the approximate linear environment model are identified as the index of the precision by which the internal state of the generators is approximated.
The effect of the retrofit control based on this identification method is presented in Chapter \ref{chap:largesim}.

\newpage
%\printindex
%
%
\end{document}