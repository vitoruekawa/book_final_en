\documentclass[tombow,dvipdfmx]{corona-a5-1.1}
% dvipdfmxを追加（川口）

\input{../settings}

\begin{document}

\chapter{電力系統モデルの安定化制御}

チャプター概要

\section{周波数安定化制御}
\subsection{ブロードキャスト型PIコントローラによる自動発電制御}


\subsubsection{自動発電制御とは}

本節では，未知の負荷変動に対して適切に発電量を調整するための\textbf{自動発電制御}（AGC：Automatic Generation Control）の動作原理を説明する。
自動発電制御では，いくつかの発電機の周波数偏差を観測することによって，電力の需要に対して供給が少なければ発電量を増加し，供給が多ければ発電量を減少するような制御動作を行う
\footnote{
現実の電力系統運用では，中央給電指令所が自動発電制御を行なっている。
基本となる動作原理は共通であるが，目的によりいくつかの方式が存在する。
50Hzや60Hzの基準周波数に対して，$\pm$0.2Hz程度の範囲に周波数を維持することが目標とされている。
}
。
この制御動作は，電力系統の一般的な特性として，需要に対して供給が少なければ負の周波数偏差が生じ，供給が多ければ正の周波数偏差が生じるという事実に基づく。
\red{なお，電力系統工学では，周波数偏差を0に漸近収束させる制御全般を総称して\textbf{周波数安定化制御}と呼ぶ。}

自動発電制御の難しさの1つは，実際の電力系統には未知のパラメータが数多く存在することにある。
例えば，30分程度の時間スケールにおいて負荷の総量を大掴みに予測することは可能であるが，時々刻々と変化する個々の負荷の値を正確に把握することはできない
\footnote{
現実の電力系統運用では，天候や気温などの気象予測情報や過去の実績情報などを用いて，ある程度の範囲のエリアに関する総需要の変化を予測している。
手法によってエリアの大きさなどは様々であるが，需要を完全に予測することは不可能である。
}
。
また，各送電線のコンダクタンスやサセプタンスなどのすべてのパラメータを正確に知ることも難しい。
したがって，電力系統全体のモデルを知らなくても適用可能な制御アルゴリズムを設計することが必要となる。

一方で，第\ref{sec:numsimtr}節の数値例で確認したように，需給バランスが取れていない状況においても，発電機群の周波数は漸近的に同期するという特性をもつ。
この事実は，1つ以上の発電機群の外部入力値を適切に制御することによって，それらの周波数偏差を0にすることができれば，残りのすべての発電機群の周波数偏差も自動的に0となることを意味する。
具体的には，いくつかの発電機群の周波数偏差の平均値を計測して，その平均値を0とするように発電機群の外部入力値を制御すれば，すべての発電機の周波数偏差を漸近的に0に収束させることが可能となる。
このような制御動作は，基本的にはPI制御によって実現することができる
\footnote{
PI制御は，観測した偏差とその積分値の重み付き和によって入力を調整する制御アルゴリズムである。
なお，PとIはProportional（比例）とIntegral（積分）を指す。
}
。
コントローラに含まれる積分器が，未知の負荷や送電網のパラメータなどに合わせて適切な入力値を探索する動作を行う。

\subsubsection{自動発電制御の定式化}

以下では，第\ref{sec:genfund}節における電圧フェーザを入力とする発電機モデルを考える。
その動特性を再掲すると
\begin{subequations}\label{eq:gendifagc}
\begin{align}
\simode{
\dot{\delta}_i&= \omega_0  \Delta \omega_i \\
M_i   \Delta \dot{\omega}_i&= 
 - D_i \Delta\omega_i  
 - P_i
+P_{{\rm mech}i}
\\
\tau_{{\rm d}i} \dot{E}_i & = 
 -\tfrac{X_{{\rm d}i}}{X_{{\rm q}i}}E_i
+\left(
\tfrac{X_{{\rm d}i}}{X_{{\rm q}i}}-1
\right)
|\bm{V}_i| \sfcos (\delta_i - \angle \bm{V}_i ) 
+ V_{{\rm field}i}
}
\end{align}
である。
有効電力と無効電力を出力とする場合には
\begin{align}\label{eq:PQoutagc}
\spliteq{
P_i &=  \frac{E_i |\bm{V}_i|}{X_{{\rm q}i}} \sfsin (\delta_i - \angle \bm{V}_i), \\
Q_i &=  \frac{|\bm{V}_i|E_i}{X_{{\rm q}i}} \sfcos (\delta_i - \angle \bm{V}_i)
-\frac{|\bm{V}_i|^2}{X_{{\rm q}i} }
}
\end{align}
\end{subequations}
である。
この表現に合わせて，電圧フェーザを入力，有効電力と無効電力を出力とする負荷モデルも再掲する。
定インピーダンスモデルは，
\begin{subequations}\label{eq:lmodelsagc}
\begin{align}
P_i =  - \real \left[
\overline{\bm{z}}^{-1}_{{\rm load}i} 
\right] |\bm{V}_i|^2,\qquad
Q_i = - \imag \left[
\overline{\bm{z}}^{-1}_{{\rm load}i} 
\right]
|\bm{V}_i|^2
\end{align}
である。
ただし，$\bm{z}_{{\rm load}i}$は負荷のインピーダンスを表す定数である。
同様に，定電流モデルは，負荷の電流フェーザを表す定数を$\bm{I}_{{\rm load}i}$として，
\begin{align}
P_i = \real \left[
\overline{\bm{I}}_{{\rm load}i} \bm{V}_i
\right],\qquad
Q_i = \imag \left[
\overline{\bm{I}}_{{\rm load}i} \bm{V}_i
\right]
\end{align}
と書き表される。
定電力モデルは，$P_{{\rm load}i}$と$Q_{{\rm load}i} $を定数として，
\begin{align}\label{eq:contpwmod}
P_i=P_{{\rm load}i} ,\qquad
 Q_i= Q_{{\rm load}i} 
\end{align}
\end{subequations}
である。
これらの発電機モデルや負荷モデルが，代数方程式
\begin{align}\label{eq:PQVgenagc}
\simode{
P_1 + \bm{j} Q_1 &= 
\sum_{j=1}^{N} \overline{\bm{Y}}_{1j} |\bm{V}_1| |\bm{V}_j | e^{\bm{j} (\angle \bm{V}_1 - \angle \bm{V}_j )} \\ 
& \; \;  \vdots \\
P_N + \bm{j} Q_N &= 
\sum_{j=1}^{N} \overline{\bm{Y}}_{Nj} |\bm{V}_N| |\bm{V}_j | e^{\bm{j} (\angle \bm{V}_N - \angle \bm{V}_j )}
}
\end{align}
により結合されることで，電力系統全体を記述する微分代数方程式系モデルが得られる。
ただし，発電機バスの添字集合を$\mathcal{I}_{\rm G}$，負荷バスの添字集合を$\mathcal{I}_{\rm L}$とするとき，
\[
\mathcal{I}_{\rm G}\cap \mathcal{I}_{\rm L} = \emptyset
,\qquad
\mathcal{I}_{\rm G}\cup \mathcal{I}_{\rm L} = \{1,\ldots, N\}
\]
である。
すなわち，発電機バスと負荷バスの添字に重複はなく，それらを合わせるとすべてのバスの添字集合となる。


自動発電制御は，式(\ref{eq:gendifagc})の機械的トルク$P_{{\rm mech}i}$を調整する制御アルゴリズムである。
以下では，すべての発電機に対する周波数偏差の平均値を観測し，すべての発電機に対して適当に重み付けされた制御入力を送信するブロードキャスト型PIコントローラを考える。
具体的には，すべての$i\in \mathcal{I}_{\rm G}$について
\begin{subequations}\label{eq:agccon}
\begin{align}\label{eq:agccona}
P_{{\rm mech}i}(t)=
- \alpha_i
\underbrace{
\left\{
k_{\rm P} \Delta \omega_{\rm sum}(t) +
k_{\rm I}
\int_0^t \Delta \omega_{\rm sum}(\tau) d \tau
\right\}
}_{P_{0}(t)}
\end{align}
とする。
ただし，$\alpha_i $は発電機$i$の寄与を指定する非負定数であり，
\[
\Delta \omega_{\rm sum}(t) := 
\sum_{i \in \mathcal{I}_{\rm G} } \beta_i \Delta \omega_{i}(t)
\]
は周波数偏差の非負定数$\beta_i$に関する重み付き和とする。
また，$k_{\rm P}$，$k_{\rm I}$はPIコントローラのゲインを表す正定数である。
この自動発電制御器は，$\alpha_i$や$\beta_i$の重み付けのもと，単一のPIコントローラによって生成された信号$P_0(t)$をすべての発電機に同時送信（ブロードキャスト）する構造をもつ。
なお，式\ref{eq:agccona}を微分方程式で表現すれば
\begin{align}
\simode{
\dot{\xi}&=  \Delta \omega_{\rm sum} \\
P_{{\rm mech}i} &= - \alpha_i \left(k_{\rm P} \Delta \omega_{\rm sum} +  k_{\rm I} \xi \right)
}
\end{align}
\end{subequations}
である。
\red{電力系統工学では，非負定数$\alpha_i$は発電機$i$の\textbf{寄与係数}（participation factor）と呼ばれる。}

寄与係数の比率を変えることにより，需給がバランスした定常潮流状態において，各々の発電機が供給する有効電力の値を変更することができる。
システム制御工学の観点では，コントローラの切り替えにより，電力系統モデルの安定な平衡点を移動させることとして解釈できる。
第\ref{sec:staana}節で解析したように，電力系統の安定性は平衡点の選び方によって変化する。
また，電力系統全体の発電コストや送電損失の値も平衡点の選び方に依存する。
したがって，寄与係数を需要の分布に合わせて適切に切り替えることは，系統安定度の向上や経済的コストの低減などにつながる。
このことは，第\ref{sec:conpeco}節で後述する
\footnote{
現実の電力系統運用では，寄与係数の更新は数分から数十分程度の間隔で行われるのが一般的である\cite{kundur1994power}。
電力系統工学の用語では，この寄与係数を更新するスキームは，\textbf{経済負荷配分制御}（EDC：Economic load Dispatching Control）と呼ばれる。
また，寄与係数を更新間隔の間で定数として用いる制御アルゴリズムは，\textbf{負荷周波数制御}（LFC：Load Frequency Control）と呼ばれる。
ただし，経済負荷配分制御と負荷周波数制御の明確な区別がない文献もあるため注意が必要である。
}
。


\subsection{周波数安定化制御の数値シミュレーション}

\red{
界磁電圧は潮流計算されたものに固定して、負荷変動に対して周波数偏差が0に収束するところを見せる。
}


\subsection{コントローラのパラメータ調整による発電コストの低減}\label{sec:conpeco}

\red{
需要分布（の予測）が与えられたとして，需要が多いエリアの発電機を中心にして送電する場合と、遠い発電機から送電する場合でコストを比較するとか？
わかりやすく燃料費は共通にしておけば、送電ロスの大きさ＝コストの大きさになるはず。
}



\section{周波数安定化制御系の数学的な安定性解析\advanced}

\subsection{対象とする電力系統モデル\advanced}\label{sec:objmod}

\subsubsection{電力系統モデルと自動発電制御に関する仮定}

第\ref{sec:stalin}節では，電力系統モデルが定常潮流状態の近傍にあることを仮定して近似線形モデルを導出し，定態安定性の必要条件や十分条件を解析した。
本節では，同様の受動性の概念を用いて，非線形の微分代数方程式で記述される電力系統モデルの周波数安定性を解析する。
特に，自動発電制御が組み込まれたフィードバック制御系全体の安定性を考える。
具体的には，以下の前提のもとで安定性解析を行う。
\begin{itemize}
\item すべての発電機は，式(\ref{eq:lmodelsagc})の発電機モデルで表される。
ただし，各発電機の界磁電圧は定数に設定されていることを仮定する。
\item すべての負荷は，式\ref{eq:contpwmod}の定電力モデルで表される。
\item 式\ref{eq:PQVgenagc}の送電網の代数方程式において，すべての送電線のコンダクタンスは0であることを仮定する。
\item 式(\ref{eq:agccon})のブロードキャスト型PIコントローラによって，自動発電制御が行われている。
ただし，寄与係数と周波数偏差の重みについて，すべての$i\in \mathcal{I}_{\rm G}$に対して，
$\alpha_i = \beta_i $
が成り立つことを仮定する。
\end{itemize}

1つ目と2つ目は，発電機と負荷の標準的なモデルを考えることを意味している。
3つ目の送電網に関する仮定は，送電損失が0であることを意味しており，数学的に安定性の解析を行うためには欠かすことができない
\footnote{
現実の電力系統では，送電損失を完全に無くすことはできないが，高電圧により小さな電流で電力を送ることで送電損失を低減することが可能である。
本節の議論は，近似的に送電損失が0とみなせるような高電圧による送電を前提にして，周波数安定性を解析することに相当する。
}
。
実際，送電損失がある場合には，電力系統モデルの安定性解析は数値的手法に頼らざるを得ないことが多くの文献で指摘されている\cite{narasimhamurthi1984existence,chang1995direct,chiang2011direct,yang2019distributed}。
また，4つ目の仮定は，ブロードキャスト型PIコントローラの入出力特性が受動的となるために必要である。
なお，少なくとも1つの$i\in \mathcal{I}_{\rm G}$に対して寄与係数$\alpha_i$が正であれば，いくつかの係数が0であっても構わない。


また，第\ref{sec:phsync}節の解析で示されているように，
\begin{itemize}
\item 定常潮流状態において，すべての発電機の周波数偏差は同じ値となる。
\end{itemize}
以下の周波数安定性の解析では，この事実が成り立つことを前提とする。

\subsubsection{自動発電制御を組み込んだ電力系統のフィードバック系による表現}

第\ref{sec:linpasana}節の議論と同様に，電力系統モデルを2つのサブシステムのフィードバック系として記述することを考える。
1つ目のサブシステムは，
\begin{align}\label{eq:sys1}
\mathds{F}:
\simode{
M \Delta \dot{\omega}&= 
- 
D
\Delta\omega 
 + 
u_{\mathds{F}}
\\
y_{\mathds{F}}&= \omega_0 \Delta\omega 
}
\end{align}
とする。
ただし，$\Delta\omega$は$\Delta\omega_i$を並べたベクトルであり，$M$と$D$は$M_i$と$D_i$を対角に並べた行列である。
この$\mathds{F}$は，第\ref{sec:linpasana}節の機械サブシステムに等しい。
2つ目のサブシステムは，第\ref{sec:linpasana}節の電気サブシステムを非線形の微分代数方程式系で表現した
\begin{subequations}\label{eq:sys2G}
\begin{align}\label{eq:sys2}
\mathds{G}_i : 
\simode{
\dot{\delta}_i &= u_{\mathds{G}_i}
\\
\tau_{{\rm d}i} \dot{E}_i & = 
 -\tfrac{X_{{\rm d}i}}{X_{{\rm q}i}}E_i
+\left(
\tfrac{X_{{\rm d}i}}{X_{{\rm q}i}}-1
\right)
|\bm{V}_i| \sfcos (\delta_i - \angle \bm{V}_i ) 
+ V_{{\rm field}i}^{\star}
\\
y_{\mathds{G}_i}&= \tfrac{E_i |\bm{V}_i|}{X_{{\rm q}i}} \sfsin (\delta_i - \angle \bm{V}_i)
}
\end{align}
である。
これは，発電機バスに関するサブシステムのように見えるが，式\ref{eq:sys2}におけるバスの電圧フェーザは，発電機バス$i \in \mathcal{I}_{\rm G}$に関する連立方程式
\begin{align}\label{eq:gVeq}
\simode{
P_i &=
\sum_{j\neq i}^{N} B_{ij} |\bm{V}_i| |\bm{V}_j| \sfsin(\angle \bm{V}_i -\angle \bm{V}_j)
\\
Q_i &= 
- B_{ii} |\bm{V}_i|^2 
 -\sum_{j\neq i}^{N} B_{ij} |\bm{V}_i| |\bm{V}_j| \sfcos(\angle \bm{V}_i -\angle \bm{V}_j)
}
\end{align}
と負荷バス$i \in \mathcal{I}_{\rm L}$に関する連立方程式
\begin{align}\label{eq:lVeq}
\simode{
&P_{{\rm load}i} =
\sum_{j\neq i}^{N} B_{ij} |\bm{V}_i| |\bm{V}_j| \sfsin(\angle \bm{V}_i -\angle \bm{V}_j)
\\
&Q_{{\rm load}i} = 
- B_{ii} |\bm{V}_i|^2 -
\sum_{j\neq i}^{N} B_{ij} |\bm{V}_i| |\bm{V}_j| \sfcos(\angle \bm{V}_i -\angle \bm{V}_j)
}
\end{align}
\end{subequations}
を同時に満たさなければならない。
ただし，式\ref{eq:gVeq}の有効電力$P_i$と無効電力$Q_i$は，式\ref{eq:PQoutagc}で定義される。
また，$B_{ij}$は，アドミタンス行列$\bm{Y}$の虚部であるサセプタンス行列の第$(i,j)$要素を表す。
以下では，すべての$i \in \mathcal{I}_{\rm G}$に対して，式\ref{eq:sys2}から式\ref{eq:lVeq}をまとめたものを1つのサブシステムとみなし，それを電気サブシステム$\mathds{G}$と表す。

さらに，式(\ref{eq:agccon})のブロードキャスト型PIコントローラの動特性を
\begin{align}\label{eq:condsK}
\mathds{K}: \simode{
\dot{\xi}&=  h^{\sf T} u_{\mathds{K}} \\
y_{\mathds{K}} &= h \left(k_{\rm P} h^{\sf T}u_{\mathds{K}} +  k_{\rm I} \xi \right)
}
\end{align}
と表す。
ただし，$h$は$\alpha_i$を並べた列ベクトルである。
このとき，上記のサブシステム$\mathds{F}$，$\mathds{G}$とコントローラ$\mathds{K}$の入出力を
\begin{subequations}\label{eq:connds}
\begin{align}
u_{\mathds{F}} = - y_{\mathds{K}} + v_{\mathds{F}}&
,\qquad u_{\mathds{K}} = \frac{1}{\omega_0} y_{\mathds{F}}	\label{eq:connds1}
\\
u_{\mathds{G}} = y_{\mathds{F}}&
,\qquad
v_{\mathds{F}} = - y_{\mathds{G}}		\label{eq:connds2}
\end{align}
\end{subequations}
のように結合すれば，自動発電制御を組み込んだフィードバック制御系全体が表現できる。
ただし，$u_{\mathds{G}}$と$y_{\mathds{G}}$は$u_{\mathds{G}_i}$と$y_{\mathds{G}_i}$を並べたベクトルである。



\subsection{電力系統モデルの平衡点に依らない受動性\advanced}

\subsubsection{平衡点に依らない受動性}

第\ref{sec:linpasana}節の議論は，近似線形モデルによる解析であったため，その内部状態が0に漸近収束することが，もとの非線形モデルにおける特定の定常潮流状態への漸近収束を表していた。
一方で，非線形の微分代数方程式系として表現される電力系統モデルでは，電力の需要と供給がバランスする定常潮流状態においても内部状態は0とはならない。
さらに，定常潮流状態そのものが機械的トルクなどの設定値に依存して変化する。
したがって，個々の定常潮流状態（平衡点）の選択に依存しない安定性解析が望ましい。
このような解析を行うためにシステム制御工学で提唱されている概念として，\textbf{平衡点に依存しない受動性}（equilibrium-independent passivity）と呼ばれるものがある\cite{hines2011equilibrium,simpson2019equilibrium}。
なお，文献によっては，\textbf{シフトされた受動性}（shifted passivity）とも呼ばれている\cite{monshizadeh2019conditions}.
その定義はつぎのように与えられる。

\begin{定義}[平衡点に依らない受動性]\label{def:eipassive}
非線形システム
\begin{align}\label{eq:nlsig}
\Sigma: \simode{
E\dot{x} &= f(x) + Bu \\
y &= h(x)
}
\end{align}
を考える。
ただし，$f:\mathcal{X} \rightarrow \mathbb{R}^{n}$と$h:\mathcal{X} \rightarrow \mathbb{R}^{m}$は滑らかな関数であり，$B \in \mathbb{R}^{n\times m}$と$E \in \mathbb{R}^{n\times n}$は行列である
\footnote{
行列$E$は，微分代数方程式系である式(\ref{eq:sys2G})の電気サブシステム$\mathds{G}$を表現するために導入した。
具体的には，
\[
E=\mat{
I & 0 \\
0 & 0\\ 
}
\]
とすれば，式\ref{eq:nlsig}の$\Sigma$は，微分代数方程式系
\begin{align*}
\simode{
\dot{x}_1 &= f_1(x_1,x_2) + Bu \\
0 &= f_2(x_1,x_2) \\
y &= h(x_1,x_2)
}
\end{align*}
を表す。
電気サブシステム$\mathds{G}$に当てはめれば，$x_1$はすべての$\delta_i$と$E_i$を並べたベクトルであり，$x_2$はすべての$|\bm{V}_i|$と$\angle \bm{V}_i$を並べたベクトルである。
一方で，$E$が正則であるとき，式\ref{eq:sys1}の機械サブシステム$\mathds{F}$のような常微分方程式系を表す。
このようなシステム表現は，\textbf{ディスクリプタ形式}と呼ばれる。
}
。
また，$\mathcal{X}$は許容可能な状態の領域である。
定常的な入力によって実現可能な平衡点の集合を
\begin{align}\label{eq:asbleq}
\mathcal{E}_{\Sigma} :=
\left\{
x^{\star} \in \mathcal{X}: 
\mbox{$0 = f(x^{\star})+B u^{\star}$を満たす$u^{\star}$が存在する}
\right\}
\end{align}
と表す。
各々すべての平衡点$x^{\star} \in \mathcal{E}_{\Sigma}$に対して，$W_{x^{\star}} (x^{\star})=0$であり，かつ，任意の入力$u $に対して
\begin{align}\label{eq:eiconpv}
\frac{d}{dt} W_{x^{\star}} \bigl( x(t) \bigr) \leq (u-u^{\star})^{\sf T} (y-y^{\star})
,\qquad
\forall t \geq 0
\end{align}
を満たす微分可能な半正定値関数$W_{x^{\star}}:\mathcal{X} \rightarrow \mathbb{R}_{\geq 0}$が存在するとき，$\Sigma$は\textbf{平衡点に依らず受動的}であると呼ぶ。
ただし，平衡点$x^{\star}$における定常的な入力と出力を
\begin{align}\label{eq:uystar}
u^{\star} := -(B^{\sf T}B)^{-1}B^{\sf T}f(x^{\star})
,\qquad
y^{\star} := h(x^{\star}) 
\end{align}
と表している。
特に，上記の半正定値関数$W_{x^{\star}}(x)$に加えて
\begin{align}\label{eq:eiconosp}
\frac{d}{dt} W_{x^{\star}} \bigl( x(t) \bigr) \leq (u-u^{\star})^{\sf T} (y-y^{\star})
-\rho\|y-y^{\star}\|^2
,\qquad
\forall t \geq 0
\end{align}
を満たすある正定数$\rho$が存在するとき，$\Sigma$は\textbf{平衡点に依らず強受動的}であると呼ぶ。
\end{定義}

定義\ref{def:eipassive}では，システムの平衡点$x^{\star} \in \mathcal{E}_{\Sigma}$を基準としてその受動性が定義されていると解釈できる。
線形システムの範疇では，システムが零固有値をもたない限り，第\ref{sec:linpasana}節の受動性の定義と等価である\cite{hines2011equilibrium}。
なお，上記の関数$W_{x^{\star}}(x)$は，通常の受動性と同様に\textbf{蓄積関数}と呼ばれる。

文献\cite{simpson2019equilibrium}において，システムが平衡点に依らず受動的である場合には，その蓄積関数はある関数$U(x)$を用いて
\begin{align}\label{eq:paraW}
W_{x^{\star}}(x) = U(x) - U(x^{\star}) - \nabla U^{\sf T}(x^{\star}) (x-x^{\star})
\end{align}
の形式で表せることが示されている
\footnote{
統計学などでは，凸関数である$U(x)$に対して，式\ref{eq:paraW}の右辺の量は$x$と$x^{\star}$の$U(x)$に関する\textbf{ブレグマン距離}（Bregman distance）と呼ばれている\cite{bregman1967relaxation}。
なお，$U(x)=\|x\|^2$とするとき，$W_{x^{\star}}(x)=\|x-x^{\star}\|^2$はユークリッド距離に一致する。
}
。
また，定義\ref{def:eipassive}では，式\ref{eq:paraW}の蓄積関数$W_{x^{\star}}(x)$は半正定値関数であることが条件として課されている。
具体的には，
\begin{align}\label{eq:Uineqst}
U(x) \geq  U(x^{\star}) + \nabla U^{\sf T}(x^{\star}) (x-x^{\star})
\end{align}
が成り立つことが条件となる。
この不等式が任意の組$(x,x^{\star}) \in \mathcal{X} \times \mathcal{X}$に対して成り立つのであれば，各々すべての平衡点$x^{\star} \in \mathcal{E}_{\Sigma}$に対して，$W_{x^{\star}}(x)$は半正定値関数である。
式\ref{eq:Uineqst}の不等式は，$U(x)$が\textbf{凸関数}（convex function）であることを表す
\footnote{
関数$f(x)$に対して，定義域内から選ばれた任意の2点の組$(x,y)$について
\[
f\bigl(
\theta x + (1-\theta) y
\bigr)
\leq \theta f(x) + (1- \theta) f(y)
,\qquad
\forall \theta \in [0,1]
\]
が成り立つとき，$f(x)$は\textbf{凸関数}であると呼ぶ。
特に，$f(x)$が微分可能であるとき，$f(x)$が凸関数であるための必要十分条件は，任意の2点の組$(x,y)$について
\[
f(x) \geq f(y) + \nabla f^{\sf T}(y)(x-y)
\]
が成り立つことである。
}
。
後述するように，関数$U(x)$が凸であるような領域$\mathcal{X}$が，平衡点に依存しない受動性を用いた安定性解析に重要な役割を果たす。



\subsubsection{機械サブシステムの解析}

第\ref{sec:linpasana}節で示されているように，機械サブシステム$\mathds{F}$は強受動的である。
同様に，式\ref{eq:sys1}の$\mathds{F}$が平衡点に依らず強受動的であることを確認する。
まず，機械サブシステムを
\begin{align}
\mathds{F}: \simode{
\dot{x}_{\mathds{F}} & = A_{\mathds{F}} x_{\mathds{F}} + B_{\mathds{F}} u_{\mathds{F}} \\
y_{\mathds{F}} &= C_{\mathds{F}} x_{\mathds{F}}
}
\end{align}
の形式で書き表す。
ただし，状態$x_{\mathds{F}}$は$\Delta \omega_i$を並べたベクトルであり，
$u_{\mathds{F}}$と$y_{\mathds{F}}$は$u_{\mathds{F}_i}$と$y_{\mathds{F}_i}$を並べたベクトルである。
また，システム行列は
\[
A_{\mathds{F}} := -M^{-1}D,\qquad
B_{\mathds{F}} := M^{-1},\qquad
C_{\mathds{F}} := \omega_0 I
\]
である。
なお，行列$M$と$D$は，$M_i$と$D_i$を対角に並べた行列である。
任意に選ばれた平衡点$x^{\star}_{\mathds{F}} \in \mathcal{E}_{\mathds{F}}$に対して，蓄積関数を
\begin{align*}
W_{x^{\star}_{\mathds{F}}}(x_{\mathds{F}})
= \frac{\omega_0}{2}
(x_{\mathds{F}} -x^{\star}_{\mathds{F}})^{\sf T}
M
(x_{\mathds{F}} -x^{\star}_{\mathds{F}})
\end{align*}
と選ぶ。
ただし，平衡点に関する$(x^{\star}_{\mathds{F}},u^{\star}_{\mathds{F}},y^{\star}_{\mathds{F}})$は
\begin{align}\label{eq:xFsteady}
0=
A_{\mathds{F}} x^{\star}_{\mathds{F}}
+
B_{\mathds{F}} u^{\star}_{\mathds{F}}
,\qquad
y^{\star}_{\mathds{F}} = C_{\mathds{F}} x^{\star}_{\mathds{F}}
\end{align}
を満たす。
なお，式\ref{eq:paraW}の形式で表すならば，
\[
U_{\mathds{F}}(x_{\mathds{F}}):= \frac{\omega_0}{2} x_{\mathds{F}}^{\sf T} M x_{\mathds{F}}
\]
とすることにより，蓄積関数は
\[
W_{x^{\star}_{\mathds{F}}}(x_{\mathds{F}}) = U_{\mathds{F}}(x_{\mathds{F}}) 
- U_{\mathds{F}}(x^{\star}_{\mathds{F}}) 
- \nabla U^{\sf T}_{\mathds{F}}(x^{\star}_{\mathds{F}}) (x_{\mathds{F}}-x^{\star}_{\mathds{F}})
\]
と表せる。
この蓄積関数の勾配関数は
\begin{align*}%\label{eq:nabW}
\nabla W_{x^{\star}_{\mathds{F}}}(x_{\mathds{F}}) = \omega_0 M (x_{\mathds{F}} -x^{\star}_{\mathds{F}})
\end{align*}
であることから，蓄積関数の時間微分は
\begin{align}\label{eq:tdFds}
\spliteq{
\frac{d}{dt} W_{x^{\star}_{\mathds{F}}} \bigl( x_{\mathds{F}}(t) \bigr) 
&= 
\nabla W_{x^{\star}_{\mathds{F}}}^{\sf T}\left( x_{\mathds{F}}(t) \right) \dot{x}_{\mathds{F}}(t) \\
&= 
\nabla W_{x^{\star}_{\mathds{F}}}^{\sf T}\left( x_{\mathds{F}}(t) \right)
 \left\{
A_{\mathds{F}} \left( x_{\mathds{F}}(t) -x^{\star}_{\mathds{F}} \right)
+
B_{\mathds{F}} \left( u_{\mathds{F}}(t) -u^{\star}_{\mathds{F}} \right)
\right\}
\\
& \leq \textstyle
(y_{\mathds{F}}(t) -y^{\star}_{\mathds{F}})^{\sf T}
(u_{\mathds{F}}(t) -u^{\star}_{\mathds{F}})
 - \tfrac{\sfmin \left\{ D_i \right\}}{\omega_0}
\|y_{\mathds{F}}(t) -y^{\star}_{\mathds{F}}\|^2
}
\end{align}
と評価できる。
ただし，2つ目の等号の導出に式\ref{eq:xFsteady}の関係を用いた。


\subsubsection{機械サブシステムと自動発電制御器のフィードバック系の解析}

機械サブシステムと同様にして，式\ref{eq:condsK}のブロードキャスト型PIコントローラの受動性も示すことができる。
蓄積関数を
\[
W_{\xi^{\star}}(\xi) := \frac{1}{2} k_{\rm I} (\xi-\xi^{\star} )^2
\]
と定義すれば，その時間微分は
\begin{align}\label{eq:tdKds}
\spliteq{
\frac{d}{dt} W_{\xi^{\star}} \bigl( \xi(t) \bigr) 
&=
(y_{\mathds{K}} - y_{\mathds{K}}^{\star})^{\sf T} (u_{\mathds{K}} - u_{\mathds{K}}^{\star})
- k_{\rm I} u_{\mathds{K}}^{\sf T} hh^{\sf T} u_{\mathds{K}} \\
& \leq (y_{\mathds{K}} - y_{\mathds{K}}^{\star})^{\sf T} (u_{\mathds{K}} - u_{\mathds{K}}^{\star})
}
\end{align}
と評価できる。
ただし，平衡点における$(\xi^{\star},u_{\mathds{K}}^{\star},y_{\mathds{K}}^{\star})$について
\begin{align}\label{eq:Kdseq}
\simode{
0 &=  h^{\sf T} u_{\mathds{K}}^{\star} \\
y_{\mathds{K}}^{\star} &= h \left(k_{\rm P} h^{\sf T}u_{\mathds{K}}^{\star} +  k_{\rm I} \xi^{\star} \right)
}
\end{align}
が成り立つことを用いた。

システム制御工学では，2つの受動的なシステムのネガティブ・フィードバック系は，受動的になることが知られている。
この事実に基づき，式\ref{eq:sys1}の機械サブシステム$\mathds{F}$と式\ref{eq:condsK}のブロードキャスト型PIコントローラ$\mathds{K}$をフィードバック結合した
\begin{align}\label{eq:sysFKds}
\mathds{F}_+:
\simode{
M \Delta \dot{\omega}&= 
- 
D
\Delta\omega 
- h \left(k_{\rm P} h^{\sf T}\Delta\omega  +  k_{\rm I} \xi \right)  + v_{\mathds{F}}
\\
\dot{\xi} &= h^{\sf T}\Delta\omega\\
y_{\mathds{F}}&= \omega_0 \Delta\omega 
}
\end{align}
も平衡点に依らず強受動的であることが示される。
実際，式\ref{eq:tdFds}と式\ref{eq:tdKds}の不等式を足し合わせることにより，
\begin{align}\label{eq:disineqFp}
\spliteq{
& \frac{d}{dt}  \left\{
W_{x^{\star}_{\mathds{F}}}  \bigl( x_{\mathds{F}}(t) \bigr) 
+
\omega_0
W_{\xi^{\star}} \bigl( \xi(t) \bigr) 
\right\} \\
& \hspace{3em} \leq 
(y_{\mathds{F}}(t) -y^{\star}_{\mathds{F}})^{\sf T}
(v_{\mathds{F}}(t) -v^{\star}_{\mathds{F}})  
- \tfrac{\sfmin \left\{ D_i \right\}}{\omega_0}
\|y_{\mathds{F}}(t) -y^{\star}_{\mathds{F}}\|^2
}
\end{align}
が得られる。
ただし，式\ref{eq:connds1}の入出力関係を用いた。

なお，式\ref{eq:connds2}の入出力関係により，式\ref{eq:sysFKds}の$\mathds{F}_+$と式(\ref{eq:sys2G})の$\mathds{G}$を結合すれば，自動発電制御を組み込んだフィードバック制御系全体が表される。
この事実に基づき，以下では$\mathds{G}$の平衡点に依らない受動性を解析する。

\subsubsection{電気サブシステムの解析}

式(\ref{eq:sys2G})の電気サブシステム$\mathds{G}$の平衡点に依らない受動性を解析する。
以下では，$\mathds{G}$の発電機バスと負荷バスに関する時間変数$\delta_i$，$E_i$，
$|\bm{V}_i|$，$\angle \bm{V}_i$をすべて並べた列ベクトルを$x_{\mathds{G}}$と表す。
この表記のもと，ポテンシャルエネルギー関数\cite[第6.3節]{chiang2011direct}を
\begin{align}\label{eq:potWx}
\spliteq{
U_{\mathds{G}}(x_{\mathds{G}})  := 
&  \sum_{i\in \mathcal{I}_{\rm G}}
\left\{
\frac{X_{{\rm d}i} E_i^2 }{2X_{{\rm q}i}(X_{{\rm d}i} - X_{{\rm q}i} )}  
- 
\frac{E_i |\bm{V}_i|}{X_{{\rm q}i}} \sfcos (\delta_i - \angle \bm{V}_i)
+\frac{|\bm{V}_i|^2}{2X_{{\rm q}i}}
\right\}
\\
- & \sum_{i\in \mathcal{I}_{\rm L}}
\bigl\{
 P_{{\rm load}i} \angle \bm{V}_i
+ Q_{{\rm load}i} \ln{|\bm{V}_i|}
\bigr\} \\
- & \sum_{i=1}^{N}
\left\{
 \frac{B_{ii}|\bm{V}_i|^2 }{2}  
+ \sum_{j\neq i}^{N} B_{ij} |\bm{V}_i| |\bm{V}_j| \sfcos(\angle \bm{V}_i -\angle \bm{V}_j)
\right\}
}
\end{align}
と定義する。
ここで，式\ref{eq:paraW}の表現に基づいて，蓄積関数の候補を
\begin{align}\label{eq:stops}
W_{x^{\star}_{\mathds{G}}}(x_{\mathds{G}}) = U_{\mathds{G}}(x_{\mathds{G}}) 
- U_{\mathds{G}}(x^{\star}_{\mathds{G}}) 
- \nabla U_{\mathds{G}}^{\sf T}(x^{\star}_{\mathds{G}}) (x_{\mathds{G}}-x^{\star}_{\mathds{G}})
\end{align}
と構成する。
なお，その勾配関数は
\[
\nabla W_{x^{\star}_{\mathds{G}}}(x_{\mathds{G}}) =
\nabla U_{\mathds{G}}(x_{\mathds{G}}) 
- \nabla U_{\mathds{G}}(x^{\star}_{\mathds{G}}) 
\]
である。
蓄積関数の時間微分を計算するため，ポテンシャルエネルギー関数の勾配関数を求める。
まず，
$ U_{\mathds{G}}(x_{\mathds{G}}) $の$\delta_i$と$E_i$に関する偏微分を計算すると
\begin{align*}
\frac{\partial U_{\mathds{G}}}{\partial \delta_i}(x_{\mathds{G}}) &= \frac{E_i |\bm{V}_i|}{X_{{\rm q}i}} \sfsin (\delta_i - \angle \bm{V}_i) ,
\\
\frac{\partial U_{\mathds{G}}}{\partial E_i} (x_{\mathds{G}})&= - \frac{1}{X_{{\rm d}i} - X_{{\rm q}i}}
\left\{
-\frac{X_{{\rm d}i}}{X_{{\rm q}i}}E_i
+\left(
\frac{X_{{\rm d}i}}{X_{{\rm q}i}}-1
\right)
|\bm{V}_i| \sfcos (\delta_i - \angle \bm{V}_i ) 
\right\}
\end{align*}
となる。
したがって，各変数が式(\ref{eq:sys2G})の微分代数方程式にしたがうならば，式\ref{eq:sys2}から，すべての$i\in \mathcal{I}_{\rm G}$に対して，
\begin{align*}
\frac{\partial U_{\mathds{G}}}{\partial \delta_i}(x_{\mathds{G}})  = y_{\mathds{G}_i}
,\qquad
\frac{\partial U_{\mathds{G}}}{\partial E_i} (x_{\mathds{G}})= 
\frac{V_{{\rm field}i}^{\star} - \tau_{{\rm d}i}\dot{E}_i  }{X_{{\rm d}i} - X_{{\rm q}i} }
\end{align*}
が成り立つ。
また，$i\in \mathcal{I}_{\rm G}$に対して，電圧フェーザ変数に関するポテンシャルエネルギー関数の偏微分は
\begin{align*}
\spliteq{
\frac{\partial U_{\mathds{G}}}{\partial |\bm{V}_i| }(x_{\mathds{G}}) &= 
- B_{ii} |\bm{V}_i| 
-
\sum_{j\neq i}^{N} B_{ij}  |\bm{V}_j| \sfcos(\angle \bm{V}_i -\angle \bm{V}_j)- \frac{Q_i}{|\bm{V}_i|}
\\
\frac{\partial U_{\mathds{G}}}{\partial \angle \bm{V}_i } (x_{\mathds{G}})&= 
\sum_{j\neq i}^{N}
B_{ij} |\bm{V}_i| |\bm{V}_j| \sfsin(\angle \bm{V}_i -\angle \bm{V}_j)
-
P_i
}
\end{align*}
となる。
したがって，式\ref{eq:gVeq}の方程式から，これらが0であることがわかる。
同様に，式\ref{eq:lVeq}の方程式から，$i\in \mathcal{I}_{\rm L}$に対して，
\begin{align*}
\spliteq{
\frac{\partial U_{\mathds{G}}}{\partial |\bm{V}_i| }(x_{\mathds{G}}) &= 
- B_{ii} |\bm{V}_i| -
\sum_{j\neq i}^{N} B_{ij}  |\bm{V}_j| \sfcos(\angle \bm{V}_i -\angle \bm{V}_j)
 - \frac{Q_{{\rm load}i}}{|\bm{V}_i|}
\\
\frac{\partial U_{\mathds{G}}}{\partial \angle \bm{V}_i } (x_{\mathds{G}})&= 
B_{ij} |\bm{V}_i| |\bm{V}_j| \sfsin(\angle \bm{V}_i -\angle \bm{V}_j)
-
P_{{\rm load}i}
}
\end{align*}
も0であることがわかる。
したがって，すべての$i\in \mathcal{I}_{\rm G} \cup \mathcal{I}_{\rm L}$に対して
\begin{align*}
\frac{\partial U_{\mathds{G}}}{\partial |\bm{V}_i| } (x_{\mathds{G}})= 0
,\qquad
\frac{\partial U_{\mathds{G}}}{\partial \angle \bm{V}_i } (x_{\mathds{G}})= 0
\end{align*}
が成り立つことがわかる。

つぎに，$\nabla U_{\mathds{G}}(x^{\star}_{\mathds{G}}) $について，
$\mathds{G}$の平衡点に関する$(x^{\star}_{\mathds{G}},u^{\star}_{\mathds{G}},y^{\star}_{\mathds{G}})$を考える。
平衡点の関係から，ある電圧フェーザ変数$(|\bm{V}_i^{\star}|, \angle \bm{V}_i^{\star})_{i\in \mathcal{I}_{\rm G} \cup \mathcal{I}_{\rm L} }$が存在して，
\begin{subequations}\label{eq:eqeq}
\begin{align}\label{eq:eqeqa}
&\simode{
0 & = u_{\mathds{G}_i}^{\star} \\
 0 & =
-\tfrac{X_{{\rm d}i}}{X_{{\rm q}i}}E_i^{\star}
+\left(
\tfrac{X_{{\rm d}i}}{X_{{\rm q}i}}-1
\right)
|\bm{V}_i^{\star}| \sfcos (\delta_i^{\star} - \angle \bm{V}_i^{\star} ) 
+V_{{\rm field}i}^{\star}
} \\
&\simode{
P_i^{\star} 
& =
\sum_{j\neq i}^{N} B_{ij} |\bm{V}_i^{\star}| |\bm{V}_j^{\star}| \sfsin(\angle \bm{V}_i^{\star} -\angle \bm{V}_j^{\star})
\\
Q_i^{\star} 
&=
- B_{ii} |\bm{V}_i^{\star}|^2 
 - \sum_{j\neq i}^{N} B_{ij} |\bm{V}_i^{\star}| |\bm{V}_j^{\star}| \sfcos(\angle \bm{V}_i^{\star} -\angle \bm{V}_j^{\star})
}
\end{align}
が成り立つ。
ただし，$ i \in \mathcal{I}_{\rm G} $であり，有効電力と無効電力の定常値は
\begin{align*}%\label{eq:PQoutagcst}
\spliteq{
P_i^{\star}  &:=  \frac{E_i^{\star}  |\bm{V}_i^{\star} |}{X_{{\rm q}i}} 
\sfsin (\delta_i^{\star}  - \angle \bm{V}_i^{\star} ), \\
Q_i^{\star}  &:=  \frac{|\bm{V}_i^{\star} |E_i^{\star} }{X_{{\rm q}i}} 
\sfcos (\delta_i^{\star}  - \angle \bm{V}_i^{\star} )
-\frac{|\bm{V}_i^{\star} |^2}{X_{{\rm q}i} }
}
\end{align*}
である。
また，$y_{\mathds{G}_i}^{\star} = P_i^{\star}$である。
したがって，$ i \in \mathcal{I}_{\rm G} $に対して，
\begin{align*}
\frac{\partial U_{\mathds{G}}}{\partial \delta_i}(x^{\star}_{\mathds{G}}) = y_{\mathds{G}_i}^{\star}
,\qquad
\frac{\partial U_{\mathds{G}}}{\partial E_i}(x^{\star}_{\mathds{G}}) = 
\frac{V_{{\rm field}i}^{\star}  }{X_{{\rm d}i} - X_{{\rm q}i} }
\end{align*}
が成り立つ。
同様に，すべての$ i \in \mathcal{I}_{\rm L} $に対して
\begin{align}
\simode{
&P_{{\rm load}i}=
\sum_{j\neq i}^{N} B_{ij} |\bm{V}_i^{\star}| |\bm{V}_j^{\star}| \sfsin(\angle \bm{V}_i^{\star} -\angle \bm{V}_j^{\star}) 
\\
&Q_{{\rm load}i}
=
- B_{ii} |\bm{V}_i^{\star}|^2 -
\sum_{j\neq i}^{N} B_{ij} |\bm{V}_i^{\star}| |\bm{V}_j^{\star}| \sfcos(\angle \bm{V}_i^{\star} -\angle \bm{V}_j^{\star})
}
\end{align}
\end{subequations}
が成り立つことから，バスの電圧フェーザ変数に関する偏微分は，すべての$i\in \mathcal{I}_{\rm G} \cup \mathcal{I}_{\rm L}$に対して，
\begin{align*}
\frac{\partial U_{\mathds{G}}}{\partial |\bm{V}_i| }(x^{\star}_{\mathds{G}})= 0
,\qquad
\frac{\partial U_{\mathds{G}}}{\partial \angle \bm{V}_i } (x^{\star}_{\mathds{G}})= 0
\end{align*}
となる。
以上の計算結果より，蓄積関数の$\mathds{G}$の解軌道に沿った時間微分は
\begin{align}\label{eq:disineqGds}
\spliteq{
\frac{d}{dt}W_{x^{\star}_{\mathds{G}}} \bigl(x_{\mathds{G}}(t) \bigr)
& =
\nabla W_{x^{\star}_{\mathds{G}}}^{\sf T} \bigl(x_{\mathds{G}}(t) \bigr)
\dot{x}_{\mathds{G}}(t) \\
&=
\sum_{i\in \mathcal{I}_{\rm G}}
\left(
(u_{\mathds{G}_i}- u_{\mathds{G}_i}^{\star}) (y_{\mathds{G}_i}-y_{\mathds{G}_i}^{\star})
-
\frac{\tau_{{\rm d}i}}{X_{{\rm d}i} - X_{{\rm q}i} }
\dot{E}_i^2
\right)\\
& \leq 
(y_{\mathds{G}}-y_{\mathds{G}}^{\star})^{\sf T} (u_{\mathds{G}}- u_{\mathds{G}}^{\star})
}
\end{align}
と評価できる。
ただし，$u_{\mathds{G}}^{\star} = 0$であることを用いた。
このことから，式\ref{eq:stops}の関数$W_{x^{\star}_{\mathds{G}}}(x_{\mathds{G}})$が，電気サブシステム$\mathds{G}$の平衡点に依らない受動性に対する蓄積関数となることがわかる。
ただし，$x_{\mathds{G}}$や$x_{\mathds{G}}^{\star}$の領域は，$W_{x^{\star}_{\mathds{G}}}(x_{\mathds{G}})$が半正定値関数となる領域，すなわち，式\ref{eq:potWx}のポテンシャルエネルギー関数$U_{\mathds{G}}(x_{\mathds{G}})$が凸関数となる領域に限られることに注意されたい。


\subsection{周波数安定化制御系の安定性解析\advanced}\label{sec:potconv}

\subsubsection{受動性に基づく未知平衡点の安定性解析}

以下では，平衡点に依らない受動性を用いて，第\ref{sec:linmathana}節における近似線形モデルの受動性に基づく安定性解析とほぼ同様の手順により，自動発電制御が組み込まれたフィードバック制御系の安定性を解析する。
ただし，電気サブシステム$\mathds{G}$の解軌道$x_{\mathds{G}}(t)$に対して，式\ref{eq:stops}の蓄積関数の値$W_{x^{\star}_{\mathds{G}}}\bigl(x_{\mathds{G}}(t) \bigr)$が非負となることを仮定して議論を進める。
この点は次項で議論する。

式\ref{eq:disineqFp}と式\ref{eq:disineqGds}の不等式の和に対して，式\ref{eq:connds2}の結合の関係を用いると，フィードバック制御系全体に対して
%\begin{align}\label{eq:disineqall}
%\spliteq{
%& \frac{d}{dt}  \left\{
%W_{x^{\star}_{\mathds{F}}}  \bigl( x_{\mathds{F}}(t) \bigr) 
%+
%\omega_0
%W_{\xi^{\star}} \bigl( \xi(t) \bigr) 
%+
%W_{x^{\star}_{\mathds{G}}} \bigl(x_{\mathds{G}}(t) \bigr)
%\right\} \\
%& \hspace{3em} \leq 
%(y_{\mathds{F}}(t) -y^{\star}_{\mathds{F}})^{\sf T}
%(v_{\mathds{F}}(t) -v^{\star}_{\mathds{F}})  
%- \tfrac{\sfmin \left\{ D_i \right\}}{\omega_0}
%\|y_{\mathds{F}}(t) -y^{\star}_{\mathds{F}}\|^2
%}
%\end{align}
\[
 \frac{d}{dt}  \left\{
W_{x^{\star}_{\mathds{F}}}  \bigl( x_{\mathds{F}}(t) \bigr) 
+
\omega_0
W_{\xi^{\star}} \bigl( \xi(t) \bigr) 
+
W_{x^{\star}_{\mathds{G}}} \bigl(x_{\mathds{G}}(t) \bigr)
\right\} 
 \leq 
- \tfrac{\sfmin \left\{ D_i \right\}}{\omega_0}
\|y_{\mathds{F}}(t) -y^{\star}_{\mathds{F}}\|^2
\]
が得られる。
この不等式から蓄積関数の和は単調非増加であることがわかる。
また，その下限値は 0 であることから，時間が十分に経過するとその和はある値に漸近収束する。
すなわち，左辺の時間微分は0に漸近収束する。
したがって，
\[
\lim_{t\rightarrow \infty}
y_{\mathds{F}}(t) = y^{\star}_{\mathds{F}}
\]
が導かれる。
また，式\ref{eq:sys1}の出力方程式に注目すると，出力$y_{\mathds{F}}$は内部状態$\Delta \omega$の定数倍であることから，機械サブシステム$\mathds{F}$に対して，
\begin{align}\label{eq:Fobsnl}
y_{\mathds{F}}(t)  =y^{\star}_{\mathds{F}},\quad \forall t\geq 0 
\quad \Longrightarrow \quad
\Delta \omega(t)  =\frac{1}{\omega_0} y^{\star}_{\mathds{F}},\quad \forall t\geq 0 
\end{align}
が成り立つ。
さらに，第\ref{sec:phsync}節で解析したように，すべての発電機の周波数偏差は同じ値に収束する。
この事実は，ある定数$\gamma_0$に対して
\[
y^{\star}_{\mathds{F}} = \gamma_0 \mathds{1}
\]
であることを意味する。
一方で，式\ref{eq:Kdseq}の第1式から，
\[
0=h^{\sf T} u_{\mathds{K}}^{\star} 
= \frac{1}{\omega_0}h^{\sf T} y^{\star}_{\mathds{F}}
=\frac{\gamma_0}{\omega_0} h^{\sf T} \mathds{1}
\]
となる。
ここで，$h^{\sf T} \mathds{1}\neq 0$であることから，$\gamma_0=0$が得られる。
以上より，
\[
\lim_{t\rightarrow \infty}
\Delta \omega (t) = 0
\]
が示される。
また，すべての$i\in \mathcal{I}_{\rm G}$に対して，
\[
\lim_{t\rightarrow \infty}
P_{{\rm mech}i}(t) 
=
\lim_{t\rightarrow \infty} P_i (t)
\]
が成り立つこともわかる。
ただし，これらの収束値は，負荷の消費電力や送電線のインピーダンスなどが現実的には未知であるため，事前に計算することができない値である。
同様に，式(\ref{eq:sys2G})の電気サブシステム$\mathds{G}$の内部状態やバスの電圧フェーザ変数も未知の値に漸近収束する。


%式(\ref{eq:sys2G})の電気サブシステム$\mathds{G}$の平衡点に依らない受動性を解析する。
%以下では，$\mathds{G}$のすべての時間変数である$(\delta_i, E_i)_{i\in \mathcal{I}_{\rm G}}$と
%$(|\bm{V}_i|, \angle \bm{V}_i)_{i\in \mathcal{I}_{\rm G} \cup \mathcal{I}_{\rm L}}$を並べた列ベクトルを$x_{\mathds{G}}$と表す。
%
%
%なお，ここまでの議論の結果から，式(\ref{eq:connds})における入出力信号はそれらの定常値
%\[
%u_{\mathds{F}}^{\star} =0
%,\qquad
%y_{\mathds{F}}^{\star} =0
%,\qquad
%u_{\mathds{K}}^{\star} =0
%,\qquad
%y_{\mathds{K}}^{\star} =v_{\mathds{F}}^{\star}
%= -y_{\mathds{G}}^{\star}
%,\qquad
%u_{\mathds{G}}^{\star} =0
%\]
%に漸近収束することもわかる。

\subsubsection{ポテンシャルエネルギー関数が凸となる領域}

以下では，式\ref{eq:potWx}のポテンシャルエネルギー関数$U_{\mathds{G}}(x_{\mathds{G}})$が凸関数となるための条件が，第\ref{sec:linpasana}節の近似線形モデルの受動性解析で議論した受動送電条件(i)と(iii)に対応することを示す。
なお，本節の議論では，受動送電条件(ii)は仮定されている。

第\ref{sec:linpasana}節における近似線形モデルの設定に合わせて，すべてのバスに発電機が接続されている場合を考える
\footnote{
需要と供給がバランスする定常潮流状態においては，一部の発電機は電力を消費するモータとなる。
これは回転機の動特性をもつ負荷が接続されているものと解釈される。
}
。
すなわち，発電機バスと負荷バスの添字集合は
\[
\mathcal{I}_{\rm G} = \{1,\ldots,N\}
,\qquad
\mathcal{I}_{\rm L} = \emptyset
\]
である。
このとき，発電機バスのクロン縮約を適用することにより，式(\ref{eq:sys2G})の電気サブシステム$\mathds{G}$と等価な常微分方程式系が，$i \in \mathcal{I}_{\rm G}$に関する
\begin{align*}%\label{eq:kronGds}
\mathds{G}_i : 
\simode{
\dot{\delta}_i &= u_{\mathds{G}_i}
\\
\tau_{{\rm d}i} \dot{E}_i & = 
 -\frac{X_{{\rm d}i}}{X_{{\rm q}i}}E_i
 - \left(
X_{{\rm d}i} - X_{{\rm q}i}
\right)
\sum_{j=1}^{N}
E_j 
B_{ij}^{\rm red}
\sfcos \delta_{ij}
+ V_{{\rm field}i}^{\star}
\\
y_{\mathds{G}_i}&=  -E_i \sum_{j=1}^{N}
 E_j 
B_{ij}^{\rm red}
\sfsin \delta_{ij}
}
\end{align*}
と得られる。
ただし，$\delta_{ij}:= \delta_i -\delta_j$である。
また，縮約サセプタンス$B_{ij}^{\rm red}$は，式(\ref{eq:sys2G})の$B_{ij}$をまとめた送電網のサセプタンス行列を$B$と表すとき，
\[
B^{\rm red}
:= -
\bigl\{
\sfdiag \left( X_{{\rm q}_i} \right)   
-
\sfdiag \left( X_{{\rm q}_i} \right) B \sfdiag \left( X_{{\rm q}_i} \right)
\bigr\}^{-1}
\]
の第$(i,j)$要素として定義される
\footnote{
この縮約サセプタンス行列$B^{\rm red}$のすべての要素は非正である。
この事実は，以下のように示される。
第\ref{sec:admathp}節の議論から，サセプタンス行列$B$は非対角要素が非負の負定行列である。
したがって，
\[
B_{-}:= \sfdiag \left( X_{{\rm q}_i} \right)   
-
\sfdiag \left( X_{{\rm q}_i} \right) B \sfdiag \left( X_{{\rm q}_i} \right)
\]
は非対角要素が非正の正定行列である。
このような行列は，\textbf{M行列}（M-matrix）と呼ばれる。
また，その逆行列の要素はすべて非負であることが知られている\cite{kodama1981system}。
したがって，$B^{\rm red}=-B_-^{-1}$のすべての要素は非正となる。
}
。
この常微分方程式系表現に対応する式\ref{eq:potWx}のポテンシャルエネルギー関数は
\begin{align}\label{eq:potWxred}
U_{\mathds{G}}^{\rm red} (z_{\mathds{G}})  := 
 \frac{1}{2} 
\sum_{i=1}^N
\left\{
\frac{X_{{\rm d}i} E_i^2 }{X_{{\rm q}i}(X_{{\rm d}i} - X_{{\rm q}i} )}  
+ E_i \sum_{j=1}^{N}
 E_j 
B_{ij}^{\rm red}
\sfcos \delta_{ij}
\right\}
\end{align}
となる。
ただし，すべての$\delta_i$と$E_i$を並べたベクトルを$z_{\mathds{G}}$と表している。
内部状態に関する偏微分を計算すると
\begin{align*}
\frac{\partial U_{\mathds{G}}^{\rm red} }{\partial \delta_i}(z_{\mathds{G}})  = y_{\mathds{G}_i}
,\qquad
\frac{\partial U_{\mathds{G}}^{\rm red} }{\partial E_i} (z_{\mathds{G}}) = 
\frac{V_{{\rm field}i}^{\star} - \tau_{{\rm d}i}\dot{E}_i  }{X_{{\rm d}i} - X_{{\rm q}i} }
\end{align*}
が得られる。
同様に，定常状態に対して
\begin{align*}
\frac{\partial U_{\mathds{G}}^{\rm red} }{\partial \delta_i} ( z^{\star}_{\mathds{G}} )
= y_{\mathds{G}_i}^{\star}
,\qquad
\frac{\partial U_{\mathds{G}}^{\rm red} }{\partial E_i} ( z^{\star}_{\mathds{G}} ) = 
\frac{V_{{\rm field}i}^{\star}  }{X_{{\rm d}i} - X_{{\rm q}i} }
\end{align*}
となる。
したがって，対応する蓄積関数を
\[
W_{z^{\star}_{\mathds{G}}}^{\rm red} (z_{\mathds{G}}) = U_{\mathds{G}}^{\rm red} (z_{\mathds{G}}) 
- U_{\mathds{G}}^{\rm red} (z^{\star}_{\mathds{G}}) 
- \left\{ \nabla U_{\mathds{G}}^{\rm red}(z^{\star}_{\mathds{G}}) \right\}^{\sf T}
 (z_{\mathds{G}}-z^{\star}_{\mathds{G}})
\]
と定義すれば，式\ref{eq:disineqGds}と同様に，その時間微分は
\[
\frac{d}{dt}W_{z^{\star}_{\mathds{G}}}^{\rm red} \bigl(z_{\mathds{G}}(t) \bigr)
 \leq 
(y_{\mathds{G}}-y_{\mathds{G}}^{\star})^{\sf T} (u_{\mathds{G}}- u_{\mathds{G}}^{\star})
\]
と評価できる。


式\ref{eq:potWxred}のポテンシャルエネルギー関数$U_{\mathds{G}}^{\rm red} (z_{\mathds{G}})$が凸関数であることは，ヘッセ行列$\nabla^2 U_{\mathds{G}}^{\rm red} (z_{\mathds{G}})$が半正定行列であることにより特徴づけられる
\footnote{
2階微分可能な関数$f:\mathbb{R}^n\rightarrow \mathbb{R}$が，ある領域$\mathcal{X}$において凸関数であるための必要十分条件は，すべての$x\in \mathcal{X}$に対して
\[
\nabla^2 f(x):=
\mat{
\tfrac{\partial^2 f}{\partial x_1^2} (x) & \cdots & \tfrac{\partial^2 f}{\partial x_1 \partial x_n} (x) \\
\vdots & \ddots & \vdots \\
\tfrac{\partial^2 f}{\partial x_n \partial x_1} (x) & \cdots &\tfrac{\partial^2 f}{\partial x_n^2} (x)
}
\]
が半正定となることである。
この行列は，関数$f$の\textbf{ヘッセ行列}（Hessian matrix）と呼ばれる\cite{boyd2004convex}。
}
。
そのヘッセ行列を計算すると
\begin{align}\label{eq:UGhess}
\nabla^2 U_{\mathds{G}}^{\rm red} (z_{\mathds{G}})
=
\mat{
L(z_{\mathds{G}})  &  - \hat{B}^{\sf T}(z_{\mathds{G}}) \\
- \hat{B}(z_{\mathds{G}}) & -\hat{A}(z_{\mathds{G}})
}
\end{align}
となる。
ただし，各ブロックを構成する行列は，第$(i,j)$要素に
\begin{align*}
\spliteq{
L_{ij}(z_{\mathds{G}}) & := 
\frac{\partial^2 U_{\mathds{G}}^{\rm red} }{\partial \delta_i \partial \delta_j} (z_{\mathds{G}})
=
\left\{
\begin{array}{cl}
-E_i \sum_{j=1, j\neq i}^{N} E_j B_{ij}^{\rm red} \sfcos(\delta_{ij}), &\quad i=j \\
E_i  E_j B_{ij}^{\rm red} \sfcos(\delta_{ij}), & \quad i\neq j
\end{array}
\right.
  \\
\hat{A}_{ij}(z_{\mathds{G}}) &:=  
- \frac{\partial^2 U_{\mathds{G}}^{\rm red} }{\partial E_i \partial E_j} (z_{\mathds{G}})
=
\left\{
\begin{array}{cl}
B_{ii}^{\rm red}+\tfrac{X_{{\rm d}i} }{X_{{\rm q}i}(X_{{\rm d}i} - X_{{\rm q}i} )} , &\quad i=j \\
B_{ij}^{\rm red} \sfcos(\delta_{ij}), & \quad i\neq j
\end{array}
\right. \\
\hat{B}_{ij}(z_{\mathds{G}})  &:= 
- \frac{\partial^2 U_{\mathds{G}}^{\rm red} }{\partial E_i \partial \delta_j} (z_{\mathds{G}})
=
\left\{
\begin{array}{cl}
\sum_{j=1, j\neq i}^{N} E_j B_{ij}^{\rm red} \sfsin(\delta_{ij}), &\quad i=j \\
-E_j B_{ij}^{\rm red} \sfsin(\delta_{ij}), & \quad i\neq j
\end{array}
\right. 
}
\end{align*}
をもつ行列である。
式\ref{eq:UGhess}のヘッセ行列を平衡点で評価した$\nabla^2 U_{\mathds{G}}^{\rm red} (z_{\mathds{G}}^{\star})$は，第\ref{sec:linpasana}節の近似線形化された電気サブシステムの受動性解析において現れた，式\ref{eq:defPG}の行列$P_G$と同一である。
なお，この$P_G$の半正定性は，$\mathds{G}$の近似線形モデルの受動性を示すための蓄積関数が半正定値関数となることを保証するものであった。
以上より，$U_{\mathds{G}}^{\rm red} (z_{\mathds{G}}^{\star})$が凸関数となるための必要十分条件は，$P_G$が半正定となるための必要十分条件に等しく，それは受動送電条件(i)と(iii)が成り立つことに等しいことがわかる。


第\ref{sec:linmathana}節の結果と組み合わせて考えると，式\ref{eq:potWxred}のポテンシャルエネルギー関数$U_{\mathds{G}}^{\rm red} (z_{\mathds{G}})$が凸関数となる領域として定義される
\[
\mathcal{E}_{\mathds{G}}:=
\left\{
z_{\mathds{G}}^{\star} : \nabla^2 U_{\mathds{G}}^{\rm red} (z_{\mathds{G}}^{\star}) 
\succeq 0
\right\}
\]
が，受動性に基づいて周波数安定性を示すことが可能な「最大」の平衡点集合であることもわかる。
その理由は，第\ref{sec:nesconana}節で示されているように，受動送電条件は，特定の平衡点の近傍で近似線形化された電気サブシステムが受動的となる必要条件でもあるためである。
すなわち，$\nabla^2 U_{\mathds{G}}^{\rm red} (z_{\mathds{G}}^{\star}) $が半正定ではない平衡点$z_{\mathds{G}}^{\star}$に関して，電気サブシステム$\mathds{G}$は受動的とはならない。

逆に，集合$\mathcal{E}_{\mathds{G}}$に属するある平衡点$z_{\mathds{G}}^{\star}$の近傍に電気サブシステム初期値$z_{\mathds{G}}(0)$を設定するならば
\footnote{
例えば，需給がバランスした定常潮流状態から，ある負荷の消費電力がステップ状に微小変動した場合を考える。
このとき，もとの定常潮流状態から新しい定常潮流状態に電気サブシステム$\mathds{G}$の平衡点が微小変動するため，消費電力が変化した時刻を初期時刻と考えれば，$\mathds{G}$の初期値が平衡点の近傍に設定された状況として解釈できる。
}
，すべての物理パラメータ$(M_i,D_i,\tau_i)_{i \in \mathcal{I}_{\rm G}}$の組み合わせに対して，フィードバック制御系全体は，需要と供給がバランスする定常潮流状態に漸近収束する。
以上の解析結果から，負荷などのモデルパラメータやコントローラパラメータの時間変化が十分に緩やかであり，ポテンシャルエネルギー関数が凸関数となる領域に電力系統の状態が留まる限りは，自動発電制御により周波数安定性が維持されることが結論づけられる。


\section{同期安定化制御}
\subsection{系統安定化装置と自動電圧調整器}
\subsection{同期安定化制御の数値シミュレーション}
\subsection{レトロフィット制御理論に基づく同期安定化制御\advanced}


\newpage
%\printindex
%
%
\end{document}