\documentclass[tombow,dvipdfmx]{corona-a5-1.1}
% dvipdfmxを追加（川口）

\input{../settings}

\begin{document}


\chapter{電力系統モデルの定態安定性解析}\label{sec:staana}

本章では，電力系統モデルの近似線形化に基づく安定性解析を行う
\footnote{
近似線形システムの導出はつぎのような操作である。
非線形システム
\begin{align*}
\dot{x}(t) = f\bigl(x(t)\bigr) + Bu(t) 
\end{align*}
を考える。
ただし，$f(0)=0$とする。
関数$f(x)$は原点近傍のテーラー展開により
\[
f(x)=f(0) + \frac{\partial f}{\partial x} (0) x + \mbox{2次以上の項}
\]
と表される。
ここで，$f(x)$と$x$の第$i$要素を$f_i(x)$と$x_i$として，$\tfrac{\partial f}{\partial x}(x)$は$\tfrac{\partial f_i}{\partial x_j}(x)$を第$(i,j)$要素にもつ\emph{ヤコビ行列}（Jacobian matrix）である。
このヤコビ行列を用いて
\[
A:=\frac{\partial f}{\partial x} (0)
\]
と定義すれば，状態$x(t)$や入力$u(t)$の大きさが十分に小さいとき，非線形システムの挙動は，関数$f$の2次以上の項を無視して得られる線形システム
\begin{align*}
\dot{x}^{\rm lin}(t) = Ax^{\rm lin}(t) + Bu^{\rm lin}(t) 
\end{align*}
の挙動として近似できる。 
ただし，$u(t)$と$u^{\rm lin}(t)$が等しくても，非線形システムの$x(t)$と近似線形システムの$x^{\rm lin}(t)$は厳密には一致しないことに注意されたい。
}。
%ここでは，発電機に対する外部入力は，適当な定常潮流状態を実現する定数に設定されていることを前提とする。
本章の構成は以下の通りである。
まず，\ref{sec:stalin}節では，発電機母線のクロン縮約により常微分方程式系で記述された電力系統モデルに対して，近似線形モデルの導出を行う。
つぎに，\ref{sec:numlinsta}節では，導出された近似線形モデルの安定性を数値的に解析する手法を説明する。
また，発電機や負荷，送電網の物理的な定数だけでなく，基準とする定常潮流状態の選び方によって，得られる近似線形モデルの安定性が変化することを数値シミュレーションにより確認する。
さらに，\ref{sec:linmathana}節では発展的な話題として，動的システムの受動性の概念を用いて近似線形モデルの安定性が解析できることを明らかにする。



\section{近似線形化に基づく安定性解析}\label{sec:stalin}

\subsection{電力系統モデルの近似線形化}\label{sec:linaproxt}

本節では，\ref{sec:allgen}節で議論した発電機母線がクロン縮約された等価な常微分方程式系モデル，すなわち，各々すべての母線に発電機が接続された電力系統モデルに対して，定常的な潮流状態における近似線形モデルを導出する。
常微分方程式系モデルは
\begin{align}\label{eq:krondyn_}
\simode{
\dot{\delta}_i&= \omega_0  \Delta \omega_i\\
M_i   \Delta \dot{\omega}_i&= %\textstyle
 - D_i \Delta\omega_i   
 - f_i \left( \delta,E \right)
+P_{{\rm mech}i}
\\
\taudi \dot{E}_i & = %\textstyle
 -  \tfrac{ \Xsi }{ \Xti }  E_i  + \left(
\Xsi - \Xti
\right)
g_i \left( \delta,E \right)
+ V_{{\rm field}i}
}
\qquad
i \in \mathcal{I}_{\rm G}
\end{align}
と得られていた。
ただし，$\delta$と$E$はそれぞれ，$\delta_i$と$E_i$を縦に並べたベクトルであり，発電機間の相互作用を表す非線形項を
\begin{align}\label{eq:figi}
\spliteq{
f_i \left( \delta,E \right) &:=
-E_i \sum_{j=1}^{N}
 E_j 
\bigl(
B_{ij}^{\rm red}
\sfsin \delta_{ij}
-
G_{ij}^{\rm red}
\sfcos \delta_{ij}
\bigr), \\
g_i \left( \delta,E \right) &:=
-
\sum_{j=1}^{N}
E_j \bigl(
B_{ij}^{\rm red}
\sfcos \delta_{ij}
+
G_{ij}^{\rm red}
\sfsin \delta_{ij}
\bigr)
}
\end{align}
と表している。
また，
$\delta_{ij}:= \delta_i - \delta_j$と定義した。
なお，縮約アドミタンスの性質から，縮約コンダクタンスと縮約サセプタンスは，対称性の条件として
\[
G_{ij}^{\rm red}=G_{ji}^{\rm red}, \qquad 
B_{ij}^{\rm red}=B_{ji}^{\rm red}, \qquad
\forall (i, j) \in \mathcal{I}_{\rm G} \times \mathcal{I}_{\rm G}
\]
を満たすことに注意されたい。
これらの非線形関数の各変数に関する偏微分を求めるために
\begin{align}\label{eq:defkh}
\spliteq{
k_{ij}(\delta_{ij}) & :=
-B_{ij}^{\rm red}
\sfcos \delta_{ij}
-
G_{ij}^{\rm red}
\sfsin \delta_{ij},
\\
h_{ij}(\delta_{ij}) &:= 
-B_{ij}^{\rm red}
\sfsin \delta_{ij} 
+
G_{ij}^{\rm red}
\sfcos \delta_{ij}
}
\end{align}
を定義する。
このとき，$f_i$に対して
\begin{align}
\spliteq{
\frac{\partial f_i}{\partial \delta_i} &= 
E_i \sum_{j=1,j\neq i}^{N} E_j k_{ij}(\delta_{ij}), \\
\frac{\partial f_i}{\partial \delta_j} &=
- E_i  E_j k_{ij}(\delta_{ij}),
}
\quad
\spliteq{
\frac{\partial f_i}{\partial E_i} &=
2E_i h_{ii}(\delta_{ii})   +
 \sum_{j=1,j\neq i}^{N}
 E_j h_{ij}(\delta_{ij}), \\
 \frac{\partial f_i}{\partial E_j} &=
 E_i h_{ij}(\delta_{ij})
 }
\end{align}
が得られる。
ただし，$j \neq i$とする。
同様に，$g_i$に対して
\begin{align}
\spliteq{
\frac{\partial g_i}{\partial \delta_i} &= 
- \sum_{j=1,j\neq i}^{N} E_j h_{ij}(\delta_{ij}), 
\\
\frac{\partial g_i}{\partial \delta_j} &=
E_j h_{ij}(\delta_{ij}),
}
\quad
\spliteq{
\frac{\partial g_i}{\partial E_i} &=
k_{ii}(\delta_{ii}) , 
\\
 \frac{\partial g_i}{\partial E_j} &=
k_{ij}(\delta_{ij})
}
\end{align}
が得られる。

式\ref{eq:krondyn_}の微分方程式系に対して，発電機$i$の内部状態の定常値を$(\delta_{i}^{\star},E^{\star}_i)$と表し，外部入力の定常値を$(P_{{\rm mech}i}^{\star},V_{{\rm field}i}^{\star})$
と表す。
また，すべての$i \in \mathcal{I}_{\rm G}$に対してそれらの値を並べたベクトルを添え字$i$を除いた記号で表す。
例えば，$\delta^{\star}$は$(\delta_i^{\star})_{i \in \mathcal{I}_{\rm G} }$を表す。
これらの定常値に対して，連立方程式
\begin{align}\label{eq:kronss}
\simode{
0 &= %\textstyle
 - f_i \left( \delta^{\star} , E^{\star}  \right)
+P_{{\rm mech}i}^{\star}
\\
0& = %\textstyle
 -  \tfrac{ \Xsi }{ \Xti }  E_i^{\star}  + \left(
\Xsi - \Xti
\right)
g_i \left( \delta^{\star} ,E^{\star} \right)
+ V_{{\rm field}i}^{\star}
}
\qquad
i \in \mathcal{I}_{\rm G}
\end{align}
が成り立つものとする。
ここで，式\ref{eq:krondyn_}における角周波数偏差$\Delta \omega_i$の定常値は，すべての$i \in \mathcal{I}_{\rm G}$に対して0であることを仮定していることに注意されたい。
式\ref{eq:kronss}が成り立つことは，発電機群に対する外部入力の定常値
$(P_{{\rm mech}}^{\star},V_{{\rm field}}^{\star})$
が，需給バランスが達成される適切な値に設定されていることに相当する。
この定常状態を基準として近似線形化を行うと，近似線形モデルが
\begin{align}\label{eq:lindyn}
\mat{
\dot{\delta}^{\rm lin} \\
M \Delta \dot{\omega}^{\rm lin} \\
\taud \dot{E}^{\rm lin}
}
 =
\mat{
0 & \omega_0 I & 0\\
 -L & -D & -C \\
 B & 0 & A
 }
\mat{
\delta^{\rm lin} \\
\Delta \omega^{\rm lin} \\
 E^{\rm lin}
}
+
\mat{
0 & 0 \\
I & 0 \\
0 & I \\
}
\mat{
P_{{\rm mech}}^{\rm lin} \\
V_{{\rm field}}^{\rm lin}
}
\end{align}
と得られる。
ただし，添字「$\rm{lin}$」がつけられた状態変数および入力変数は，対応する変数の定常値を基準とした微小偏差を並べたベクトルである。
また
\[
M:=\sfdiag \left(M_i\right)_{i \in \mathcal{I}_{\rm G} }, \qquad
D:=\sfdiag(D_i)_{i \in \mathcal{I}_{\rm G} }, \qquad
\taud :=\sfdiag \left( \taudi \right)_{i \in \mathcal{I}_{\rm G} }
\]
である。
さらに，式\ref{eq:defkh}の関数$k_{ij}$および$h_{ij}$に対して，第$(i,j)$要素に
\begin{align*}
\spliteq{
\hat{L}_{ij} & := \left\{
\begin{array}{cl}
E_i^{\star} \sum_{j=1, j\neq i}^{N} 
E_j^{\star} k_{ij}(\delta_{ij}^{\star}), & \quad i=j \\
-E_i^{\star} E_j^{\star} k_{ij}(\delta_{ij}^{\star}), & \quad i\neq j
\end{array}
\right.  \\
\hat{A}_{ij} &:=  
\left\{
\begin{array}{cl}
k_{ii}(\delta_{ii}^{\star}) - 
\tfrac{ \Xsi }{ \Xti ( \Xsi- \Xti )}, & \quad i=j \\
k_{ij}(\delta_{ij}^{\star}), & \quad i\neq j
\end{array}
\right.
\\
\hat{B}_{ij}  &:= \left\{
\begin{array}{cl}
-\sum_{j=1, j\neq i}^{N} 
E_j^{\star} h_{ij}(\delta_{ij}^{\star}), &\quad i=j \\
E_j^{\star} h_{ij}(\delta_{ij}^{\star}), & \quad i\neq j
\end{array}
\right. \\
\hat{C}_{ij} &:= \left\{
\begin{array}{cl}
\sum_{j=1, j\neq i}^{N} 
E_j^{\star} h_{ij}(\delta_{ij}^{\star}), & \quad i=j \\
E_i^{\star} h_{ij}(\delta_{ij}^{\star}), & \quad i\neq j
\end{array}
\right.
}
\end{align*}
をもつ行列を$\hat{L}$，$\hat{A}$，$\hat{B}$，$\hat{C}$とするとき，行列$L$，$A$，$B$，$C$は
\begin{align}\label{eq:sysmats}
\spliteq{
L&:=\hat{L}, \\
A&:= \sfdiag \left( \Xsi - \Xti \right)_{i \in \mathcal{I}_{\rm G} } \hat{A},  \\
B&:= \sfdiag \left( \Xsi - \Xti \right)_{i \in \mathcal{I}_{\rm G} } \hat{B},  \\
C&:= \sfdiag \bigl( 2E_i^{\star}h_{ii}(\delta_{ii}^{\star}) \bigr)_{i \in \mathcal{I}_{\rm G} }+ \hat{C} 
}
\end{align}
で定義される。
ただし，$\delta_{ij}^{\star}:=\delta_{i}^{\star}-\delta_{j}^{\star}$とする。
このシステム行列$(L,A,B,C)$は，定常値$(\delta^{\star},E^{\star})$の関数であることに注意されたい。
この近似線形モデルのブロック線図を\FIGref{fig:blocklinsys}に示す。
ここで，$P^{\rm lin}$は発電機群が供給する近似線形化された有効電力を表す
\footnote{
電力系統工学では，定常値において発電機の有効電力を回転子偏角で偏微分した値を\textbf{同期化力係数}（synchronizing power coefficient）と呼ぶ\cite[8.4節]{kato2017electric}。
すなわち，式\ref{eq:lindyn}の近似線形モデルにおける行列$L$が同期化力係数に相当する。
ただし，電力系統工学では，\ref{sec:onemachine}節で説明された1機無限大母線系統モデルを用いて定義することが一般的であるため，同期化力係数は行列ではなくスカラー値となる。
}。
なお，すべての$i$に対して，一般に$\Xsi > \Xti$である。

\begin{figure}[t]
\centering
\includegraphics[width = .8\linewidth]{figs/blocklinsys3}
\medskip
\caption{\textbf{近似線形モデルのブロック線図}}
\label{fig:blocklinsys}
\medskip
\end{figure}

\subsection{近似線形モデルの安定性判別}

\smallskip
\subsubsection{近似線形モデルの安定性}

本節では，近似線形モデルの安定性を数値的に解析することを考える。
式\ref{eq:lindyn}の近似線形モデルが安定であるか否かは，電力系統に微小な外乱が生じた場合に，
式\ref{eq:kronss}の連立方程式を満たす定常状態に向けて，発電機群の内部状態が復するか否かを特徴づける。
外乱の例として，発電機の機械入力や界磁電圧，負荷のインピーダンス値，送電線の電流値や電圧値などが，定常状態における基準値から一時的に微小変動することが挙げられる。
電力系統工学では，このような微小変動に対する安定性は，\textbf{定態安定性}（small signal stability）と呼ばれる。


式\ref{eq:lindyn}の近似線形モデルの安定性は，
発電機群の内部状態の定常値
$(\delta^{\star},E^{\star})$
と外部入力の定常値
$(P_{{\rm mech}}^{\star},V_{{\rm field}}^{\star})$
の選び方によって変化することに注意されたい。
また，送電線のアドミタンスや負荷のインピーダンスの変化は，式\ref{eq:defkh}の縮約コンダクタンス$G^{\rm red}_{ij}$と縮約サセプタンス$B^{\rm red}_{ij}$を変化させる。
したがって，近似線形モデルの安定性は，上記の様々なモデルパラメータに依存して変化する。
本節の目的は，それらのモデルパラメータの変化と近似線形モデルの安定性の関係を数値的に考察することである。

\smallskip
\subsubsection{システム行列の固有値による安定性の判別}

式\ref{eq:lindyn}の近似線形モデルに対して，内部状態の定常値$(\delta^{\star},E^{\star})$をパラメータとして適当に定めれば，式\ref{eq:sysmats}のシステム行列$(L,A,B,C)$，および，
式\ref{eq:kronss}の方程式を満たす外部入力の定常値
$(P_{{\rm mech}}^{\star},V_{{\rm field}}^{\star})$は従属的に定まる。
以下では，式\ref{eq:krondyn_}の非線形の微分方程式系モデルにおいて，すべての$i \in \mathcal{I}_{\rm G}$に対して
\[
P_{{\rm mech}i}(t)=P_{{\rm mech}i}^{\star},\qquad
V_{{\rm field}i}(t)
=
V_{{\rm field}i}^{\star},\qquad 
\forall t\geq 0
\]
と設定することを考える。
これは，式\ref{eq:lindyn}の近似線形モデルにおいて
\[
P_{{\rm mech}}^{\rm lin}(t)
=0,\qquad
V_{{\rm field}}^{\rm lin}(t)
=0
,\qquad 
\forall t\geq 0
\]
と設定することを意味する。
以下では，この前提のもとで，入力を恒等的に0と仮定した自律的な近似線形モデル
\begin{align}\label{eq:lindynu0}
\mat{
\dot{\delta}^{\rm lin} \\
 \Delta \dot{\omega}^{\rm lin} \\
 \dot{E}^{\rm lin}
}
 =
\underbrace{
\mat{
0 & \omega_0 I & 0\\
 -M^{-1}L & -M^{-1}D & -M^{-1}C \\
\taud^{-1} B & 0 & \taud^{-1} A
 }
}_{\Psi}
\mat{
\delta^{\rm lin} \\
\Delta \omega^{\rm lin} \\
 E^{\rm lin}
}
\end{align}
の安定性を解析する。
具体的には，行列$\Psi$の固有値の実部の符号を調べることによって，この近似線形モデルの安定性を判別する。
ただし，$\Psi$は一般に零固有値を1つもつことに注意されたい。
実際，式\ref{eq:sysmats}の行列$L$，$B$の構造から
\begin{align}\label{eq:LBker}
L  \mathds{1} = 0
,\qquad
 B  \mathds{1} =0
\end{align}
が成り立つ。
したがって，いかなるモデルパラメータに対しても
\[
\Psi v=0 ,\qquad
v:=\mat{
\mathds{1} \\
0 \\
0
}
\]
が成り立つ。
これは$v$が$\Psi$の零固有値に対する固有ベクトルであることを意味する。
この零固有値を除くすべての固有値の実部が負であれば，任意の初期値に対して，式\ref{eq:lindynu0}の解軌道は
\begin{align}\label{eq:linmconv}
\lim_{t\rightarrow \infty}\delta^{\rm lin}(t)= c_0  \mathds{1},\qquad
\lim_{t\rightarrow \infty}\Delta \omega^{\rm lin}(t)=0 ,\qquad
\lim_{t\rightarrow \infty} E^{\rm lin}(t)=0
\end{align}
を満たす。
ただし，$c_0$は初期値によって定まる定数である。

なお，$c_0$はどのような値であっても解析の結果に本質的な違いはない。
その理由は，式\ref{eq:krondyn_}の微分方程式系モデルにおいて，発電機の回転子偏角$\delta_i$は，他の発電機の回転子偏角$\delta_j$との差のみが意味をもつためである。
具体的には，ある$(P_{{\rm mech}}^{\star},V_{{\rm field}}^{\star})$に対して，$(\delta^{\star},E^{\star})$が式\ref{eq:kronss}の連立方程式を満たすならば，$(\delta^{\star}+c_0 \mathds{1},E^{\star})$も同じ連立方程式を満たす。
すなわち，$\delta^{\star}$と$\delta^{\star}+c_0 \mathds{1}$は，すべての発電機の回転子偏角を等しく$c_0$だけ回転させた本質的に等価な定常値である。
式\ref{eq:linmconv}は，これらの本質的に等価な定常値に対する解軌道の漸近的な収束を意味している。


\section{数値計算による近似線形モデルの安定性解析}\label{sec:numlinsta}

\subsection{分割したモジュール群を用いた近似線形化の実装法}

本節では，近似線形モデルを数値的に得るための実装法を説明する。
具体的には，\ref{sec:powfcal}や\ref{sec:timerescal}節で説明したモジュール群に分割されたプログラムに，近似線形化の機能を追加する方法を解説する。

\ref{sec:timerescal}節で作成した電力系統の数値シミュレーションのプログラムでは，
各機器について，状態に関する微分方程式と出力に関する代数方程式として
\[
\dot{x}_i = f_i(x_i, \bm V_i, \bm I_i, u_i)
,\qquad
0 = g_i(x_i, \bm V_i, \bm I_i, u_i)
\]
%\begin{equation}
%  \dot{x}_i = f_i(x_i, \bm V_i, \bm I_i, u_i)
%\end{equation}
%と出力に関する制約条件
%\begin{equation}
%0 = g_i(x_i, \bm V_i, \bm I_i, u_i)
%\end{equation}
が実装されている。
%\begin{comment}
%そして，これらの式と系統全体に関する方程式
%\begin{equation}
%\bm I = \bm Y\bm V
%\end{equation}
%を連立することによって時間応答のシミュレーションを行う。
%\end{comment}
以下では，注目する機器の平衡点を$(x_i^\star, \bm V_i^\star, \bm I_i^\star,  u_i^\star)$として，その近傍における近似線形モデルを導出する。
具体的には，関数$f_i$，$g_i$に対する近似線形化として
\begin{align}
  f_i(x_i, \bm V_i, \bm I_i) &\approx A_i (x_i-x_i^\star) + B_{u_i}u_i\notag\\
  &+ B_{\bm{V}_i}\mat{
    \real[\bm V_i-\bm V^\star]\\ \imag[\bm V_i-\bm V^\star]
  }
  + 
  B_{\bm{I}_i} \mat{
    \real[\bm I_i-\bm I_i^\star]\\\imag[\bm I_i-\bm I_i^\star]
  }\label{eq:f_lin}\\
  g_i(x_i, \bm V_i, \bm I_i) &\approx C_i (x_i-x_i^\star) + D_{u_i}u_i\notag\\
  &+ 
  D_{\bm{V}_i}  \mat{
    \real[\bm V_i-\bm V^\star]\\ \imag[\bm V_i-\bm V^\star]
  }
  + D_{\bm{I}_i}  \mat{
    \real[\bm I_i-\bm I_i^\star]\\\imag[\bm I_i-\bm I_i^\star]\label{eq:g_lin}
  }
\end{align}
を考える。
すべての機器に関する連立方程式と電力系統全体の代数方程式
\[
\bm I_i - \bm I_i^\star = \sum_{j=1}^N \bm Y_{ij} (\bm{V}_j -\bm V^\star_j )
,\qquad
i \in \{1,\ldots,N\}
\]
%\begin{align*}
%\bm I-\bm I^\star = \bm Y (\bm V-\bm V^\star)
%\end{align*}
を用いて，$\bm V_i -\bm V^\star_i$や$\bm I_i-\bm I_i^\star$を消去することにより，近似線形モデルの常微分方程式系による表現が得られる。
ただし，$\bm{Y}_{ij}$はアドミタンス行列$\bm{Y}$の第$(i,j)$要素を表す。
つぎの例では，具体的な実装法を確認してみよう。

\begin{例}[近似線形モデルの実装]
式\ref{eq:f_lin}や式\ref{eq:g_lin}は機器の動特性に依存するため，
$A_i$や$B_{u_i}$などの係数行列の計算は，\ref{sec:powfcal}節の実装例における発電機や負荷などの機器のクラスに実装されるのが自然である。
例えば，発電機モデルでは
\begin{flalign*}
&\quad
A_i = \mat{
0 & \omega_0 & 0\\
0 & -\tfrac{D_i}{M_i} & 0\\
- \tfrac{1}{\tau_i}( \tfrac{X_i}{X_i'}-1)|\bm V_i^\star|\sfsin(\delta_i^\star-\angle\bm V_i^\star) &
0& - \tfrac{X_i}{\tau_i X'_i}
}
&
\end{flalign*}
\begin{flalign*}
&\quad
B_{u_i} = \mat{
  0 \\ \tfrac{1}{M_i} \\ 0
}
,\qquad
B_{\bm{V}_i} = \mat{
  0 & 0\\ - \tfrac{\real [ \bm{I}_i^\star] }{M_i}  & - \tfrac{\imag[ \bm{I}_i^\star] }{M_i}\\
 \tfrac{1}{\tau_i}( \tfrac{X_i}{X_i'}-1) \sfcos \delta_i^\star& \tfrac{1}{\tau_i}( \tfrac{X_i}{X_i'}-1) \sfsin\delta_i^\star
}
&
\end{flalign*}
\begin{flalign*}
&\quad
B_{\bm{I}_i} = \mat{
  0 & 0\\ -\tfrac{\real [ \bm{V}_i^\star] }{M_i} & -\tfrac{\imag [ \bm{V}_i^\star] }{M_i}\\
0 & 0 
}
,\qquad
C_i = \mat{
E_i^\star\sfcos\delta^\star_i & 0 & \sfsin(\delta_i^\star)\\
E_i^\star\sfsin\delta^\star_i & 0 & -\sfcos(\delta_i^\star)\\
}
&
\end{flalign*}
\begin{flalign*}
&\quad
D_{u_i} = 0
,\qquad
D_{\bm{V}_i} = \mat{
  0 & -1\\ 1 & 0
}
,\qquad
\red{
D_{\bm{I}_i} =  \begin{bmatrix}
  -X_i' & 0\\0 & -X_i'
\end{bmatrix}
}
&
\end{flalign*}
%
%\red{---}
%\begin{align*}
%A_i &= \mat{
%0 & \omega_0 & 0\\
%0 & -\tfrac{D_i}{M_i} & 0\\
%- \tfrac{1}{\tau_i}( \tfrac{X_i}{X_i'}-1)|\bm V_i^\star|\sfsin(\delta_i^\star-\angle\bm V_i^\star) &
%0& - \tfrac{X_i}{\tau_i X'_i}
%}\\
%B_{u_i} &= \mat{
%  0 & 1/M_i & 0
%}^\tr\\
%B_{V,i} &= \mat{
%  0 & 0\\ -\real[I_i^\star]/M & -\imag[I_i^\star]/M\\
%  (X_i/X_i'-1)\sfcos\delta_i^\star/\tau_i&(X_i/X_i'-1)\sfsin\delta_i^\star/\tau_i
%}\\
%B_{I,i} &= \mat{
%  0 & 0\\ -\real[V_i^\star]/M & -\imag[V_i^\star]/M\\
%0 & 0 
%}\\
%C_i &= \mat{
%E_i^\star\sfcos\delta^\star & 0 & \sfsin(\delta_i^\star)\\
%E_i^\star\sfsin\delta^\star & 0 & -\sfcos(\delta_i^\star)\\
%}\\
%D_{u, i} &= 0\\
%D_{V,i} &= \mat{
%  0 & -1\\ 1 & 0
%}\\
%D_{I,i} &=  -X_i'I
%\end{align*}
となる。\red{（$I$は単位行列の意味ですか？）}
これらの係数行列を計算する
\verb|get_linear_matrix|というメソッドを\verb|generator|
クラスに追加すると，プログラム\ref{program:generator_matrix}
となる。

\smallskip
\begin{PROGRAMA}[count,title={generator.m}]\label{program:generator_matrix}
\begin{verbatim}
classdef generator < handle
  
  properties
（プログラム3-23の4行目から11行目と同じ）
    x_equilibrium
    V_equilibrium
    I_equilibrium
  end
  
  methods

（プログラム3-34の7行目から21行目と同じ）

    function x_equilibrium = set_equilibrium(obj, V, I, P, Q)

（プログラム3-28の10行目から23行目と同じ）

      obj.x_equilibrium = x_equilibrium;
      obj.V_equilibrium = V;
      obj.I_equilibrium = I;
    end
    
    function [A, Bu, BV, BI, C, Du, DV, DI] =...
        get_linear_matrix(obj)
      
      X = obj.X;
      X_prime = obj.X_prime;
      D = obj.D;
      M = obj.M;
      tau = obj.tau;
      
      omega0 = obj.omega0;
      delta = obj.x_equilibrium(1);
      E = obj.x_equilibrium(3);
      V = obj.V_equilibrium;
      Vabs = abs(obj.V_equilibrium);
      Vangle = angle(obj.V_equilibrium);
      I = obj.I_equilibrium;
      A = [0, omega0, 0;
        0, -D/M, 0;
        -(X/X_prime-1)*Vabs*sin(delta-Vangle)/tau,...
        0, -X/X_prime/tau];
      Bu = [0; 1/M; 0];
      BV = [0, 0;
        -real(I)/M, -imag(I)/M;
        (X/X_prime-1)*cos(delta)/tau,...
        (X/X_prime-1)*sin(delta)/tau];
      BI = [0, 0;
        -real(V)/M, -imag(V)/M;
        0, 0];
      C = [E*cos(delta), 0, sin(delta);
        E*sin(delta), 0, -cos(delta)];
      Du = [0; 0];
      DV = [0, -1; 1, 0];
      DI = -X_prime*eye(2);
    end

  end

end
\end{verbatim}
\end{PROGRAMA}


このプログラムでは，\red{s}\verb|et_equilibrium|の18行目から20行目において
近似線形モデルを計算する際に用いるために用いる
平衡点の情報を保存する変更を行っている。
\red{（get\_equilibriumはどこにある？）}
また，\verb|get_linear_matrix|に近似線形化に用いる行列の計算が追加されている。s
\red{プログラムの上の文章と同じことを言っていたので削除}
\red{（近似線形モデルの係数行列の計算ですか？）}


定インピーダンスの負荷モデルに関して同様に実装すると，プログラム\ref{program:load_matrix}となる。

\smallskip
\begin{PROGRAMA}[count,title={load\_impedance.m}]\label{program:load_matrix}
\begin{verbatim}
classdef load_impedance < handle
  
  properties
    z
    I_equilibrium
  end
  
  methods

（プログラム3-35の7行目から18行目と同じ）
   
    function x_equilibrium = set_equilibrium(obj, V, I, P, Q)
      x_equilibrium = [];
      obj.z = -V/I;
      obj.I_equilibrium = I;
    end
    
    function [A, Bu, BV, BI, C, Du, DV, DI] =...
        get_linear_matrix(obj)
      
      A = [];
      Bu = zeros(0, 2);
      BV = zeros(0, 2);
      BI = zeros(0, 2);
      C = zeros(2, 0);
      I = obj.I_equilibrium;
      z = obj.z;
      Du = [real(z)*real(I), imag(z)*imag(I);
        real(z)*imag(I), imag(z)*real(I)];
      DV = eye(2);
      DI = [real(z), -imag(z); imag(z), real(z)];
    end
    
  end
  
end
\end{verbatim}
\end{PROGRAMA}

このように変更された発電機や負荷などの機器のクラスを用いると，近似線形モデルを得るための関数がプログラム\ref{program:linearization}のように記述できる。

\smallskip
\begin{PROGRAMA}[count,title={get\_linear\_model.m}]\label{program:linearization}
\begin{verbatim}
function sys = get_linear_model(a_component, Y)

A = cell(numel(a_component), 1);
Bu = cell(numel(a_component), 1);
BV = cell(numel(a_component), 1);
BI = cell(numel(a_component), 1);
C = cell(numel(a_component), 1);
Du = cell(numel(a_component), 1);
DV = cell(numel(a_component), 1);
DI = cell(numel(a_component), 1);

for k = 1:numel(a_component)
  component = a_component{k};
  [A{k}, Bu{k}, BV{k}, BI{k}, C{k}, Du{k}, DV{k}, DI{k}] =...
    component.get_linear_matrix();
end

A = blkdiag(A{:});
Bu = blkdiag(Bu{:});
BV = blkdiag(BV{:});
BI = blkdiag(BI{:});
C = blkdiag(C{:});
Du = blkdiag(Du{:});
DV = blkdiag(DV{:});
DI = blkdiag(DI{:});

Ymat = zeros(size(Y, 1)*2, size(Y, 2)*2);
Ymat(1:2:end, 1:2:end) = real(Y);
Ymat(2:2:end, 1:2:end) = imag(Y);
Ymat(1:2:end, 2:2:end) = -imag(Y);
Ymat(2:2:end, 2:2:end) = real(Y);

nx = size(A, 1);

A11 = A;
A12 = [BV, BI];
A21 = [C; zeros(size(Ymat, 1), nx)];
A22 = [DV, DI; Ymat, -eye(size(Ymat))];

B1 = Bu;
B2 = [Du; zeros(size(Ymat, 1), size(Du, 2))];


Aout = A11 - A12/A22*A21;
Bout = B1 - A12/A22*B2;
Cout = eye(nx);
Dout = 0;

sys = ss(Aout, Bout, Cout, Dout);

end
\end{verbatim}
\end{PROGRAMA}

プログラム\ref{program:linearization}では，12行目から16行目において，各機器から近似線形モデルの係数行列を取得している。
また，27行目から47行目で変数$\bm{V}_i-\bm{V}_i^\star$，$\bm{I}_i - \bm{I}_i^\star$を消去することにより，近似線形モデルの常微分方程式系による表現が得られる。

プログラム\ref{program:linearization}を用いて近似線形モデルは，つぎのように利用できる。

\smallskip
\begin{PROGRAMA}[count,title={load\_impedance.m}]\label{program:main_linearization}
\begin{verbatim}
（プログラム3-30 の1 行目から23行目と同じ）

sys = get_linear_model(a_component, Y);

sys = sys(2, 1);
nyquist(sys)
\end{verbatim}
\end{PROGRAMA}

プログラム\ref{program:main_linearization}の5行目では，発電機1の機械入力$P_{{\rm mech}1}$を入力，発電機1の角周波数偏差$\Delta\omega_1$を出力とする近似線形モデルを構成している。
この例では，ナイキスト線図を6行目で描画している。
\end{例}

\ref{sec:linaproxt}節の数学的な解析では，すべての母線がクロン縮約された非線形の常微分方程式系から近似線形モデルを導出している。
一方で，本節の数値的な実装では，非線形の微分代数方程式系を先に近似線形化し，
その後でクロン縮約を適用して常微分方程式系を構成していることに注意されたい。
この理由は，クロン縮約を適用した電力系統モデルでは，一般に機器や母線，送電線が複雑に入り組んだ表現となるためである。
プログラムの可読性や拡張性を高めるためには，各要素は適切にモジュール化して実装することが重要である。


\subsection{数値的な定態安定性の解析}

実際に，3つの発電機で構成される電力系統モデルに対して，近似線形化に基づく安定性解析を行ってみよう。

%\begin{figure}[t]
%\centering
%\includegraphics[width = .5\linewidth]{figs/gen3ex}
%\medskip
%\caption{\textbf{3つの発電機からなる電力系統モデル}}
%\label{fig:3genex}
%\medskip
%\end{figure}
%
%\begin{figure}[t]
%  \centering
%  {
%  \begin{minipage}{0.49\linewidth}
%    \centering
%    \includegraphics[width = 1.0\linewidth]{figs/delta}
%    \subcaption{ $\delta^{\rm lin}$ }
%    \medskip
%  \end{minipage}
%  \begin{minipage}{0.49\linewidth}
%    \centering
%    \includegraphics[width = 1.0\linewidth]{figs/omega}
%    \subcaption{ $\Delta \omega^{\rm lin}$ }
%    \medskip
%  \end{minipage}
%%  \begin{minipage}{0.32\linewidth}
%    \centering
%    \includegraphics[width = .49\linewidth]{figs/E}
%    \subcaption{ $E^{\rm lin}$ }
%%  \end{minipage}
%  }
%  \medskip
%  \caption{\textbf{近似線形モデルの初期値応答}}
%  \label{fig:timeex}
%\medskip
%\end{figure}


\begin{figure}[t]
  \centering
  {
  \begin{minipage}{0.49\linewidth}
    \centering
    \includegraphics[width = 1.0\linewidth]{figs/Domegalin}
    \subcaption{ $\Delta \omega^{\rm lin}$ }
    \medskip
  \end{minipage}
  \begin{minipage}{0.49\linewidth}
    \centering
    \includegraphics[width = 1.0\linewidth]{figs/deltalin}
    \subcaption{ $\delta^{\rm lin}$ }
    \medskip
  \end{minipage}
 \begin{minipage}{0.49\linewidth}
    \centering
    \includegraphics[width = 1.0\linewidth]{figs/Elin}
    \subcaption{ $E^{\rm lin}$  }
    \medskip
  \end{minipage}
  \begin{minipage}{0.49\linewidth}
    \centering
    \includegraphics[width = 1.0\linewidth]{figs/Plin}
    \subcaption{ $P^{\rm lin}$ }
    \medskip
  \end{minipage}
  }
  \medskip
  \caption{\textbf{近似線形モデルの初期値応答}
  \\  \centering（青：発電機1，黒：発電機2，赤：発電機3）}
  \label{fig:timeex}
\medskip
\end{figure}


%\begin{figure}[t!]
%\centering
%  {
%    \centering
%    \includegraphics[width = .4\linewidth]{figs/gam01}
%    \subcaption{ $\gamma=0.1$ }
%    \centering
%    \includegraphics[width = .4\linewidth]{figs/gam2}
%    \subcaption{ $\gamma=2$ }
%    \centering
%    \includegraphics[width = .4\linewidth]{figs/gam5}
%    \subcaption{ $\gamma=5$ }
%  }
%\caption{近似線形モデルが安定となるパラメータの領域}
%\label{fig:gamsta}
%\medskip
%\end{figure}


\begin{例}[近似線形モデルの数値的な安定性解析]\label{ex:linsyssim}
例\ref{ex:Kronode}で議論した3つの発電機で構成される電力系統モデルを考えよう。
発電機や送電線の定数は例\ref{ex:Kronode}と同じ値に設定して，\ref{table:gensteady}に示される定常値の近傍で式\ref{eq:lindynu0}の近似線形モデルを導出する。
式\ref{eq:exdelE0}に対応させて，初期値を
\begin{align}\label{eq:linmini}
\delta^{\rm lin}(0)
 =
\mat{
\tfrac{\pi}{6} \\
0 \\
0
},\quad
\Delta \omega^{\rm lin}(0)
 =
\mat{
0 \\
0 \\
0
},\quad
E^{\rm lin}(0)
 =
\mat{
0.1 \\
0 \\
0
}
\end{align}
と設定した場合の時間応答を\FIGref{fig:timeex}に示す。
青線は発電機1，黒線は発電機2，赤線は発電機3を表す。
この図から，式\ref{eq:linmconv}のように発電機群の内部状態が漸近収束していることがわかる。
また，\FIGref{fig:Kron0}で示された非線形モデルの初期値応答を近似的に再現している。


つぎに，発電機や送電線の定数や定常値をパラメータ化して，得られる近似線形モデルの安定性を解析する。
発電機の定数については，すべての制動係数を10とする場合と$0.1$とする場合で比較する。
すなわち
\[
(D_1,D_2,D_3)= (10,10,10), \qquad
(D_1,D_2,D_3)= \left(0.1,0.1,0.1\right)
\]
の2通りを考える。
その他の定数は\ref{table:genparams}の値を設定する。
また，回転子偏角差の定常値は，パラメータ$\theta_1 \in [0, 1]$を用いて
\begin{align}
\delta_{12}^{\star}= - \frac{\pi}{2} \theta_1
,\qquad
\delta_{13}^{\star}=  \frac{\pi}{2} \theta_1
\end{align}
と表す。
ここで，$\theta_1$は，定常状態における回転子偏角差の大きさを指定するパラメータである。
この値を変化させることで，式\ref{eq:sysmats}のシステム行列が変化する。
なお，内部電圧の定常値は\ref{table:gensteady}の値から変化させない。

アドミタンス行列も以下のように変化させる。
式\ref{eq:defadpara}の送電線のアドミタンス値$\bm{y}_{12}$，$\bm{y}_{23}$により，式\ref{eq:exY}の送電網のアドミタンス行列を構成する。
このアドミタンス行列の実部であるコンダクタンス行列を$G_0$，虚部であるサセプタンス行列を$B_0$と表す。
具体的には
\begin{align*}
\spliteq{
G_0 &=
\mat{
1.3652 &  -1.3652 &     0 \\
-1.3652 &   3.3074 &  -1.9422 \\
0 &  -1.9422 &  1.9422
}, \\
B_0 & =
\mat{
 -11.6041  & 11.6041    &    0 \\
  11.6041 &  -22.1148  &  10.5107 \\
  0  &  10.5107 &  -10.5107
}
}
\end{align*}
である。
パラメータ$\theta_2 \in [0,5]$を用いて，基準のアドミタンス行列を
\begin{align}\label{eq:Y0theta2}
\bm{Y}_0(\theta_2)
:=
\theta_2 G_0
 +
\bm{j}  B_0
\end{align}
と表す。
ここで，$\theta_2$は実部（コンダクタンス行列）の大きさを指定するパラメータである。
比較のため，パラメータ化されたアドミタンス行列として
\begin{align*}
\bm{Y} = \bm{Y}_0(\theta_2)
,\qquad
\bm{Y} = \tfrac{\bm{Y}_0(\theta_2)}{100}
\end{align*}
の2通りを考える。
このアドミタンス行列の変化は，式\ref{eq:defkh}の縮約コンダクタンス$B^{\rm red}_{ij}$と縮約サセプタンス$G^{\rm red}_{ij}$の値の変化として近似線形モデルに現れる。
比較を行うパラメータ設定を\ref{table:parasetcom}にまとめる。

\begin{table}[h]
\medskip
 \caption{\textbf{ 比較するパラメータ設定}}
 \label{table:parasetcom}
 \centering
  \begin{tabular}{|c|c|c|c|c|c|c|}
   \hline
 &    $D=(10,10,10)$ &   $D=(0.1,0.1,0.1)$ \\
   \hline 
 $\bm{Y} =\bm{Y}_0$ & (a) & (b) \\
   \hline
 $\bm{Y} = \bm{Y}_0/100  $  & (c) & (d) \\
   \hline
  \end{tabular}
\end{table}


\ref{table:parasetcom}の(a)--(d)のそれぞれの場合において，パラメータ$(\theta_1,\theta_2)$を変化させて近似線形モデルの安定性を数値的に解析してみよう。
具体的には，$\theta_1$と$\theta_2$をそれぞれ100点の等間隔グリッドで変化させて，式\ref{eq:lindynu0}の$\Psi$の固有値を調べることにより近似線形モデルが安定であるか否かを網羅的に確認する。
\FIGref{fig:stacheck}にその結果を示す。
近似線形モデルが安定となったパラメータを青の領域で表している。
まず，(a)の結果では，$\theta_1$が約0.4以下である場合，すなわち，定常状態における回転子偏角差が約$36^\circ$以下である場合には，$\theta_2$で指定されるコンダクタンス行列の大きさに依らず，近似線形モデルは安定であることがわかる。
発電機の制動係数が0.1と小さい(b)の場合にも同様の結果となっている。

つぎに，アドミタンス行列が$\tfrac{1}{100}$倍された場合の(c)と(d)の結果を確認する。
このとき，$\theta_2$が1付近のコンダクタンス行列の大きさが小さい場合には，定常状態における回転子偏角差が約$76^\circ$以下であれば近似線形モデルが安定となることがわかる。
また，$\theta_2$が2以上となると，近似線形モデルが安定となる回転子偏角差の上限が小さくなっていくこともわかる。
\end{例}

\begin{figure}[t!]
  \centering
  {
  \begin{minipage}{0.49\linewidth}
    \centering
    \includegraphics[width = 0.90\linewidth]{figs/Y1D1}
    \subcaption{ $D=(10,10,10)$，$\bm{Y}=\bm{Y}_0$ }
    \medskip
  \end{minipage}
  \begin{minipage}{0.49\linewidth}
    \centering
    \includegraphics[width = 0.90\linewidth]{figs/Y1D0.01}
    \subcaption{$D=(\tfrac{1}{10}\tfrac{1}{10},\tfrac{1}{10})$，$\bm{Y}=\bm{Y}_0$ }
    \medskip
  \end{minipage}
}
  \centering
  {
  \begin{minipage}{0.49\linewidth}
      \centering
    \includegraphics[width = 0.90\linewidth]{figs/Y0.01D1}
    \subcaption{$D=(10,10,10)$，$\bm{Y}=\tfrac{\bm{Y}_0}{100}$ }
    \medskip
  \end{minipage}
  \begin{minipage}{0.49\linewidth}
    \centering
    \includegraphics[width = 0.90\linewidth]{figs/Y0.01D0.01}
    \subcaption{$D=(\tfrac{1}{10},\tfrac{1}{10},\tfrac{1}{10})$，$\bm{Y}=\tfrac{\bm{Y}_0}{100}$ }
    \medskip
  \end{minipage}
}
% \medskip
 \caption{\textbf{近似線形モデルが安定となるパラメータの領域}}
 \label{fig:stacheck}
\medskip
\end{figure}


\section{近似線形モデルの数学的な安定性解析\advanced}\label{sec:linmathana}

\subsection{近似線形モデルの定態安定性\advanced}

本節では，式\ref{eq:lindynu0}の近似線形モデルの安定性を数学的に解析する。
その安定性は行列$\Psi$の固有値により特徴づけられる。
一方で，\ref{sec:numlinsta}節で議論されているように，$\Psi$は正則ではなく，零固有値に対する固有空間は
\begin{align}\label{eq:eqset}
\mathcal{M} =
 \sfspan\left\{
 \mat{
 \mathds{1}\\
 0\\
 0
 }
 \right\}
\end{align}
である
\footnote{
正方行列$A$のある固有値$\lambda$に対して
\[
\mathcal{V}_{\lambda}:= \sfker (\lambda I -A)
\]
を$\lambda$に対する\emph{固有空間}（eigenspace）と呼ぶ。
固有値$\lambda$に対するすべての線形独立な固有ベクトルを$v_1,\ldots,v_k$とするとき
\[
\mathcal{V}_{\lambda} = \sfspan\{v_1,\ldots,v_k\}
\]
が成り立つ。
すなわち，特定の固有値に対する固有ベクトルが張る線形空間である。
}
。
この固有空間は，相対的な値を一定に保ってすべての発電機の偏角を変化させた等価な定常値の集合を表している。
したがって，近似線形モデルの状態が式\ref{eq:eqset}の平衡点集合のうちのどの点に収束するかは問題とならない。
この事実に基づき，つぎの定義を与える。

\begin{定義}[近似線形モデルの定態安定性]
\label{def:stalin}
式\ref{eq:lindynu0}の近似線形モデルを考える。
任意の初期値に対して，内部状態が式\ref{eq:eqset}の平衡点集合$\mathcal{M}$のいずれかの点に収束するとき，近似線形モデルは\textbf{定態安定}であると呼ぶ
\footnote{
電力系統工学では，微小な外乱に対する電力系統の安定性を近似線形モデルを用いて議論する場合に広く「定態安定性」という用語が用いられる。
ただし，定義\ref{def:stalin}のように数学的な定義を導入することは一般的ではない。
}。
\end{定義}

定義\ref{def:stalin}における定態安定性は，任意の初期値に対して，式\ref{eq:linmconv}が成り立つことを表している。
なお，式\ref{eq:linmconv}において$c_0$の値は任意であるため，その任意性を「$\mathcal{M}$のいずれかの点に収束すること」として表現している。


以下の議論では，式\ref{eq:lindynu0}の$\Psi$の核空間は1次元であり
\[
\sfker \Psi = \mathcal{M}
\]
が成り立つことを仮定する
\footnote{
行列$\Psi$の構造から，$\mathcal{M} \subseteq \sfker \Psi $であることは明らかであるが，ここでは$\sfker \Psi$が1次元であり，等号が成り立つことを仮定している。
この核空間が2次元以上であると，不変な固有空間が$\mathcal{M}$よりも大きくなり，近似線形モデルは定態安定とならない。
}
。
これは近似線形モデルが定態安定であるための必要条件である。
特に，$A$が正則である場合には
\begin{align}\label{eq:defL0}
L_0:= L-CA^{-1}B 
\end{align}
を用いて，その必要条件は等価的に
\begin{align}\label{eq:nescon}
\sfker L_0 = \sfspan
\left\{
\mathds{1}
\right\}
\end{align}
と表せる
\footnote{
行列$\Psi$の第$(1,2)$ブロックが正則であることから，
\begin{align*}%\label{eq:nescon0}
\sfker \mat{
-L & -C \\
B & A
}
= \sfspan
\left\{
\mat{
\mathds{1}\\
0
}
\right\}
\end{align*}
が成り立つことが，$\Psi$の核空間が$\mathcal{M}$だけであるための必要十分条件であることがわかる。
特に，$A$が正則である場合には
\begin{align*}
\mat{
-L & -C \\
B & A
}\mat{x\\y}
=0
\qquad
\Longleftrightarrow
\quad
L_0 x=0,
\qquad
y=-A^{-1}Bx
\end{align*}
が成り立つことから，その条件は式\ref{eq:nescon}と等価である。
}
。
なお，この行列$L_0$は，のちの解析で重要な役割を果たす。
以下の議論のため，つぎの基本的な用語を導入する。

\begin{定義}[正方行列の安定性]
\label{def:matsta}
正方行列$A$に対して，そのすべての固有値の実部が負であるとき，$A$は\textbf{安定}であると呼ぶ。
\end{定義}



\subsection{近似線形モデルの受動性\advanced}\label{sec:linpasana}

\smallskip
\subsubsection{近似線形モデルのフィードバック系による表現}

\begin{figure}[t]
\centering
\includegraphics[width = .7\linewidth]{figs/FandG}
\medskip
\caption{\textbf{近似線形モデルのフィードバック系表現}}
\label{fig:GandG}
\medskip
\end{figure}


式\ref{eq:lindynu0}の近似線形モデルを2つのサブシステムのフィードバック系として記述することを考える（\FIGref{fig:GandG}）。
1つ目のサブシステムは，角周波数偏差に関する微分方程式系として
\begin{align}\label{eq:Fss}
F: \simode{
M \Delta \dot{\omega}^{\rm lin} &= -D \Delta \omega^{\rm lin}
+
u_F \\
y_F &= \omega_0 \Delta \omega^{\rm lin}
}
\end{align}
とする。
本書では，このサブシステムを\textbf{機械サブシステム}と呼ぶ。
機械サブシステムは，発電機群の物理定数である$(M_i,D_i)_{i\in \mathcal{I}_{\rm G}}$や基準角周波数$\omega_0$のみで定まり，内部状態の定常値$(\delta^{\star},E^{\star})$には依存しない。

2つ目のサブシステムは，回転子偏角と内部電圧に関する微分方程式系として
\begin{align}\label{eq:Gss}
G: \simode{
\dot{\delta}^{\rm lin} & = u_G \\
\taud \dot{E}^{\rm lin} &= A E^{\rm lin} + B \delta^{\rm lin} \\
y_G &= C E^{\rm lin} + L \delta^{\rm lin}
}
\end{align}
とする。
このサブシステムを\textbf{電気サブシステム}と呼ぶ
\footnote{
ここで導入した「機械サブシステム」と「電気サブシステム」は本書独自の用語である。
}。
電気サブシステムは，発電機群の物理定数である$(\taudi)_{i\in \mathcal{I}_{\rm G}}$
だけでなく，内部状態の定常値$(\delta^{\star},E^{\star})$にも依存する。
実際，式\ref{eq:sysmats}のシステム行列$(L,A,B,C)$は，$(\delta^{\star},E^{\star})$の関数である。
これら2つのサブシステムの入出力を
\begin{align}\label{eq:nfedcon}
u_F = -y_G,\qquad
u_G = y_F
\end{align}
のようにネガティブ・フィードバック結合すれば，式\ref{eq:lindynu0}の近似線形モデルが表現される。
以降の定態安定性の解析は，機械サブシステムと電気サブシステムの受動性と呼ばれる性質に基づく。
受動的なサブシステムのネガティブ・フィードバック系は安定であることが知られている。


\smallskip
\subsubsection{機械サブシステムの受動性}

式\ref{eq:Fss}の機械サブシステム$F$は，つぎのように定義される強受動性をもつ。

\begin{定義}[線形システムの受動性]\label{def:passivelin}
線形システム
\begin{align}\label{eq:siglin}
\Sigma: \simode{
\dot{x} &= Ax + Bu \\
y &= Cx 
}
\end{align}
を考える。
対称行列$P$を用いて，関数
\begin{align}\label{eq:defstlin}
W(x):= \frac{1}{2}x^{\sf T}Px
\end{align}
を定義する。
任意の$u$に対して
\begin{align}\label{eq:conpvlin}
\frac{d}{dt} W\bigl( x(t) \bigr) \leq u^{\sf T}(t) y(t)
,\qquad
\forall t \geq 0
\end{align}
を満たす半正定行列$P$が存在するとき，$\Sigma$は\textbf{受動的} （passive）であると呼ぶ。
特に，上記の半正定行列に加えて
\begin{align}\label{eq:conosplin}
\frac{d}{dt} W\bigl( x(t) \bigr) \leq u^{\sf T}(t) y(t) -\rho \left\|y(t) \right\|^2
,\qquad
\forall t \geq 0
\end{align}
を満たすある正定数$\rho$が存在するとき，$\Sigma$は\textbf{強受動的}（strictly passive）であると呼ぶ
\footnote{
式\ref{eq:conosplin}の不等式は，関数$W(x)$で表されるある種のエネルギーが，式\ref{eq:conpvlin}と比較して，出力の2乗に比例する項だけ多く消散するような受動性となっている。
このような受動性は，より厳密には\textbf{出力強受動性}（output-strict passivity）と呼ばれる。
}
。
\end{定義}

定義\ref{def:passivelin}における関数$W(x)$は，一般に\textbf{蓄積関数}（storage function）と呼ばれる。
式\ref{eq:Fss}の機械サブシステム$F$が強受動性をもつことは，以下のように確かめられる。
まず，サブシステムを
\begin{align}
F: \simode{
\dot{x}_F & = A_F x_F + B_F u_F \\
y_F &= C_F x_F
}
\end{align}
の形式で書き表す。
ただし，状態$x_F$は$\Delta \omega^{\rm lin}$を表し，システム行列は
\[
A_F := -M^{-1}D,\qquad
B_F := M^{-1},\qquad
C_F := \omega_0 I
\]
である。
また，対称行列$P_F$を
\[
P_F := \omega_0 M
\]
と定義する。
行列$M$は正定であることから，この$P_F$は正定である。
このとき
\[
A^{\sf T}_F P_F + P_F A_F \preceq  
- \frac{ 2 \sfmin \left\{ D_i \right\}}{\omega_0} C_F^{\sf T} C_F
,\qquad
P_F B_F = C_F^{\sf T}
\]
が成り立つ。
したがって，蓄積関数を
\begin{align}\label{eq:WFdef}
W_F(x_F):= \frac{1}{2}x_F^{\sf T}P_Fx_F
\end{align}
と定義するとき，$F$の解軌道に沿った時間微分は
\begin{align}\label{eq:Flyapeq}
\spliteq{
\frac{d}{dt} W_F \bigl( x_F (t) \bigr)
& = 
\nabla W_F^{\sf T}(x_F) \frac{d x_F}{dt} 
 \\
&=  \bigl( P_F x_F(t) \bigr)^{\sf T} \bigl(A_F x_F(t) + B_F u_F(t) \bigr) \\
 & = y_F^{\sf T}(t) u_F(t)
 + \frac{1}{2} x_F^{\sf T}(t) \left(A^{\sf T}_F P_F + P_F A_F\right) x_F(t) \\
& \leq 
y_F^{\sf T}(t) u_F(t)
- \tfrac{\sfmin \left\{ D_i \right\}}{\omega_0}
\|y_F(t) \|^2
}
\end{align}
と評価できる。
ただし，$\nabla W_F(x_F)$は，$W_F(x_F)$を$x_F$の要素で偏微分し，各々を縦に並べた勾配関数である。
このことから，式\ref{eq:Fss}の機械サブシステム$F$は，任意の正定数$(M_i,D_i)_{i \in \mathcal{I}_{\rm G}}$に対して強受動的であることがわかる。
なお，関数$W_F(x_F)$は，電力系統の機械的な運動エネルギーを表している。

\smallskip
\subsubsection{電気サブシステムの受動性}


つぎに，式\ref{eq:Gss}の電気サブシステム$G$を考える。
機械サブシステム$F$とは異なり，電気サブシステム$G$は，限られた条件のもとでしか受動性をもたない。
天下り的であるが，式\ref{eq:figi}における縮約コンダクタンスがすべて0である場合，すなわち
\begin{align}\label{eq:Gredcon}
G^{\rm red}_{ij}=0,\qquad 
\forall (i, j) \in \mathcal{I}_{\rm G} \times \mathcal{I}_{\rm G}
\end{align}
である場合を考える。
特別な場合を除いて，式\ref{eq:Gredcon}の条件は，電力系統におけるすべての送電線のコンダクタンスが0である場合，すなわち，すべての送電線の抵抗が0である場合にのみ成り立つ。
このとき，式\ref{eq:defkh}の関数$k_{ij}(\delta_{ij})$，$h_{ij}(\delta_{ij})$に対して
\begin{align*}
k_{ij}(\delta_{ij}^{\star}) =
k_{ji}(\delta_{ji}^{\star})
,\qquad
h_{ij}(\delta_{ij}^{\star}) = 
- h_{ji}(\delta_{ji}^{\star}),\qquad
h_{ii}(\delta_{ii}^{\star}) = 0
\end{align*}
が成り立つ。
したがって，式\ref{eq:sysmats}のシステム行列$(L,A,B,C)$について
\begin{align}\label{eq:sysmatst}
L=L^{\sf T} ,\qquad
\hat{A} = \hat{A}^{\sf T},\qquad
C= -\hat{B}^{\sf T}
\end{align}
が成り立つ。
以下では，この特別なシステム行列の対称構造を用いて，電気サブシステムの受動性を解析する。

まず，式\ref{eq:Gss}の電気サブシステム$G$を
\begin{align}
G: \simode{
\dot{x}_G & = A_G x_G + B_G u_G \\
y_G &= C_G x_G
}
\end{align}
の形式で表現する。
ただし，状態$x_G$は${\delta}^{\rm lin}$と$ E^{\rm lin} $を並べた列ベクトルであり，正定な対角行列
\[
 \Omega :=
\sfdiag \left( \sqrt{\frac{ \Xsi - \Xti }{ \taudi } } \right)_{i \in \mathcal{I}_{\rm G} }
\]
を用いて，システム行列を
\[
A_G := 
\mat{
0 & 0 \\
 \Omega^2 \hat{B}   &  \Omega^2 \hat{A} 
},\qquad
B_G := 
\mat{
I \\
0
},\qquad
C_G := 
\mat{
L & -\hat{B}^{\sf T}
}
\]
と表す。
また，対称行列$P_G$を
\begin{align}\label{eq:defPG}
P_G := 
\mat{
L  &  - \hat{B}^{\sf T} \\
- \hat{B} & -\hat{A}
}
\end{align}
と定義する。
これらの行列に対して
\begin{align}\label{eq:lyapinG}
A^{\sf T}_G P_G + P_G A_G \preceq 
0
,\qquad
P_G B_G = C_G^{\sf T}
\end{align}
が成り立つ。
なお，左の行列不等式が成り立つことは，以下のように確かめられる。
不等式の左辺を計算すると，対称行列$\hat{A}_{\Omega} := \Omega \hat{A} \Omega$を用いて
\[
\frac{
A^{\sf T}_G P_G + P_G A_G
}{2}
=
\mat{
\Omega \hat{B} & 0\\
0 &\Omega^{-1}
}^{\sf T}
\underbrace{
\mat{
-I & -\hat{A}_{\Omega} \\
-\hat{A}_{\Omega} & - \hat{A}_{\Omega}^2
}
}_{Y}
\mat{
\Omega \hat{B} & 0\\
0 & \Omega^{-1}
}
\]
と表せることがわかる。
ここで，$Y$の左上ブロック$- I$が負定であり，かつ，$Y$の$-I$に関するシューア補行列は0であることから，$Y$は半負定である
\footnote{
対称行列$M$を
\[
M =\mat{
M_{11} & M_{12} \\
M_{12}^{\sf T} & M_{22}
}
\]
と区分する。
このとき
\[
M/M_{22} := M_{11} - M_{12} M_{22}^{-1} M_{12}^{\sf T}
\]
を$M$の$M_{22}$に関する\textbf{シューア補行列}（Schur complement）と呼ぶ。
同様に
\[
M/M_{11} := M_{22} - M_{12}^{\sf T} M_{11}^{-1} M_{12}
\]
を$M$の$M_{11}$に関するシューア補行列と呼ぶ。
行列$M_{22}$が正定であるとき，$M$が半正定となるための必要十分条件は，$M/M_{22}$が半正定となることである。
同様の事実は$M/M_{11}$に対しても成り立つ\cite{bernstein2009matrix}。
また，半正定を正定に置き換えた事実も成り立つ。
}
。
これは，式\ref{eq:lyapinG}の行列不等式が成り立つことを意味する
\footnote{
半負定な行列$Y\in \mathbb{R}^{n\times n}$と任意の行列$X\in \mathbb{R}^{n\times m}$について，$X^{\sf T}YX$は半負定である。
このことは
\[
v^{\sf T}Yv\geq 0, \quad \forall v\in \mathbb{R}^n
\qquad
\Longrightarrow
\qquad
(Xw)^{\sf T} Y (Xw) \geq 0, \quad \forall w\in \mathbb{R}^m
\]
であることから確かめられる。
}
。


式\ref{eq:lyapinG}の関係を用いることにより，蓄積関数
\begin{align}\label{eq:WGdef}
W_G(x_G):= \frac{1}{2}x_G^{\sf T}P_Gx_G
\end{align}
の$G$の解軌道に沿った時間微分は，式\ref{eq:Flyapeq}と同様にして
\begin{align}\label{eq:Glyapeq}
\frac{d}{dt} W_G \bigl( x_G (t) \bigr)
 \leq 
y_G^{\sf T}(t) u_G(t)
\end{align}
と評価できる。
ただし，$G$の受動性を示すためには，式\ref{eq:defPG}の$P_G$は半正定でなければならない。
ここで，式\ref{eq:sysmats}の行列$A$が安定である場合には
\[
A= S^2 \hat{A}
\qquad \Longleftrightarrow \qquad S^{-1} A S = S \hat{A} S
\]
であることから，$S \hat{A} S$の固有値はすべて負であることが導かれる。
ただし
\[
S:=\sfdiag \left( \sqrt{ \Xsi -  \Xti }\right)_{i \in \mathcal{I}_{\rm G} } 
\]
である。
これは，$ \hat{A} $が負定であることを意味する。
このとき，式\ref{eq:defPG}の$P_G$が半正定であるための必要十分条件は，$ -\hat{A} $に関するシューア補行列が半正定であること，すなわち
\begin{align}\label{eq:pdsp}
L_0 =L_0^{\sf T} \succeq 0
\end{align}
が成り立つことである。
ただし，式\ref{eq:defL0}の$L_0$に対して，式\ref{eq:sysmatst}から
\[
L_0 = L + \hat{B}^{\sf T} \hat{A}^{-1} \hat{B}
\]
であることを用いた。
以上の議論を整理するため，つぎの用語を導入する。

\begin{定義}[受動送電条件]\label{def:passtrans}
式\ref{eq:sysmats}のシステム行列$(L,A,B,C)$について，つぎの3つの条件をまとめて\textbf{受動送電条件}と呼ぶ
\footnote{
この「受動送電条件」は本書独自の用語である。
}。
\begin{itemize}
\item[(i)] 行列$A$が安定である。
\item[(ii)] 式\ref{eq:Gredcon}のように縮約コンダクタンスがすべて0である。
\item[(iii)] 式\ref{eq:defL0}の行列$L_0$に対して，式\ref{eq:pdsp}の行列不等式が成り立つ。
\end{itemize}
なお，個別には受動送電条件(i)などと呼ぶ。
\end{定義}


これまでの議論から，受動送電条件は，式\ref{eq:Gss}電気サブシステム$G$が受動的であるための十分条件であることがわかる。
さらに，この条件は，電気サブシステムの受動性や任意の物理定数に対して近似線形モデルが定態安定となるための必要条件であることも示される。
詳細は，\ref{sec:nesconana}節と\ref{sec:nesconsta}節で後述する。
なお，関数$W_G(x_G)$は，電力系統の電気的なポテンシャルエネルギーを表す。

\subsection{受動性に基づく定態安定性の解析\advanced}

\smallskip
\subsubsection{フィードバック系の安定性解析}

以下では，定義\ref{def:passtrans}の受動送電条件のもと，電気サブシステムが受動的である場合に，それらのフィードバック系の安定性，すなわち，式\ref{eq:lindynu0}の近似線形モデルの定態安定性を解析する。
式\ref{eq:Flyapeq}と式\ref{eq:Glyapeq}の不等式が成り立つことから，それらの和は
\begin{align*}
\spliteq{
 \frac{d}{dt} \bigl\{ W_F \bigl( x_F (t) \bigr)
& +
 W_G \bigl( x_G (t) \bigr)
 \bigr\} \\
& \leq 
\underbrace{
y_F^{\sf T}(t) u_F(t)
+
y_G^{\sf T}(t) u_G(t)
}_{\star}
- \tfrac{\sfmin \left\{ D_i \right\}}{\omega_0}
\|y_F(t) \|^2
}
\end{align*}
となる。
この不等式に，式\ref{eq:nfedcon}のフィードバック結合の方程式を代入すれば，「$\star$」で示された項は相殺されて，フィードバック系全体の不等式として
\begin{align}\label{eq:FGlyapeq}
 \frac{d}{dt} \bigl\{ W_F \bigl( x_F (t) \bigr)
 +
 W_G \bigl( x_G (t) \bigr)
 \bigr\} 
 \leq 
- \tfrac{\sfmin \left\{ D_i \right\}}{\omega_0}
\|y_F(t) \|^2
\end{align}
を得る。
すなわち，関数$W_F(x_F)$と$W_G(x_G)$の和は，フィードバック系の解軌道に沿った時間変化に関して単調非増加である。
また，$W_F(x_F)$と$W_G(x_G)$の下限値はどちらも0であることから，時間が十分に経過するとそれらの和はある値に漸近収束する。
これは，式\ref{eq:FGlyapeq}の左辺である時間微分の値が0に漸近収束することを意味する。
また，式\ref{eq:FGlyapeq}の右辺は，$y_F(t)\neq 0$であるとき負であり，$y_F(t)=0$であるときのみ0であることから
\begin{align}\label{eq:yFlim0}
\lim_{t\rightarrow \infty} y_F(t)  =0
\end{align}
が得られる。
さらに，式\ref{eq:Fss}の出力方程式に注目すると，出力$y_F$は内部状態$\Delta \omega^{\rm lin}$の定数倍であることから，機械サブシステム$F$に対して
\begin{align}\label{eq:Fobs}
y_F(t)  =0,\quad \forall t\geq 0 
\qquad \Longrightarrow \qquad
\Delta \omega^{\rm lin}(t)  =0,\quad \forall t\geq 0 
\end{align}
が成り立つことがわかる。
これは，システム制御工学において\textbf{可観測性}（observability）と呼ばれる性質である
\footnote{
式\ref{eq:siglin}の線形システム$\Sigma$について，出力$y(t)$が恒等的に0であるならば，内部状態$x(t)$も恒等的に0であるとき，$\Sigma$は\textbf{可観測}（observable）であると呼ばれる。
また，$\Sigma$が可観測であるための必要十分条件は
\[
\sfker \mat{
C \\
CA \\
\vdots \\
CA^{n-1}
}
=\{0\}
\]
である。
ただし，$n$は状態の次元である。
}
。
したがって，式\ref{eq:yFlim0}と式\ref{eq:Fobs}から，
式\ref{eq:lindynu0}の近似線形モデルについて，
任意の初期値$(\Delta \omega^{\rm lin}(0),\delta^{\rm lin}(0),E^{\rm lin}(0))$に対して
\begin{align}\label{eq:Delom0}
\lim_{t\rightarrow \infty} \Delta \omega^{\rm lin}(t)  =0
\end{align}
が成り立つことがわかる。
すなわち，フィードバック系における式\ref{eq:Fss}の機械サブシステム$F$の内部状態は0に漸近収束する
\footnote{
式\ref{eq:siglin}の可観測な線形システム$\Sigma$を考える。
ただし，入力$u(t)$は恒等的に0であるものとする。
また，任意の$x$に対して$V(x)\geq0$を満たし，かつ，$V(0)=0$である半正定値関数を考える。
ある正定数$\rho$が存在して，関数$V(x)$の$\Sigma$の解軌道に沿った微分に対して
\[
\frac{d}{dt} V \bigl( x (t) \bigr) 
=
\nabla V^{\sf T}(x) \frac{d x}{dt} (t)
\leq  - \rho \|y(t)\|^2,\qquad
\forall t \geq0
\]
が成り立つとき，任意の初期値に対する解軌道$x(t)$は0に漸近収束することが示される。
このような関数$V(x)$は，\textbf{リアプノフ関数}（Lyapunov function）と呼ばれる。
リアプノフ関数の値がシステムの解軌道に沿って単調減少することは，ある種のエネルギーが時間の経過にしたがって散逸していくこととして解釈できる（\FIGref{fig:conelyap}）。
同様の議論に基づく安定性解析は，非線形システムにも適用できる。
}。

\begin{figure}[t]
\centering
\includegraphics[width = .35\linewidth]{figs/cone}
\medskip
\caption{\textbf{リアプノフ関数の解軌道に沿った値の単調減少}}
\label{fig:conelyap}
\medskip
\end{figure}

一方で，式\ref{eq:Gss}の電気サブシステム$G$の内部状態が同様に0に漸近収束することは，以上の議論からは導くことはできない。
具体的には，式\ref{eq:nfedcon}の関係と式\ref{eq:Delom0}の漸近収束から，2つのサブシステムの入出力に関して
\[
\lim_{t\rightarrow \infty} u_F(t)  =0,\qquad
\lim_{t\rightarrow \infty} u_G(t)  =0,\qquad
\lim_{t\rightarrow \infty} y_G(t)  =0
\]
が導かれる。
しかしながら，電気サブシステムは可観測ではないため，その内部状態が漸近収束することまでは結論できない。
電気サブシステムが可観測であると仮定すると，任意の初期値に対して
\[
\lim_{t\rightarrow \infty}  \delta^{\rm lin}(t)  =0,\qquad
\lim_{t\rightarrow \infty}  E^{\rm lin}(t)  =0
\]
となるが，これは式\ref{eq:linmconv}において必ず$c_0=0$となることを意味する。
この事実は，式\ref{eq:lindynu0}の$\Psi$が零固有値をもつため安定でないことに矛盾する。
なお，特別な場合を除いて，電気サブシステムは可制御ではある
\footnote{
式\ref{eq:siglin}の線形システム$\Sigma$について，
各々すべての初期値$x(0)$に対して，ある時刻$T > 0$において $x(T) = 0$ となる入力$u(t)$が存在するとき，$\Sigma$は\textbf{可制御}（controllable）であると呼ぶ。
また，$\Sigma$が可制御であるための必要十分条件は
\[
\sfim \mat{
B & AB & \cdots &A^{n-1}B
}
= \mathbb{R}^n
\]
である。
ただし，$n$は状態の次元である。
また，$\sfim$は行列の\textbf{値域}（image）を表す。
}
。


\begin{figure}[t]
  \centering
  {
  \begin{minipage}{0.49\linewidth}
    \centering
    \includegraphics[width = 1.0\linewidth]{figs/losslessW}
    \subcaption{ 受動送電条件(ii)を満たす場合}
    \medskip
  \end{minipage}
  \begin{minipage}{0.49\linewidth}
    \centering
    \includegraphics[width = 1.0\linewidth]{figs/lossyW}
    \subcaption{ 受動送電条件(ii)を満たさない場合 }
    \medskip
  \end{minipage}
  }
  \medskip
  \caption{\textbf{例\ref{ex:linsyssim}に対する蓄積関数の時間変化}
  \\  \centering（青：$W_F$，赤：$W_G$，黒：$W_F+W_G$）}
  \label{fig:LyapW}
\medskip
\end{figure}


\begin{例}[蓄積されるエネルギーの時間変化]\label{ex:energylin}
例\ref{ex:linsyssim}の前半で扱った近似線形モデルを考える。
まず，受動送電条件(ii)が満たされる場合，すなわち，2つの送電線のコンダクタンスが0である場合を考える。
具体的には，送電線のアドミタンス値を
\begin{align}\label{eq:bothlossless}
\bm{y}_{12} = - \bm{j} 11.6041, \qquad
\bm{y}_{23} =  - \bm{j} 10.5107
\end{align}
に設定する。
これは，式\ref{eq:Y0theta2}においてパラメータ$\theta_2$を0とした場合に対応する。
このとき，行列$A$は安定となる。
また，式\ref{eq:defL0}の$L_0$の固有値はすべて非負となる。
すなわち，受動送電条件(i)と(iii)が成り立つ。

式\ref{eq:linmini}の初期値に対する時間応答について，式\ref{eq:WFdef}の運動エネルギー$W_F(x_F)$と式\ref{eq:WGdef}のポテンシャルエネルギー$W_G(x_G)$の時間変化を計算する。
計算結果を\FIGref{fig:LyapW}(a)に示す。
青と赤の実線はそれぞれ$W_F(x_F)$と$W_G(x_G)$を表す。
また，黒の破線はそれらの和を表す。
この図から，運動エネルギーとポテンシャルエネルギーが互い違いに増減しながら，それらの和であるシステム全体の総エネルギーが単調に減少していることがわかる。
総エネルギーが時間の経過とともに減少していくことは，制動係数による摩擦でエネルギーの損失が生じることとして解釈できる。

つぎに，参考として，受動送電条件(ii)が満たされない場合の結果を示そう。
具体的には，式\ref{eq:Y0theta2}において$\theta_2$を1とした，$\bm{Y}_0(1)$をアドミタンス行列$\bm{Y}$として設定する。
これは，\FIGref{fig:timeex}の初期値応答に対して運動エネルギーとポテンシャルエネルギーの時間変化を計算することに等しい。
なお，受動送電条件(ii)が満たされない場合には，式\ref{eq:defPG}の$P_G$は対称行列とはならないが，式\ref{eq:WGdef}の定義をそのまま用いてポテンシャルエネルギー$W_G(x_G)$を計算する。
そのときの計算結果の\FIGref{fig:LyapW}(b)は，\FIGref{fig:LyapW}(a)とほぼ等しいことがわかる。
この事実は，送電線のコンダクタンスが0でない場合にも，式\ref{eq:WGdef}の定義に基づいて，電気的なポテンシャルエネルギーが近似的に計算できる可能性を示唆している。
\end{例}

\smallskip
\subsubsection{不可観測な状態変数を分離する基底変換}

式\ref{eq:Gss}の電気サブシステム$G$から，不可観測な回転子偏角の共通成分を取り除くことで，可観測なサブシステムを導出することを考える。
具体的には，式\ref{eq:lindyn}の状態$\delta^{\rm lin}$に対して基底変換を適用することにより，回転子偏角の偏差のみを記述する微分方程式系を導出する
\footnote{
線形システムの基底変換は，以下のような操作である。
状態方程式
\[
\dot{x}(t)=Ax(t)+Bu(t)
\]
において，$n$次元の状態ベクトル$x(t)$の各要素$x_i(t)$は
\[
x(t)
=
e_1 x_1(t) + \cdots + e_n x_n(t)
\]
のように，基底$\{e_1,\ldots,e_n\}$で展開した場合の成分を表す。
ただし，$e_i$は第$i$要素のみ1をもつ$n$次元ベクトルである。
この基底を\textbf{標準基底}（standard basis）と呼ぶ。
状態方程式は，ある基底で状態ベクトルを表現した場合の「成分」の時間発展を表す。
この状態ベクトル$x(t)$を別の基底$\{v_1,\ldots,v_n\}$で表現することを考える。
すなわち
\[
x(t)
=
v_1 \xi_1(t) + \cdots + v_n \xi_n(t)
\]
とする。
ここで，$\xi_i(t)$は基底ベクトル$v_i$の成分である。
ベクトル$v_i$を横に並べた行列を$V$，$\xi_i(t)$を縦に並べたベクトルを$\xi(t)$とすれば，
$x(t)=V\xi(t)$という線形変換を行うことに対応する。
このとき，状態方程式は
\[
\dot{\xi}(t)=V^{-1}AV \xi(t) + V^{-1} Bu(t)
\]
と変換される。
この微分方程式系は，新たな基底における成分の時間発展を記述する。
%なお，基底を$\mathcal{V}_a:=\{v_1,\ldots,v_k\}$，$\mathcal{V}_b:=\{v_{k+1},\ldots,v_n\}$のように2つに分割し，それに対応するように
%\[
%x(t)=
%V_{a} \xi_{a}(t) +
% V_{b} \xi_{b}(t)
%\]
%と展開すれば，基底変換された状態方程式は
%\[
%\mat{
%\dot{\xi}_{a}(t) \\
%\dot{\xi}_{b}(t)
%}
%=
%\mat{
%W_{a} A V_{a} & W_{a} A V_{b} \\
%W_{b} A V_{a} & W_{b} A W_{b}
%}
%\mat{
%{\xi}_{a}(t) \\
%{\xi}_{b}(t)
%}
%\]
%と得られる。
%ただし，$V_{a}$と$V_{b}$は，$\mathcal{V}_a$と$\mathcal{V}_b$の基底ベクトルを並べた行列であり，
%$W_{a}$と$W_{b}$は
%\[
%\mat{
%W_{a} \\
%W_{b}
%}
%=\mat{
%V_{a} & V_{b}
%}^{-1}
%\qquad
%\Longleftrightarrow
%\qquad
%\mat{
%V_{a} & V_{b}
%}\mat{
%W_{a} \\
%W_{b}
%}=I
%\]
%を満たす行列である。
%この表現において，$\xi_a(t)$は部分空間$\sfspan \mathcal{V}_a$に関する$x(t)$の成分である。
%また，$\xi_b(t)$は$\sfspan \mathcal{V}_b$に関する成分である。
}
。
なお，以下で説明する基底変換は，受動送電条件が成り立つか否かに関わらず常に適用可能である。

ある行列$W \in \mathbb{R}^{N\times (N-1)}$を用いて，$\delta^{\rm lin}$を
\begin{align}\label{eq:batrinv}
\delta^{\rm lin}
=
W
\delta^{\rm lin}_{\rm e} +
\mathds{1}
\overline{\delta}^{\rm lin}_{\rm e}
\end{align}
のように展開する。
ここで，$\mathds{1}$は$\delta^{\rm lin}$の共通成分を表す基底ベクトルであり，$W$はそれ以外の偏差成分を表す基底ベクトルを並べた行列である。
すなわち，$\delta^{\rm lin}$の共通成分が$\overline{\delta}^{\rm lin}_{\rm e}$であり，偏差成分が$\delta^{\rm lin}_{\rm e}$である。
なお，共通成分$\overline{\delta}^{\rm lin}_{\rm e}$は1次元であり，偏差成分$\delta^{\rm lin}_{\rm e}$は$(N-1)$次元である。

つぎに，式\ref{eq:batrinv}の逆変換を考える。
具体的には
\[
\delta^{\rm lin}
=
\underbrace{
\mat{
W & \mathds{1}
}
}_{T}
\mat{
\delta^{\rm lin}_{\rm e} \\
\overline{\delta}^{\rm lin}_{\rm e}
}
\quad
\Longleftrightarrow
\quad
\mat{
\delta^{\rm lin}_{\rm e} \\
\overline{\delta}^{\rm lin}_{\rm e}
}
=
\underbrace{
\mat{
W^{\dagger} \\
\frac{1}{N} \mathds{1}^{\sf T}
}
}_{T^{-1}}
\delta^{\rm lin}
\]
となる行列$W^{\dagger} \in \mathbb{R}^{(N-1)\times N}$を考える。
ただし，この逆変換が存在するためには，$W$の列ベクトルは$\mathds{1}$と直交するものでなければならない。
このことはつぎのように確かめられる。
逆変換の関係から
\begin{align*}
T^{-1}T
=\mat{
W^{\dagger}W & W^{\dagger} \mathds{1}\\
\frac{1}{N} \mathds{1}^{\sf T} W & \frac{1}{N} \mathds{1}^{\sf T} \mathds{1}
}
=\mat{
I & 0\\
0 & 1
}
\end{align*}
が成り立たなければならない。
すなわち，$W$と$W^{\dagger}$は
\[
\mathds{1}^{\sf T} W=0,\qquad
W^{\dagger}W=I,\qquad
W^{\dagger} \mathds{1}=0
\]
を満たす行列である。
したがって，1つ目の等式から，$W$の列ベクトルは$\mathds{1}$と直交することがわかる。
なお，$W$と$W^{\dagger}$は，
$\mathds{1}^{\sf T} U=0$
を満たし，かつ，$U^{\sf T}U$が正則となる適当な行列$U\in \mathbb{R}^{N\times (N-1)}$を用いて
\[
W = U(U^{\sf T}U)^{-1},\qquad
W^{\dagger}=U^{\sf T}
\]
とすれば構成できる。
このとき，積$WW^{\dagger}$は$\sfspan\{\mathds{1}\}$の直交補空間への直交射影行列となることから
\begin{align}\label{eq:psudinv}
WW^{\dagger} = I - \frac{1}{N} \mathds{1} \mathds{1}^{\sf T}
\end{align}
と表せる
\footnote{
直交射影の概念図を\FIGref{fig:orthogonal}に示す。
黒矢印により$\sfspan\{\mathds{1}\}$の空間を示し，それに直交する平面として直交補空間$\sfspan\{\mathds{1}\}^{\perp}$を示している。
ベクトル$v$に直交射影行列$WW^{\dagger}$を乗じると，$v$から$\sfspan\{\mathds{1}\}^{\perp}$に垂直に投影した影として$WW^{\dagger}v$が得られる。
なお，相補関係にある$I-WW^{\dagger}=\tfrac{1}{N}\mathds{1} \mathds{1}^{\sf T}$は，$\sfspan\{\mathds{1}\}$への直交射影行列である。
}。
このような$W$の擬似逆行列$W^{\dagger}$は，特別に\textbf{ムーア・ペンローズの擬似逆行列}（Moore-Penrose pseudoinverse）と呼ばれる\cite{bernstein2009matrix}。


\begin{figure}[t]
\centering
\includegraphics[width = .50\linewidth]{figs/orthogonal}
\medskip
\caption{\textbf{直交射影の概念図}}
\label{fig:orthogonal}
\medskip
\end{figure}

式\ref{eq:Gss}の電気サブシステム$G$に上述の基底変換を適用する。
まず，$\delta^{\rm lin}$に関する微分方程式に式\ref{eq:batrinv}を代入すると
\[
W
\dot{\delta}^{\rm lin}_{\rm e} +
\mathds{1}
\dot{\overline{\delta}}^{\rm lin}_{\rm e}=u_G
\]
が得られる。
この微分方程式に左から$W^{\dagger}$または$\tfrac{1}{N} \mathds{1}^{\sf T}$を乗じれば
\[
\dot{\delta}^{\rm lin}_{\rm e} = W^{\dagger} u_G,\qquad
\dot{\overline{\delta}}^{\rm lin}_{\rm e} = \frac{1}{N} \mathds{1}^{\sf T} u_G
\]
を得る。
つぎに，行列$L$と$B$に式\ref{eq:LBker}の関係が成り立つことに注意すると，$E^{\rm lin}$に関する微分方程式と出力方程式は
\[
\taud \dot{E}^{\rm lin} = A E^{\rm lin} + 
B W {\delta}^{\rm lin}_{\rm e}
, \qquad
y_G = C E^{\rm lin} + 
L W {\delta}^{\rm lin}_{\rm e}
\]
と書き換えられる。
したがって，基底変換された電気サブシステムが
\begin{align}\label{eq:Gsstr}
G: \simode{
\dot{\overline{\delta}}^{\rm lin}_{\rm e} & = \tfrac{1}{N} \mathds{1}^{\sf T} u_G \\
\dot{\delta}^{\rm lin}_{\rm e} & = W^{\dagger}u_G \\
\taud \dot{E}^{\rm lin} &= A E^{\rm lin} + B W {\delta}^{\rm lin}_{\rm e} \\
y_G &= C E^{\rm lin} + L W {\delta}^{\rm lin}_{\rm e}
}
\end{align}
と得られる。
このシステム表現で注目すべき点は，$\delta^{\rm lin}$の共通成分を表す${\overline{\delta}}^{\rm lin}_{\rm e}$は，入力$u_G$の影響は受ける一方で，出力$y_G$には全く影響を与えないことである。
すなわち，${\overline{\delta}}^{\rm lin}_{\rm e}$は不可観測な状態変数である。


式\ref{eq:Gsstr}から${\overline{\delta}}^{\rm lin}_{\rm e}$の微分方程式を除くことにより，$(N-1)$次元の可制御かつ可観測なサブシステムが
\begin{align}\label{eq:Gsstrmin}
G_{\rm e}: \simode{
\dot{\delta}^{\rm lin}_{\rm e} & = W^{\dagger} u_G \\
\taud \dot{E}^{\rm lin} &= A E^{\rm lin} + B W {\delta}^{\rm lin}_{\rm e} \\
y_G &= C E^{\rm lin} + L W {\delta}^{\rm lin}_{\rm e}
}
\end{align}
と得られる
\footnote{
組$(\taud^{-1}A,\taud^{-1}B)$が可制御であり，かつ，組$(C,\taud^{-1}A)$可観測であることが，
$G_{\rm e}$が可制御かつ可観測であるための必要十分条件である。
以下では，この可制御性と可観測性は仮定して議論を進める。
なお，厳密な証明は必ずしも容易ではないが，$B$と$C$のランクは特別な状況を除き$(N-1)$以上であるため，それらを仮定しても現実的な解析に支障はない。
}。
ここで，$G_{\rm e}$の可観測性から
\begin{align}\label{eq:Geobs}
y_G(t)  =0,\quad \forall t\geq 0 
\qquad \Longrightarrow \qquad
\mat{
{\delta}^{\rm lin}_{\rm e}(t)   \\
E^{\rm lin}(t)  
}
=0
,\quad 
\forall t\geq 0 
\end{align}
が成り立つことに注意されたい。
式\ref{eq:lindynu0}の近似線形モデルの定態安定性の解析には，この事実が重要である。
参考として，基底変換された近似線形モデルのブロック線図を\FIGref{fig:GandGe}に示す。

\begin{figure}[t]
\centering
\includegraphics[width = .90\linewidth]{figs/FandGe2}
\medskip
\caption{\textbf{基底変換された近似線形モデル}}
\label{fig:GandGe}
\medskip
\end{figure}


\smallskip
\subsubsection{受動性に基づく定態安定性の解析}

以下では，定義\ref{def:passtrans}の受動送電条件を仮定して，式\ref{eq:Gss}の電気サブシステム$G$と同様の手順により，式\ref{eq:Gsstrmin}の$G_{\rm e}$の受動性を示す。
このために
\begin{align}\label{eq:Gecomdef}
G_{\rm e}: \simode{
\dot{x}_{G_{\rm e}} & = A_{G_{\rm e}} x_{G_{\rm e}} + B_{G_{\rm e}} u_G \\
y_G &= C_{G_{\rm e}} x_{G_{\rm e}}
}
\end{align}
の形式で表現する。
ただし，$x_{G_{\rm e}}$は${\delta}^{\rm lin}_{\rm e}$と$E^{\rm lin}$を並べたベクトルであり
\[
A_{G_{\rm e}} := 
\mat{
0 & 0 \\
 \Omega^2 \hat{B} W  &  \Omega^2 \hat{A} 
},\quad
B_{G_{\rm e}} := 
\mat{
W^{\dagger} \\
0
},\quad
C_{G_{\rm e}} := 
\mat{
LW & -\hat{B}^{\sf T}
}
\]
とする。
また，半正定行列$P_{G_{\rm e}}$を
\begin{align}\label{eq:defPGe}
P_{G_{\rm e}} := 
\mat{
W & 0 \\
0 & I
}^{\sf T}
\underbrace{
\mat{
L  &  - \hat{B}^{\sf T} \\
- \hat{B} & -\hat{A}
}
}_{P_G}
\mat{
W & 0 \\
0 & I
}
\end{align}
と定義する。
なお，式\ref{eq:defPG}の$P_G$が半正定であれば，$P_{G_{\rm e}}$も半正定である。
このとき，式\ref{eq:psudinv}の関係から，$\hat{B}WW^{\dagger}=\hat{B}$，$LWW^{\dagger}=L$に注意すれば
\begin{align}\label{eq:Gelmi}
A^{\sf T}_{G_{\rm e}} P_{G_{\rm e}} + P_{G_{\rm e}} A_{G_{\rm e}} \preceq 
0
,\qquad
P_{G_{\rm e}} B_{G_{\rm e}} = C_{G_{\rm e}}^{\sf T}
\end{align}
が成り立つことがわかる。
なお，左の行列不等式は，式\ref{eq:lyapinG}と同様に
\[
\frac{
A^{\sf T}_{G_{\rm e}} P_{G_{\rm e}} + P_{G_{\rm e}} A_{G_{\rm e}}
}{2}
=
\mat{
\Omega \hat{B}W &0\\
0 & \Omega^{-1}
}^{\sf T}
\underbrace{
\mat{
-I & -\hat{A}_{\Omega} \\
-\hat{A}_{\Omega} & - \hat{A}_{\Omega}^2
}
}_{Y}
\mat{
\Omega \hat{B}W  &0\\
0 & \Omega^{-1}
}
\]
から示される。
したがって，蓄積関数
\[
W_{G_{\rm e}}(x_{G_{\rm e}}):= \frac{1}{2}x_{G_{\rm e}}^{\sf T}P_{G_{\rm e}}x_{G_{\rm e}}
\]
の$G_{\rm e}$の解軌道に沿った時間微分は
\begin{align}\label{eq:Glyapeq2}
\frac{d}{dt} W_{G_{\rm e}} \bigl( x_{G_{\rm e}} (t) \bigr)
 \leq 
y_G^{\sf T}(t) u_G(t)
\end{align}
と評価できる。
すなわち，式\ref{eq:Gsstrmin}の$G_{\rm e}$は受動的である。
なお，この不等式と式\ref{eq:Glyapeq}の不等式は等価であり，2つの蓄積関数の値について
\[
W_{G} \bigl( x_{G} (t) \bigr) =
W_{G_{\rm e}} \bigl( x_{G_{\rm e}} (t) \bigr),\qquad
\forall t\geq 0
\]
が成り立つ。



式\ref{eq:Geobs}で示される$G_{\rm e}$の可観測性を考慮することによって，
式\ref{eq:lindynu0}の近似線形モデルの解軌道について，
任意の初期値に対して
\begin{align}\label{eq:allzero}
\lim_{t\rightarrow \infty} \Delta \omega^{\rm lin}(t)  =0,\qquad
\lim_{t\rightarrow \infty} \mat{
{\delta}^{\rm lin}_{\rm e}(t)   \\
E^{\rm lin}(t)  
}
 =0
\end{align}
が成り立つことがわかる。
したがって，式\ref{eq:batrinv}の基底変換の関係から，任意の初期値に対して，式\ref{eq:linmconv}が成り立つことが示される。
すなわち，式\ref{eq:lindynu0}の近似線形モデルは定態安定である。
なお
\[
c_0 = \lim_{t\rightarrow \infty}\overline{\delta}^{\rm lin}_{\rm e}(t)
\]
であり，状態変数$\overline{\delta}^{\rm lin}_{\rm e}$は式\ref{eq:Gsstr}の微分方程式にしたがう。

これまでの議論をつぎの定理にまとめる。

\begin{定理}[受動性に基づく近似線形モデルの定態安定性]\label{thm:stasufcon}
定義\ref{def:passtrans}の受動送電条件を満たす任意の定常値$(\delta^{\star},E^{\star})$に対して，式\ref{eq:Gss}の電気サブシステム$G$は受動的である。
また，任意の正定数$(M_i,D_i,\taudi )_{i \in \mathcal{I}_{\rm G}}$に対して，式\ref{eq:lindynu0}の近似線形モデルは定態安定である。
\end{定理}

定理\ref{thm:stasufcon}で述べられているように，受動送電条件のもとでは，すべての物理定数$(M_i,D_i,\taudi )_{i \in \mathcal{I}_{\rm G}}$の組み合わせに対して近似線形モデルは定態安定となる。
受動性に基づく解析により，このようなモデルパラメータに依らない安定性を示すことが可能となる。


%\begin{例}[基底変換による定態安定性の解析]
%\red{$W$の選び方に依らず等価な解析が可能であることを示す。}
%\end{例}

\subsection{近似線形モデルが受動的であるための必要条件\advanced}\label{sec:nesconana}

\smallskip
\subsubsection{受動性と正実性}

線形システムの受動性は，伝達関数の正実性と呼ばれる性質と数学的に等価であることが知られている
\footnote{
線形システム
\begin{align*}
\simode{
\dot{x}(t) & = Ax(t)+Bu(t) \\
y(t)&= Cx(t) + Du(t)
}
\end{align*}
に対して，その\textbf{伝達関数}（transfer function）は
\[
Q(s):=C(sI-A)^{-1}B +D
\]
と定義される。
入力$u(t)$のラプラス変換を$U(s)$，出力$y(t)$のラプラス変換を$Y(s)$とするとき，伝達関数とは
$Y(s)=Q(s)U(s)$の関係がある。
線形システムの入出力特性は伝達関数によって特徴づけられる。
}。
本節では，その等価性に基づいて，定義\ref{def:passtrans}の受動送電条件の必要性を電気サブシステムの受動性の観点から考察する。

式\ref{eq:Gss}の電気サブシステム$G$の入力$u_G$から出力$y_G$までの伝達関数は
\begin{align}\label{eq:trGs}
G(s) :=  - \frac{1}{s} 
\underbrace{
\left\{ -C \bigl( \taud s -A \bigr)^{-1} B - L \right\}
}_{H(s)}
\end{align}
である。
なお，不可観測な状態変数は入出力特性に関係しないことから，式\ref{eq:Gsstrmin}の$G_{\rm e}$の伝達関数も$G(s)$に等しいことに注意されたい。
以下では，式\ref{eq:trGs}の伝達関数$H(s)$が安定である場合を考える。
伝達関数の安定性はつぎのように定義される。

\begin{定義}[伝達関数の安定性]\label{def:trsta}
伝達関数$Q(s)$のすべての極の実部が負であるとき，$Q(s)$は\textbf{安定}であると呼ぶ。
\end{定義}

伝達関数の極は分母多項式の零点である。
式\ref{eq:trGs}の$H(s)$が安定であることは，行列$\taud^{-1}A$のすべての固有値の実部が負であることに等しい。

また，伝達関数の\textbf{正実性}（positive realness）はつぎのように定義される。

\begin{定義}[伝達関数の正実性]\label{def:trpf}
正方な伝達関数$Q(s)$に対して
\begin{align}\label{eq:defOm0}
\Omega_0 := \left\{
\omega_0 \in \mathbb{R}: 
\mbox{ 純虚数$\bm{j} \omega_0$が$Q(s)$の極である}
\right\}
\end{align}
を定義する。
つぎの3条件が満たされるとき，$Q(s)$は\textbf{正実}（positive real）であると呼ぶ。
\begin{itemize}
\item $Q(s)$のすべての極の実部は非正である。
\item すべての$\omega \in [0,\infty)\setminus \Omega_0$に対して，$Q(\bm{j} \omega) + Q^{\sf T}(-\bm{j} \omega)$が半正定である。
\item 純虚数の極が存在するとき，それらの重複度は1であり，かつ，留数に対して
\begin{align*}
\lim_{s \rightarrow \bm{j} \omega_0} (s-\bm{j} \omega_0) Q(s) = \lim_{s\rightarrow \bm{j} \omega_0} \{ (s-\bm{j} \omega_0) Q(s)\}^{\sf *}\succeq 0
,\qquad
\forall \omega_0 \in \Omega_0
\end{align*}
が成り立つ。
\end{itemize}
\end{定義}

定義\ref{def:trpf}において，特に重要なものは1つ目と2つ目の条件である。
1つ目の条件は伝達関数の安定性を表している。
ただし，極の実部が0である場合も含まれている。
2つ目の条件は，伝達関数を虚軸上で評価したときの複素対称部分の正定性に関するものである
\footnote{
任意の正方行列$M$は，$M=\tfrac{M+M^*}{2}+\tfrac{M-M^*}{2}$と分解できる。
この$\tfrac{M+M^*}{2}$を$M$の\textbf{複素対称部分}（Hermitian part）と呼ぶ。
また，$\tfrac{M-M^*}{2}$を$M$の\textbf{複素歪対称部分}（skew Hermitian part）と呼ぶ。
}。
特に，$Q(s)$がスカラーの場合，すなわち，入力と出力がどちらもスカラーである場合には，2つ目の条件はすべての$\omega \in [0,\infty)\setminus \Omega_0$に対して$Q(\bm{j}\omega)$の実部が非負であることを表している。
ただし，$Q(s)$が行列である場合には，一般に
\begin{align*}
Q(\bm{j} \omega) + Q^{\sf T}(-\bm{j} \omega) \neq 2 \real\left[ Q(\bm{j} \omega) \right]
\end{align*}
であることに注意されたい。
なお，実数係数をもつ$Q(s)$に対しては$Q^{\sf T}( -\bm{j} \omega)$は$\{Q(\bm{j} \omega)\}^*$に等しい。
3つ目の条件は，$Q(s)$が純虚数の極をもつ場合の例外的なものであるが，例えば，式\ref{eq:trGs}の$G(s)$などのように，原点に極をもつ伝達関数を解析するために必要となる。


システム制御工学では，定義\ref{def:passivelin}の受動性と定義\ref{def:trpf}の正実性は等価であることが知られている
\footnote{
証明は\cite[Theorem 5.31]{antoulas2005approximation}や\cite[Theorem 3]{anderson1967system}などを参照されたい。
また，\cite{kottenstette2010relationships}では，関連する一連の結果が細かく整理されている。
\begin{補題*}
安定かつ正方な伝達関数
\[
Q(s)=C(sI-A)^{-1}B + D
\]
を考える。
ただし，$(A,B)$は可制御であり，$(C,A)$は可観測であるものとする。
このとき，$Q(s)$が正実であるための必要十分条件は，
ある正定対称行列$P$が存在して
\begin{align*}%\label{eq:prlem}
\mat{
A^{\sf T}P+PA & PB-C^{\sf T} \\
B^{\sf T} P -C & -(D+D^{\sf T})
}\preceq 0
\end{align*}
が満たされることである。
\end{補題*}
}
。
本節の議論に当てはめれば，式\ref{eq:trGs}の$G(s)$が正実であるための必要十分条件は，その可制御かつ可観測な状態空間実現である式\ref{eq:Gecomdef}の$G_{\rm e}$に対して，式\ref{eq:allzero}を満たす正定行列$P_{G_{\rm e}}$が存在することである。
これは式\ref{eq:Glyapeq2}の不等式で定義される$G_{\rm e}$の受動性に等しい。
なお，式\ref{eq:defPGe}の$P_{G_{\rm e}}$が正定であることは，$-\hat{A}$と$-\hat{A}$に関するシューア補行列
\[
W^{\sf T} \left(L+\hat{B}^{\sf T} \hat{A}^{-1} \hat{B} \right) W
=  W^{\sf T} L_0 W
\]
がともに正定であることから示される。
ただし，式\ref{eq:defL0}の$L_0$が式\ref{eq:nescon}を満たすこと，および，式\ref{eq:batrinv}において$W$の列ベクトルは$\mathds{1}$と直交することから，$W^{\sf T} L_0 W$が正則であるという事実に基づく。




\smallskip
\subsubsection{電気サブシステムの伝達関数が正実であるための必要条件}


必要条件を導く数学的な準備として，正実性と類似した概念である伝達関数の\textbf{負虚性}（negative imaginaryness）を導入する\cite{petersen2010feedback,xiong2010negative}。

\begin{定義}[伝達関数の負虚性]
\label{def:trni}
原点に極をもたない正方な伝達関数$Q(s)$に対して，式\ref{eq:defOm0}の$\Omega_0$を定義する。
つぎの3条件が満たされるとき，$Q(s)$は\textbf{負虚}（negative imaginary）であると呼ぶ。
\begin{itemize}
\item $Q(s)$のすべての極の実部は非正である。
\item すべての$\omega \in (0,\infty)\setminus \Omega_0$に対して，$\bm{j}\left\{Q(\bm{j} \omega) - Q^{\sf T}(-\bm{j} \omega) \right\}$が半正定である。
\item 純虚数の極が存在するとき，それらの重複度は1であり，かつ，留数に対して
\begin{align*}
\lim_{s \rightarrow \bm{j} \omega_0} (s-\bm{j} \omega_0) \bm{j} Q(s) = 
\lim_{s\rightarrow \bm{j} \omega_0} \{ (s-\bm{j} \omega_0) \bm{j} Q(s)\}^{\sf *}\succeq 0
,\quad
\forall \omega_0 \in \Omega_0
\end{align*}
が成り立つ。
\end{itemize}
\end{定義}

定義\ref{def:trpf}の正実性が，伝達関数の複素対称部分に関する半正定性により定義されていたのに対して，定義\ref{def:trni}の負虚性は，伝達関数の複素歪対称部分に関する半正定性により定義されている
\footnote{
複素歪対称行列$M=-M^*$の固有値はすべて純虚数である。
したがって，$\bm{j}M$の固有値はすべて実数である。
}。
特に，$Q(s)$がスカラーの場合には
\begin{align*}
\bm{j}\left\{Q(\bm{j} \omega) - Q^{\sf T}(-\bm{j} \omega) \right\}
= -2 \imag[Q(\bm{j} \omega)]
\end{align*}
であることから，2つ目の条件はすべての$\omega \in (0,\infty)\setminus \Omega_0$に対して$Q(\bm{j}\omega)$の虚部が非正であることを表している。
なお，定義\ref{def:trni}では，定義\ref{def:trpf}と対比するため$Q(s)$が虚軸上に極をもつ場合を含めているが，以下の議論では安定な伝達関数の負虚性を考えるため，2つ目の条件のみに注目すれば良い。
なお，正実性と同様に，伝達関数の負虚性は行列不等式の可解性として特徴づけられることが知られている
\footnote{
証明は\cite[Lemma 7]{xiong2010negative}などを参照されたい。
\begin{補題*}
安定かつ正方な伝達関数
\[
Q(s)=C(sI-A)^{-1}B + D
\]
を考える。
ただし，$(A,B)$は可制御であり，$(C,A)$は可観測であるものとする。
このとき，$Q(s)$が負虚であるための必要十分条件は，$D$が対称であり，かつ，
ある対称正定行列$P$が存在して
\begin{align*}
A^{\sf T}P+PA \preceq 0
,\qquad
-PA^{-1}B = C^{\sf T}
\end{align*}
が満たされることである。
\end{補題*}
}
。
%具体的には，式\ref{eq:siglin}の線形システム$\Sigma$の伝達関数が負虚であるための必要十分条件は，
%\[
%A^{\sf T} P  + PA \preceq 0 ,\qquad -PA^{-1}B = C^{\sf T}
%\]
%を満たす正定対称行列$P$が存在することである。
%ただし，式\ref{eq:siglin}の$\Sigma$は可制御かつ可観測であるものとする。




\begin{figure}[t]
  \centering
  {
  \begin{minipage}{0.49\linewidth}
    \centering
    \includegraphics[width = .65\linewidth]{figs/PRdom}
    \subcaption{ $\mathcal{D}_{\rm PR}$ }
    \medskip
  \end{minipage}
  \begin{minipage}{0.49\linewidth}
    \centering
    \includegraphics[width = .65\linewidth]{figs/NIdom}
    \subcaption{ $\mathcal{D}_{\rm NI}$ }
    \medskip
  \end{minipage}
  }
  \medskip
  \caption{\textbf{正実の領域と負虚の領域}}
  \label{fig:PRandNI}
\medskip
\end{figure}


正実性と負虚性の関係を\FIGref{fig:PRandNI}を用いて説明する。
伝達関数$Q(s)$がスカラーである場合には，$Q(s)$が正実であることは，周波数応答関数$Q(\bm{j} \omega)$の非負の$\omega$に関する軌跡が\ref{fig:PRandNI}(a)に示される領域$\mathcal{D}_{\rm PR}$に包含されることとして理解できる
\footnote{
周波数応答関数$Q(\bm{j} \omega)$の$\omega \in \mathbb{R}$に関する軌跡を複素平面上にプロットしたものは\textbf{ナイキスト軌跡}（Nyquist curve）と呼ばれる。
ナイキスト軌跡は，フィードバック系の安定性に関する幾何学的な解析にしばしば用いられる。
その解析手法は\textbf{ナイキストの安定判別法}（Nyquist stability criterion）と呼ばれる。
なお，$Q(s)$がスカラーであり，分子多項式と分母多項式の係数が実数であるとき，負の$\omega$に対する$Q(\bm{j} \omega)$の軌跡は，正の$\omega$に対する軌跡と実軸に関して対称である。
}。
一方で，$Q(s)$が負虚であることは，その軌跡が\ref{fig:PRandNI}(b)に示される領域$\mathcal{D}_{\rm NI}$に包含されることとして理解できる。
この2つの領域には
\[
\mathcal{D}_{\rm PR} = \bm{j} \mathcal{D}_{\rm NI}
\]
の関係があること，および，式\ref{eq:trGs}の$G(s)$と$H(s)$に対して，$-\tfrac{1}{\bm{j}}=\bm{j}$であることに注意すると
\[
G(\bm{j} \omega) \in \mathcal{D}_{\rm PR}, 
\quad \forall \omega >0
\qquad
\Longleftrightarrow
\qquad
H(\bm{j} \omega) \in \mathcal{D}_{\rm NI} ,
\quad \forall \omega >0
\]
であることが導かれる
\footnote{
正確には$G(\bm{j} \omega)$と$H(\bm{j} \omega)$は複素行列であるため，$\mathcal{D}_{\rm PR}$や$\mathcal{D}_{\rm NI}$は半正定行列の集合などを用いて再定義すべきである。
}。
したがって，$H(s)$の負虚性を解析することは，$G(s)$の正実性を解析することに等しい。
この事実に基づいて，受動送電条件(ii)および(iii)は，$G(s)$が正実であるための必要条件であることが示される。

\begin{定理}[電気サブシステムの伝達関数の正実性]
\label{thm:EdynNI}
式\ref{eq:trGs}の伝達関数$H(s)$が安定となる任意の$(\delta^{\star},E^{\star})$に対して，$H(s)$が負虚であるための必要十分条件は，
定義\ref{def:passtrans}の受動送電条件(ii)が成り立つことである。
さらに，式\ref{eq:trGs}の伝達関数$G(s)$が正実であるための必要十分条件は，
受動送電条件(ii)および(iii)が成り立つことである。
\end{定理}

\begin{証明}
まず，$H(s)$が安定となる任意の$(\delta^{\star},E^{\star})$に対して，$H(s)$が負虚であるならば，受動送電条件(ii)，すなわち，式\ref{eq:Gredcon}が成り立つことを示す。
いま
\[
\lim_{\omega \rightarrow \infty} \bm{j}
\left\{
H(\bm{j}\omega)-H^{\sf T}(-\bm{j}\omega)
\right\}
=\bm{j}
\left(
-L+L^{\sf T}
\right) \succeq 0
\]
であることから，$H(s)$が負虚であるためには$L$は対称でなければならない。
したがって，$k_{ij}(\delta_{ij}^{\star}) = k_{ji}(\delta_{ji}^{\star})$が得られる。
すなわち
\[
G^{\rm red}_{ij} \sfsin \delta_{ij}^{\star} = 0 ,\qquad
\forall (i, j) \in \mathcal{I}_{\rm G} \times \mathcal{I}_{\rm G}
\]
が得られる。
これは，$\delta_{i}^{\star}\neq \delta_{j}^{\star}$である$(i,j)$に対して，$G^{\rm red}_{ij}=0$を意味する。
また，$\delta_{i}^{\star}= \delta_{j}^{\star}$である場合にも，パラメータをもつ行列に対する固有値のパラメータ変動に関する連続性から，$\delta^{\star}+\gamma e_i$に対する$\taud^{-1}A$が安定となるような，十分に小さな$\gamma>0$が存在する。
ただし，$e_i$は，第$i$要素のみ1でありその他は0であるベクトルを表す。
したがって
\begin{align}\label{eq:Gij0t}
G^{\rm red}_{ij}=0, \qquad
\forall i\neq j
\end{align}
が得られる。
さらに，$H(s)$が負虚であるならば
\[
\lim_{\omega \rightarrow 0} \bm{j}
\left\{
H(\bm{j}\omega)-H^{\sf T}(-\bm{j}\omega)
\right\}
=\bm{j}
\left(
L_0-L_0^{\sf T}
\right) \succeq 0
\]
であることから，式\ref{eq:defL0}の$L_0$も対称でなければならない。
式\ref{eq:Gij0t}が成り立つとき
\[
C = \sfdiag \left(
2E_i^{\star} G^{\rm red}_{ii}
\right)  - \hat{B}^{\sf T}
\]
であることに注意すると，$L_0$は
\[
L_0 = \underbrace{ L + \hat{B}^{\sf T} \hat{A} \hat{B} }_{L_1}
-
\underbrace{ \sfdiag (
2 E_i^{\star} G^{\rm red}_{ii}
) \hat{A} \hat{B}
}_{L_2}
\]
と表せる。
ただし，$\hat{A}$は式\ref{eq:sysmats}
で定義される対称行列である。
したがって，$L_1$は対称である。
一方で，任意の$E^{\star}$に対して，$L_2$が対称であるためには，すべての$i$に対して$G^{\rm red}_{ii}=0$でなければならない。
このことから，$H(s)$が安定となる任意の$(\delta^{\star},E^{\star})$に対して，$H(s)$が負虚であるならば，式\ref{eq:Gredcon}が成り立つ。


つぎに，式\ref{eq:Gredcon}が成り立つならば，$H(s)$が安定となる任意の$(\delta^{\star},E^{\star})$に対して，$H(s)$は負虚であることを示す。
このためには，$L$が対称であり，かつ
\begin{align}\label{eq:cndQ}
\tilde{A}^{\sf T}P + P\tilde{A} \preceq 0
,\qquad
P\tilde{A}^{-1}\tilde{B}=C^{\sf T}
\end{align}
を満たす正定な行列$P$が存在することを示せば良い。
ただし
\begin{align*}
\tilde{A}:= \taud^{-1}A
,\qquad
\tilde{B}:= \taud^{-1}B
\end{align*}
とする。
ここで，式\ref{eq:Gredcon}が成り立つならば
\begin{align*}
k_{ij}(\delta_{ij}^{\star}) =
k_{ji}(\delta_{ji}^{\star})
,\qquad
h_{ij}(\delta_{ij}^{\star}) = 
- h_{ji}(\delta_{ji}^{\star}),\qquad
h_{ii}(\delta_{ii}^{\star}) = 0
\end{align*}
が成り立つことから，$L$は対称である。
また，$H(s)$は安定であるため
\begin{align*}
\tilde{A} = 
\sfdiag \left( \frac{ \Xsi -  \Xti }{ \taudi } \right)
\hat{A}
\end{align*}
において，$\Xsi > \Xti$であることから，式\ref{eq:sysmats}の$\hat{A}$
は負定である。
したがって，$Q=-\hat{A}$は式\ref{eq:cndQ}を満たす正定行列となることから，$H(s)$が負虚であることが示される。


つづいて，$G(s)$に関する等価性を示す。
いま，$H(s)$は安定であることから，$G(s)$の虚軸上の極は原点のみであり，その重複度は1である。
したがって，$G(s)$が
正実であるための必要十分条件は
\begin{align}\label{eq:Gpr}
G(\bm{j}\omega) + G^{\sf T}(-\bm{j}\omega) \succeq 0
,\qquad \forall \omega \in \mathbb{R}\setminus\{0\}
\end{align}
が成り立つこと，かつ
\begin{align}\label{eq:cndG0}
\lim_{s\rightarrow 0} s G(s) = \lim_{s\rightarrow 0} \{ s G(s)\}^{\sf T}\succeq 0
\end{align}
が成り立つことである。
式\ref{eq:Gredcon}が成り立つとき，式\ref{eq:Gpr}が成り立つことは
\begin{align}\label{eq:NIineq}
G(\bm{j}\omega) + G^{\sf T}(-\bm{j}\omega)
=
\frac{\bm{j}}{\omega} \left\{
H(\bm{j}\omega) - H^{\sf T}(-\bm{j}\omega)
\right\}
,\qquad \forall \omega \in \mathbb{R}\setminus\{0\}
\end{align}
より，$H(s)$が負虚であることから示される。
また
\begin{align*}
\lim_{s\rightarrow 0} s G(s) =
L - C\tilde{A}^{-1}\tilde{B} = L - C A^{-1} B
\end{align*}
であることから，式\ref{eq:cndG0}の半正定性は，受動送電条件(iii)，すなわち，式\ref{eq:pdsp}の条件に等しい。
なお，受動送電条件(ii)が成り立つとき，$L$は対称であり
\begin{align*}
C\tilde{A}^{-1}\tilde{B} = C Q^{-1} C^{\sf T}
\end{align*}
も対称であることから，式\ref{eq:cndG0}の対称性も示される。

逆に，受動送電条件(ii)または(iii)が成り立たないならば$G(s)$が正実でないことを示す。
後者については，式\ref{eq:pdsp}の条件が式\ref{eq:cndG0}の条件に等しいことから明らかである。
また，受動送電条件(ii)が成り立たないとき，$H(s)$は負虚ではないことから
\begin{align*}
\lambda_{\rm min}\left[
\bm{j}
\left\{
H(\bm{j}(\omega_0 + \alpha )) - H^{\sf T}(-\bm{j}(\omega_0 + \alpha ))
\right\}
\right] < 0
,\qquad
\forall \alpha \in (0,\epsilon] 
\end{align*}
となるある点$\omega_0\geq 0$および十分に小さな$\epsilon >0$が存在する。
ただし，$\lambda_{\rm min}$は最小固有値を表す。
したがって，0ではないすべての$\omega \in (\omega_0, \omega_0+\epsilon] $に対して
$G(\bm{j} \omega) $の複素対称部分は半正定ではない。
\end{証明}

\begin{figure}[t]
  \centering
  {
  \begin{minipage}{0.49\linewidth}
    \centering
    \includegraphics[width = 1.0\linewidth]{figs/eigG}
    \subcaption{ $\tfrac{G(\bm{j} \omega) + G^{\sf T}(-\bm{j} \omega)}{2} $の固有値}
    \medskip
  \end{minipage}
  \begin{minipage}{0.49\linewidth}
    \centering
    \includegraphics[width = 1.0\linewidth]{figs/eigH}
    \subcaption{ $\tfrac{H(\bm{j}\omega) - H^{\sf T}(-\bm{j}\omega)}{2\bm{j}}$の固有値}
    \medskip
  \end{minipage}
  }
  \medskip
  \caption{\textbf{$\bm{G(s)}$の正実性と$\bm{H(s)}$の負虚性}
  \\  \centering（青：受動送電条件(ii)を満たす，赤：満たさない）}
  \label{fig:eigGH}
\medskip
\end{figure}


定理\ref{thm:EdynNI}の結果を具体例で確認してみよう。

\begin{例}[送電損失と電気サブシステムの伝達関数の正実性]
例\ref{ex:linsyssim}で扱った3つの発電機で構成される電力系統モデルに対して，$G(s)$の正実性と$H(s)$の負虚性を調べてみよう。
比較のため，受動送電条件(ii)が満たされる場合と満たされない場合の2通りで計算する。
具体的には，例\ref{ex:energylin}と同様に，$\bm{Y}_0(0)$と$\bm{Y}_0(1)$の2通りを送電網のアドミタンス行列$\bm{Y}$に設定する。
横軸を周波数$\omega$として，\FIGref{fig:eigGH}(a)には$G(\bm{j}\omega)$の複素対称部分の固有値を表示しており，\FIGref{fig:eigGH}(b)には$H(\bm{j}\omega)$の複素歪対称部分の固有値の虚部を表示している。
青丸は受動送電条件(ii)が満たされる場合であり，赤のアスタリスクは満たされない場合である。
この図から，送電線のコンダクタンスが0でない場合には，低い周波数帯域において$G(\bm{j}\omega)$の複素対称部分が半正定でないことがわかる。
\end{例}

式\ref{eq:defPG}の$P_G$が半正定となるための条件として現れた受動送電条件(iii)の意味は，以下のようにも説明できる。
式\ref{eq:Gss}の電気サブシステム$G$において，内部電圧の状態方程式
\begin{align*}
\taud
 \dot{E}^{\rm lin} = 
A E^{\rm lin} + B \delta^{\rm lin}
\end{align*}
に注目する。
この微分方程式において，時定数$( \taudi )_{i \in \mathcal{I}_{\rm G}}$が0に漸近する極限を考える。
これは「内部電圧が定常状態に達する時間が，$\delta^{\rm lin}$の変動と比較して十分に短い極限を考えること」に相当する。
このとき
\begin{align}\label{eq:spa}
E^{\rm lin}(t) \simeq  -A^{-1} B\delta^{\rm lin}(t)
,\qquad
\forall t\geq 0
\end{align}
という近似が成り立つ。
ただし，$A$が安定でない場合，すなわち，受動送電条件(i)が成り立たない場合には，状態$E^{\rm lin}$は発散してしまう。
このような状態変数の時間スケールの違いを利用して，微分方程式を代数方程式で近似する方法は，システム制御工学において\textbf{特異摂動近似}（singular perturbation approximation）と呼ばれている。
実際に，内部電圧の動特性は，機械的なタービンの動特性に比較して小さい時定数をもつことが多い。

式\ref{eq:spa}が等式で成り立つものとして，式\ref{eq:Gss}の出力方程式に代入すれば
\begin{align}\label{eq:Gsssp}
\hat{G}: \simode{
\dot{\hat{\delta}}^{\rm lin} & = u_G \\
y_G &= L_0 \hat{\delta}^{\rm lin}
}
\end{align}
という電気サブシステムの低次元近似が得られる。
ただし，近似であることを表すため状態変数を
$\hat{\delta}^{\rm lin}$として区別した。
%また，内部電圧の近似的な値は
%\begin{align*}
%\hat{E}^{\rm lin}:=  -A^{-1} B \hat{\delta}^{\rm lin}
%\end{align*}
%として与えられる。
この特異摂動近似により，式\ref{eq:lindynu0}の近似線形モデル全体は，2次の振動子が結合された微分方程式系として
\begin{align}\label{eq:spamodel}
M \ddot{\hat{\delta}}^{\rm lin}
+ D \dot{\hat{\delta}}^{\rm lin}
+\omega_0 L_0 \hat{\delta}^{\rm lin}=0
\end{align}
に近似される。
この結果から，受動送電条件(iii)は，時定数が小さい場合における「ばね定数行列の半正定性」を表すことがわかる。
また，式\ref{eq:Gss}の電気サブシステム$G$は，動的なばね定数に相当するものとして解釈できる。

\begin{figure}[t]
  \centering
  {
  \begin{minipage}{0.49\linewidth}
    \centering
    \includegraphics[width = 1.0\linewidth]{figs/Domegaspa}
    \subcaption{ 実線：$\Delta \omega^{\rm lin}$， 破線：$\Delta \hat{\omega}^{\rm lin}$ }
    \medskip
  \end{minipage}
  \begin{minipage}{0.49\linewidth}
    \centering
    \includegraphics[width = 1.0\linewidth]{figs/deltaspa}
    \subcaption{ 実線：$\delta^{\rm lin}$，破線：${\hat{\delta}}^{\rm lin}$ }
    \medskip
  \end{minipage}
 \begin{minipage}{0.49\linewidth}
    \centering
    \includegraphics[width = 1.0\linewidth]{figs/Espa}
    \subcaption{ 実線：$E^{\rm lin}$，破線：$\hat{E}^{\rm lin}$ }
    \medskip
  \end{minipage}
  \begin{minipage}{0.49\linewidth}
    \centering
    \includegraphics[width = 1.0\linewidth]{figs/Pspa}
    \subcaption{ 実線：$P^{\rm lin}$，破線：$\hat{P}^{\rm lin}$ }
    \medskip
  \end{minipage}
  }
  \medskip
  \caption{\textbf{特異摂動近似を適用した場合の時間応答}
  \\  \centering（青：発電機1，黒：発電機2，赤：発電機3）}
  \label{fig:timeexsp}
\medskip
\end{figure}


%\begin{figure}[t]
%  \centering
%  {
%  \begin{minipage}{0.49\linewidth}
%    \centering
%    \includegraphics[width = 1.0\linewidth]{figs/deltasp}
%    \subcaption{ $\hat{\delta}^{\rm lin}$ }
%    \medskip
%  \end{minipage}
%  \begin{minipage}{0.49\linewidth}
%    \centering
%    \includegraphics[width = 1.0\linewidth]{figs/omegasp}
%    \subcaption{ $\Delta \hat{\omega}^{\rm lin}$ }
%    \medskip
%  \end{minipage}
%%  \begin{minipage}{0.32\linewidth}
%    \centering
%    \includegraphics[width = .49\linewidth]{figs/Esp}
%    \subcaption{ $\hat{E}^{\rm lin}$ }
%%  \end{minipage}
%  }
%  \medskip
%  \caption{\textbf{特異摂動近似モデルの初期値応答}}
%  \label{fig:timeexsp}
%\medskip
%\end{figure}


\begin{例}[近似線形モデルに対する特異摂動近似]
参考として，例\ref{ex:linsyssim}で扱った近似線形モデルに対する式\ref{eq:spamodel}の2次振動子系の時間応答を\FIGref{fig:timeexsp}に示す。
実線はもとの近似線形モデルの応答であり，破線が特異摂動近似を適用した後の2次振動子系の応答である。
また
\[
\Delta \hat{\omega}^{\rm lin}:=\omega_0^{-1} \dot{\hat{\delta}}^{\rm lin},\qquad
\hat{E}^{\rm lin}:=-A^{-1}B\hat{\delta}^{\rm lin},\qquad
\hat{P}^{\rm lin}:= L \hat{\delta}^{\rm lin} + C \hat{E}^{\rm lin}
\]
である。
近似線形モデルの初期値は，式\ref{eq:linmini}に対応させて
\[
\hat{\delta}^{\rm lin}(0)
 =
\mat{
\tfrac{\pi}{6} \\
0 \\
0
},\qquad
\Delta \hat{\omega}^{\rm lin}(0)
 =
\mat{
0 \\
0 \\
0
}
\]
と与えている。
\FIGref{fig:timeexsp}から，両者の時間応答が，振動のピーク値や減衰速度などの観点で概ね一致していることがわかる。
\end{例}

\subsection{近似線形モデルが定態安定であるための必要条件\advanced}\label{sec:nesconsta}

以下では，受動送電条件(iii)の必要性を式\ref{eq:lindynu0}の近似線形モデルの定態安定性の観点から考察する。
具体的には，受動送電条件(iii)は，発電機群の物理定数に依らずに近似線形モデルが定態安定となるための必要条件であることを示す。
なお，\ref{sec:nesconana}節の議論で示されているように，受動送電条件(i)は，時定数$(\taudi)_{i \in \mathcal{I}_{\rm G}}$が十分に小さい極限においても近似線形モデルが不安定とならないための必要条件である。
このことは，行列$A$が安定でない場合には式\ref{eq:spa}の特異摂動近似が適用できず，内部電圧が発散することから確かめられる。



受動送電条件(ii)が成り立たないとき，一般に$L_0$は対称ではないことから，受動送電条件(iii)を非対称な$L_0$にも適用できるように一般化した
\begin{align}\label{eq:eigreal}
\bm{\Lambda}(L_0)\subseteq [0,\infty)
\end{align}
を考える。
ただし，$\bm{\Lambda}(L_0)$は，$L_0$の固有値の集合を表す。
式\ref{eq:eigreal}の条件は，$L_0$のすべての固有値が「非負の実数」であることを表している。
以下では，この一般化された条件を定義\ref{def:passtrans}の受動送電条件(iii)$'$と呼ぶ。
なお，$L_0$が対称であるとき，受動送電条件(iii)と(iii)$'$は等価である。
つぎの補題が示される。

\begin{補題}[2次振動子系の定態安定性の必要条件]\label{thm:2ndsys}
式\ref{eq:spamodel}の2次振動子系を考える。
任意の初期値および任意の正定数$(M_i,D_i)_{i \in \mathcal{I}_{\rm G}}$に対して，ある定数$c_0$が存在して
\begin{align}\label{eq:delhat0}
\lim_{t\rightarrow \infty} \hat{\delta}^{\rm lin}(t)= c_0 \mathds{1}
\end{align}
が成り立つための必要条件は，受動送電条件(iii)$'$が成り立つことである。
\end{補題}

\begin{証明}
受動送電条件(iii)$'$が成り立たないならば，ある正定数$(M_i,D_i)_{i \in \mathcal{I}_{\rm G}}$が存在して，式\ref{eq:delhat0}が成り立たないことを示す。
このために，つぎの２つの場合に分けて議論する。
\begin{itemize}
\item[(a)] $L_0$の固有値のうち，実部が負または純虚数であるのものが存在する。
\item[(b)] $L_0$の固有値のうち，実部が正かつ虚部が非零であるものが存在する。
\end{itemize}
まず，(a)の場合を考える。
以下では，定数行列を$M=\omega_0 I$，$D=\omega_0 d I$と選ぶ。
このとき，式\ref{eq:spamodel}の固有方程式は
\begin{align*}
\mat{
0 & I \\
-L_0 & -d I
}
\mat{v\\w}
=
\lambda \mat{v\\w}
\end{align*}
となる。
この方程式から$w$を代入により消去すれば
\begin{align*}
\left(\lambda^2 I +d \lambda I + L_0
\right) v =0
\end{align*}
が得られる。
この固有方程式は，$v$が$L_0$の固有ベクトルであり，その固有値$\kappa$に対して
\begin{align}\label{eq:lamsq}
\lambda^2 + d\lambda +\kappa =0
\qquad
\Longleftrightarrow
\qquad
\lambda = \frac{-d \pm \sqrt{d^2-4\kappa} }{2}
\end{align}
が成り立つことを意味する。
したがって，(a)である場合に，$\sqrt{d^2 - 4\kappa }$の実部が$d$より大きいことを示せば良い。
一般に，任意の複素数$\bm{z}$に対して
\begin{align*}
\real[\bm{z}] = \sqrt{ \real[\bm{z}^2 ] + (\imag[\bm{z}])^2 }
\end{align*}
と表せることから，$\bm{z} = \sqrt{d^2 - 4\kappa }$とすると
\begin{align*}
\real \Bigl[
\sqrt{d^2 - 4\kappa }
\Bigr]
=\sqrt{
d^2 - 4 \real[\kappa]
+
(\imag[ \bm{z} ])^2
}
\end{align*}
が得られる。
この値は，(a)の場合，すなわち，$\kappa$の実部が負，または，$\kappa$の実部が0かつ$\kappa$の虚部が非零である場合には，必ず$d$より大きい。
したがって，式\ref{eq:spamodel}の2次振動子系は不安定である。

つぎに，(b)の場合を考える。
以下では，式\ref{eq:lamsq}の固有値$\lambda$が純虚数となるような正定数$d$が存在することを示す。
実行列の$L_0$が複素数の固有値をもつ場合には，虚部が負であるものが必ず存在する。
その固有値を$\alpha>0$，$\beta < 0$を用いて$\kappa = \alpha + \beta \bm{j}$と表す。
この$\kappa$に対して
\[
-d + \sqrt{d^2-4\kappa}  = \omega \bm{j}
\]
を満たすある$\omega\neq 0$と$d>0$が存在することを示す。
左辺の$-d$を移項して両辺を2乗すれば
\[
-4 (\alpha + \beta \bm{j}) = 2d \omega \bm{j} -\omega^2
\]
を得る。
この方程式は，$\omega = 2\sqrt{\alpha}$，$d=-\tfrac{\beta}{\sqrt{\alpha}}$と選べば満たされる。
したがって，2次振動子系は定常振動解をもつため，式\ref{eq:delhat0}は成り立たない。
\end{証明}


補題\ref{thm:2ndsys}は，内部電圧の時定数が十分に小さい極限において，受動送電条件(iii)$'$が，任意の発電機群の物理定数に対して近似線形モデルが定態安定であるための必要条件であることを示している。
さらに，定理\ref{thm:stasufcon}では，受動送電条件(i)--(iii)が成り立つときに，任意の物理定数に対して近似線形モデルが安定であることが示されていた。
これらの事実に基づき，本節の結論をつぎの定理にまとめる。


\begin{定理}[近似線形モデルの定態安定性]\label{thm:sync}
任意の正定数$(M_i,D_i,\taudi)_{i \in \mathcal{I}_{\rm G}}$に対して，
式\ref{eq:lindynu0}の近似線形モデルが定態安定であるための必要条件は，
定義\ref{def:passtrans}の受動送電条件(i)および(iii)$'$が成り立つことである。
特に，受動送電条件(ii)が成り立つとき，上記の定態安定性の必要十分条件は，受動送電条件(i)および(iii)$'$が成り立つことである。
\end{定理}


定理\ref{thm:sync}を用いた近似線形モデルの定態安定性の解析例を以下に示す。


\begin{例}[受動送電条件に基づく定態安定性解析]\label{ex:linthm}
定理\ref{thm:sync}を用いて，例\ref{ex:linsyssim}で扱った3つの発電機から構成される近似線形モデルの定態安定性を解析してみよう。
発電機の物理定数などは，例\ref{ex:linsyssim}と同じ値に設定する。
受動送電条件(i)はすべてのパラメータに対して満たされていたため，
\FIGref{fig:stacheckX}には，受動送電条件(iii)$'$が満たされないパラメータの領域を重ねてプロットしている。
ただし，式\ref{eq:defL0}の$L_0$の固有値に実部が負であるものが含まれる場合を赤で示し，複素数の固有値が含まれる場合を紫で示している。
なお，$\theta_2$が0である横軸上の領域が，受動送電条件(ii)が成り立つ場合を表している。

定理\ref{thm:sync}では，この赤や紫で示された領域が「ある物理定数の設定において近似線形モデルが必ず不安定となってしまう危険なパラメータ領域であること」が示されている。
また，受動送電条件(ii)が成り立つとき，すなわち，$\theta_2$が0である横軸上のパラメータに対しては，赤ではない値に$\theta_1$を設定する限り，それらの定数の値に依らず必ず近似線形モデルが定態安定性となることも示されている。

\FIGref{fig:stacheckX}の結果で注目すべき点は，赤で示されているパラメータ領域が，上記の物理定数の設定で定態安定となる青いパラメータ領域の境界の一部または全部を正確に捉えていることである。
定理\ref{thm:sync}で示される受動送電条件(iii)$'$の必要性は，近似線形モデルが不安定となる発電機の物理定数の設定が少なくとも1つは存在することを意味する。
したがって，例\ref{ex:linsyssim}で設定されている特定の定数に対しては，定態安定となるパラメータ領域を必ずしも正確に捉えられるとは限らない。
一方で，実際に青い領域の境界の一部を正確に捉えられているという事実は，$L_0$が実部が負の固有値をもつ場合には，多くの場合で近似線形モデルが不安定となることを示唆している。

また，(a)と(b)の場合には，紫の領域が存在していないことがわかる。
すなわち，探索されたすべてのパラメータに対して，$L_0$の固有値は実数となっている。
一般に，$\theta_2$が0でない限り$L_0$は非対称な行列であるため，$L_0$が実固有値しかもたないことは自明ではない。
一方で，アドミタンス行列を$\tfrac{1}{100}$倍にした(c)と(d)の場合には，$\theta_1$と$\theta_2$が比較的大きい値であるときに，$L_0$が複素固有値をもつこともわかる。
ただし，現実的な設定では，$L_0$は実固有値のみをもつ場合が大半であることが確かめられている。
%なお，アドミタンス行列はインピーダンス行列と逆行列の関係にあるため，アドミタンス行列の大きさが小さいことは，送電線のレジスタンスやリアクタンスが大きいことを表している。
\end{例}


\begin{figure}[t!]
  \centering
  {
  \begin{minipage}{0.49\linewidth}
    \centering
    \includegraphics[width = 0.90\linewidth]{figs/Y1D1X}
    \subcaption{ $D=(10,10,10)$，$\bm{Y}=\bm{Y}_0$ }
    \medskip
  \end{minipage}
  \begin{minipage}{0.49\linewidth}
    \centering
    \includegraphics[width = 0.90\linewidth]{figs/Y1D0.01X}
    \subcaption{$D=(0.1,0.1,0.1)$，$\bm{Y}=\bm{Y}_0$ }
    \medskip
  \end{minipage}
}
  \centering
  {
  \begin{minipage}{0.49\linewidth}
      \centering
    \includegraphics[width = 0.90\linewidth]{figs/Y0.01D1X}
    \subcaption{$D=(10,10,10)$，$\bm{Y}=\tfrac{\bm{Y}_0}{100}$ }
    \medskip
  \end{minipage}
  \begin{minipage}{0.49\linewidth}
    \centering
    \includegraphics[width = 0.90\linewidth]{figs/Y0.01D0.01X}
    \subcaption{$D=(0.1,0.1,0.1)$，$\bm{Y}=\tfrac{\bm{Y}_0}{100}$ }
    \medskip
  \end{minipage}
}
% \medskip
 \caption{\textbf{近似線形モデルが安定となるパラメータの領域}}
 \label{fig:stacheckX}
\medskip
\end{figure}

%\bibliographystyle{myjunsrt}		% bib style
%\bibliography{reference}	% your bib database

\end{document}






















